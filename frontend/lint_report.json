
> frontend@0.1.0 lint
> eslint --format json

[{"filePath":"/workspace/frontend/app/battle/[roomId]/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'selfUsername' is assigned a value but never used.","line":35,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":35,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React from 'react';\nimport { useParams, useSearchParams } from 'next/navigation';\nimport { useBattle } from '@/src/features/battle/hooks/useBattle';\nimport { BattleLobby } from '@/src/features/battle/components/BattleLobby';\nimport { BattleQuiz } from '@/src/features/battle/components/BattleQuiz';\nimport { BattleResult } from '@/src/features/battle/components/BattleResult';\nimport { useAuth } from '@/src/shared/auth/useAuth';\nimport { Spinner } from '@/src/design/baseComponents/Spinner';\nimport { Flex } from '@/src/design/primitives/Flex';\nimport { View } from '@/src/design/primitives/View';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { AlertCircle } from 'lucide-react';\nimport { BackButton } from '@/src/shared/components/Navigation/BackButton';\n\nexport default function BattlePage() {\n    const params = useParams();\n    const searchParams = useSearchParams();\n    const { user } = useAuth();\n\n    const roomId = params.roomId as string;\n    const joinToken = searchParams.get('token') || '';\n\n    const {\n        room,\n        questions,\n        currentQuestionIndex,\n        buzzedUserId,\n        lastRoundResult,\n        answerResult,\n        expiresAtMs,\n        maxBuzzes,\n        selfId,\n        selfUsername,\n        roundSummaries,\n        error,\n        isConnected,\n        startMatch,\n        buzz,\n        submitAnswer,\n        updateConfig,\n        backToLobby,\n        resetMatch\n    } = useBattle(roomId, joinToken);\n\n    if (error) {\n        return (\n            <div className=\"container mx-auto py-12 px-4\">\n                <BackButton />\n                <Flex direction=\"column\" align=\"center\" justify=\"center\" className=\"min-h-[50vh] text-center gap-4\">\n                    <View className=\"p-4 rounded-full bg-brand-danger/10 text-brand-danger\">\n                        <AlertCircle size={48} />\n                    </View>\n                    <Text variant=\"h3\" color=\"danger\" weight=\"bold\">エラーが発生しました</Text>\n                    <Text color=\"secondary\">{error}</Text>\n                </Flex>\n            </div>\n        );\n    }\n\n    if (!isConnected || !room) {\n        return (\n            <div className=\"container mx-auto py-12 px-4\">\n                <Flex direction=\"column\" align=\"center\" justify=\"center\" className=\"min-h-[50vh] gap-4\">\n                    <Spinner size=\"lg\" />\n                    <Text color=\"secondary\" weight=\"bold\">サーバーに接続中...</Text>\n                </Flex>\n            </div>\n        );\n    }\n\n    const isHost = user?.id === room.host_id;\n\n    return (\n        <div className=\"min-h-screen bg-surface-muted/30\">\n            <div className=\"container mx-auto py-8 md:py-12 px-4\">\n                {room.status === 'Waiting' && (\n                    <BattleLobby\n                        room={room}\n                        isHost={isHost}\n                        onStart={startMatch}\n                        onUpdateConfig={updateConfig}\n                        maxBuzzes={maxBuzzes}\n                        onResetMatch={resetMatch}\n                        selfId={selfId}\n                    />\n                )}\n\n                {room.status === 'Playing' && questions.length > 0 && currentQuestionIndex >= 0 && (\n                    <BattleQuiz\n                        question={questions[currentQuestionIndex]}\n                        buzzedUserId={buzzedUserId}\n                        lastRoundResult={lastRoundResult}\n                        players={room.players}\n                        selfId={selfId}\n                        onBuzz={buzz}\n                        onSubmit={submitAnswer}\n                        expiresAtMs={expiresAtMs}\n                        answerResult={answerResult}\n                        currentQuestionIndex={currentQuestionIndex}\n                        totalQuestions={questions.length}\n                    />\n                )}\n\n                {room.status === 'Finished' && (\n                    <BattleResult\n                        scores={room.players}\n                        isHost={isHost}\n                        onBackToLobby={backToLobby}\n                        onReplay={startMatch} // Replay same questions\n                        roundSummaries={roundSummaries}\n                    />\n                )}\n            </div>\n        </div>\n    );\n}\n\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/app/battle/lobby/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Container' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":19,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Container"},"fix":{"range":[67,130],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useEffect, useState } from 'react';\nimport { Container } from '@/src/design/primitives/Container';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Card } from '@/src/design/baseComponents/Card';\nimport { Flex } from '@/src/design/primitives/Flex';\nimport { View } from '@/src/design/primitives/View';\nimport { BackButton } from '@/src/shared/components/Navigation/BackButton';\nimport { Swords, Users, Play, RefreshCw, User } from 'lucide-react';\nimport { getPublicRooms, MatchRoomListItem } from '@/src/features/battle/api';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { useRouter } from 'next/navigation';\nimport { Spinner } from '@/src/design/baseComponents/Spinner';\nimport { Badge } from '@/src/design/baseComponents/Badge';\n\nexport default function BattleLobbyPage() {\n    const [rooms, setRooms] = useState<MatchRoomListItem[]>([]);\n    const [loading, setLoading] = useState(true);\n    const router = useRouter();\n\n    const fetchRooms = async () => {\n        setLoading(true);\n        try {\n            const data = await getPublicRooms();\n            setRooms(data);\n        } catch (error) {\n            console.error('Failed to fetch rooms', error);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    useEffect(() => {\n        fetchRooms();\n    }, []);\n\n    const handleJoin = (roomId: string) => {\n        router.push(`/battle/${roomId}`);\n    };\n\n    return (\n        <View className=\"min-h-screen bg-surface-muted/30 pb-20\">\n            <View className=\"max-w-4xl mx-auto px-4 pt-8\">\n                <Stack gap=\"xl\">\n                    <Flex justify=\"between\" align=\"end\">\n                        <Stack gap=\"xs\">\n                            <BackButton />\n                            <Flex align=\"center\" gap=\"sm\">\n                                <Swords className=\"text-brand-primary\" size={28} />\n                                <Text variant=\"h1\" weight=\"bold\" className=\"tracking-tight\">\n                                    対戦ロビー\n                                </Text>\n                            </Flex>\n                            <Text color=\"secondary\">\n                                現在公開されているルームに参加して、他のユーザーと競い合いましょう。\n                            </Text>\n                        </Stack>\n                        <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            onClick={fetchRooms}\n                            disabled={loading}\n                            className=\"gap-2\"\n                        >\n                            <RefreshCw size={16} className={loading ? \"animate-spin\" : \"\"} />\n                            更新\n                        </Button>\n                    </Flex>\n\n                    {loading ? (\n                        <View className=\"py-20 flex justify-center\">\n                            <Spinner size=\"lg\" />\n                        </View>\n                    ) : rooms.length === 0 ? (\n                        <Card className=\"py-20 text-center border-2 border-dashed border-surface-muted\">\n                            <Stack gap=\"md\" align=\"center\">\n                                <Users size={48} className=\"text-secondary opacity-20\" />\n                                <Text color=\"secondary\" weight=\"medium\">現在、公開されているルームはありません</Text>\n                                <Button\n                                    variant=\"solid\"\n                                    color=\"primary\"\n                                    onClick={() => router.push('/home#battle')}\n                                >\n                                    自分でルームを作成する\n                                </Button>\n                            </Stack>\n                        </Card>\n                    ) : (\n                        <View className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                            {rooms.map((room) => (\n                                <Card\n                                    key={room.roomId}\n                                    className=\"hover:shadow-lg transition-all hover:-translate-y-1\"\n                                    padding=\"lg\"\n                                >\n                                    <Stack gap=\"md\">\n                                        <Flex justify=\"between\" align=\"start\">\n                                            <Stack gap=\"xs\">\n                                                <Flex gap=\"sm\" align=\"center\">\n                                                    <View className=\"bg-brand-primary/10 p-2 rounded-full text-brand-primary\">\n                                                        <User size={16} />\n                                                    </View>\n                                                    <Text weight=\"bold\" variant=\"detail\">\n                                                        {room.hostUsername} のルーム\n                                                    </Text>\n                                                </Flex>\n                                                <Flex gap=\"md\" align=\"center\" className=\"mt-1\">\n                                                    <Flex gap=\"xs\" align=\"center\">\n                                                        <Users size={14} className=\"text-secondary\" />\n                                                        <Text variant=\"xs\" color=\"secondary\">\n                                                            {room.playerCount} 名が参加中\n                                                        </Text>\n                                                    </Flex>\n                                                    <Flex gap=\"xs\" align=\"center\">\n                                                        <Swords size={14} className=\"text-secondary\" />\n                                                        <Text variant=\"xs\" color=\"secondary\">\n                                                            全 {room.totalQuestions} 問\n                                                        </Text>\n                                                    </Flex>\n                                                </Flex>\n                                            </Stack>\n                                            <Badge variant={room.status === 'Waiting' ? 'success' : 'secondary'}>\n                                                {room.status === 'Waiting' ? '募集中' : '対戦中'}\n                                            </Badge>\n                                        </Flex>\n\n                                        <Button\n                                            variant=\"solid\"\n                                            color=\"primary\"\n                                            className=\"w-full gap-2 shadow-md shadow-brand-primary/20\"\n                                            onClick={() => handleJoin(room.roomId)}\n                                            disabled={room.status !== 'Waiting'}\n                                        >\n                                            <Play size={16} />\n                                            {room.status === 'Waiting' ? '参加する' : '観戦する (未実装)'}\n                                        </Button>\n                                    </Stack>\n                                </Card>\n                            ))}\n                        </View>\n                    )}\n                </Stack>\n            </View>\n        </View>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/app/collection-sets/[setId]/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Trash2' is defined but never used.","line":19,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":40,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Trash2"},"fix":{"range":[1048,1056],"text":""},"desc":"Remove unused variable \"Trash2\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":19,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":51,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[1056,1067],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'cn' is defined but never used.","line":22,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":12,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"cn"},"fix":{"range":[1234,1278],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":41,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":41,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2126,2129],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2126,2129],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":41,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":41,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2140,2143],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2140,2143],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState } from 'react';\nimport { useParams, useRouter } from 'next/navigation';\nimport { Container } from '@/src/design/primitives/Container';\nimport { View } from '@/src/design/primitives/View';\nimport { Flex } from '@/src/design/primitives/Flex';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { Spinner } from '@/src/design/baseComponents/Spinner';\nimport { Grid } from '@/src/design/primitives/Grid';\nimport { BackButton } from '@/src/shared/components/Navigation/BackButton';\nimport { useCollectionSet } from '@/src/features/collectionSets/hooks/useCollectionSets';\nimport { CollectionCard } from '@/src/features/collections/components/CollectionCard';\nimport { QuizOptionModal } from '@/src/features/quiz/components/QuizOptionModal';\nimport { startCasualQuiz } from '@/src/features/quiz/api';\nimport { useAuth } from '@/src/shared/auth/useAuth';\nimport { FolderOpen, Play, Plus, Trash2, ArrowLeft } from 'lucide-react';\nimport { useUserCollections } from '@/src/features/collections/hooks/useCollections';\nimport { Card } from '@/src/design/baseComponents/Card';\nimport { cn } from '@/src/shared/utils/cn';\nimport { AddToSetModal } from '@/src/features/collectionSets/components/AddToSetModal';\n\nexport default function CollectionSetPage() {\n    const params = useParams();\n    const router = useRouter();\n    const { user } = useAuth();\n    const setId = params.setId as string;\n\n    const { set, collections, loading, error, removeCollection, addCollection } = useCollectionSet(setId);\n    const { collections: myCollections } = useUserCollections(user?.id);\n\n    const [showQuizOptions, setShowQuizOptions] = useState(false);\n    const [isStartingQuiz, setIsStartingQuiz] = useState(false);\n    const [showAddModal, setShowAddModal] = useState(false);\n    const [collectionToAddToSet, setCollectionToAddToSet] = useState<string | null>(null);\n\n    const isOwner = !!(user && set && user.id === set.userId);\n\n    const handleStartQuiz = async (filters: any[], sorts: any[], limit: number) => {\n        setIsStartingQuiz(true);\n        try {\n            const resp = await startCasualQuiz({\n                collectionIds: [], // Empty because we use collectionSetId\n                collectionSetId: setId,\n                filters,\n                sorts,\n                limit\n            });\n            if (typeof window !== 'undefined') {\n                sessionStorage.setItem('quizData', JSON.stringify(resp));\n            }\n            router.push('/quiz');\n        } catch (err) {\n            console.error('Failed to start quiz', err);\n        } finally {\n            setIsStartingQuiz(false);\n            setShowQuizOptions(false);\n        }\n    };\n\n    if (loading) {\n        return (\n            <div className=\"flex justify-center py-20\">\n                <Spinner size=\"lg\" />\n            </div>\n        );\n    }\n\n    if (error || !set) {\n        return (\n            <Container className=\"py-20 text-center\">\n                <Text color=\"danger\">エラー: {error || 'セットが見つかりません'}</Text>\n                <Button variant=\"outline\" className=\"mt-4\" onClick={() => router.back()}>\n                    戻る\n                </Button>\n            </Container>\n        );\n    }\n\n    const availableCollections = myCollections.filter(\n        mc => !collections.some(c => c.id === mc.id)\n    );\n\n    return (\n        <View className=\"min-h-screen bg-surface-muted pb-20\">\n            <BackButton />\n\n            {/* ヒーローセクション的なヘッダー */}\n            <View className=\"bg-white border-b border-surface-muted pt-24 pb-12\">\n                <Container>\n                    <Stack gap=\"xl\">\n                        <Flex justify=\"between\" align=\"start\" className=\"flex-col md:flex-row gap-6\">\n                            <Stack gap=\"sm\" className=\"flex-1\">\n                                <Flex gap=\"sm\" align=\"center\" className=\"text-brand-primary\">\n                                    <FolderOpen size={24} />\n                                    <Text variant=\"xs\" weight=\"bold\" className=\"uppercase tracking-wider\">Collection Set</Text>\n                                </Flex>\n                                <Text variant=\"h1\" weight=\"bold\" className=\"text-4xl md:text-5xl\">\n                                    {set.name}\n                                </Text>\n                                <Text variant=\"detail\" color=\"secondary\" className=\"max-w-2xl leading-relaxed\">\n                                    {set.descriptionText || 'このセットには説明がありません。'}\n                                </Text>\n                            </Stack>\n\n                            {collections.length > 0 && (\n                                <Button\n                                    size=\"lg\"\n                                    className=\"gap-3 px-8 py-7 text-lg shadow-xl shadow-brand-primary/20 hover:shadow-brand-primary/30 transition-all rounded-full\"\n                                    onClick={() => setShowQuizOptions(true)}\n                                >\n                                    <Play size={24} fill=\"currentColor\" />\n                                    クイズを開始\n                                </Button>\n                            )}\n                        </Flex>\n                    </Stack>\n                </Container>\n            </View>\n\n            <Container className=\"py-12\">\n                <Stack gap=\"xl\">\n                    <Flex justify=\"between\" align=\"center\">\n                        <Stack gap=\"none\">\n                            <Text variant=\"h3\" weight=\"bold\">構成コレクション</Text>\n                            <Text variant=\"xs\" color=\"secondary\" className=\"opacity-70\">\n                                {collections.length} 個のコレクションが含まれています\n                            </Text>\n                        </Stack>\n\n                        {isOwner && (\n                            <Button\n                                variant=\"outline\"\n                                className=\"gap-2\"\n                                onClick={() => setShowAddModal(true)}\n                            >\n                                <Plus size={18} />\n                                コレクションを追加\n                            </Button>\n                        )}\n                    </Flex>\n\n                    {collections.length === 0 ? (\n                        <Card className=\"py-20 flex flex-center border-dashed border-2 border-surface-muted bg-transparent\">\n                            <Stack gap=\"md\" align=\"center\">\n                                <View className=\"p-4 rounded-full bg-surface-muted\">\n                                    <FolderOpen size={32} className=\"text-surface-muted-foreground\" />\n                                </View>\n                                <Text color=\"secondary\">このセットにはまだコレクションがありません</Text>\n                                {isOwner && (\n                                    <Button variant=\"solid\" onClick={() => setShowAddModal(true)}>\n                                        コレクションを追加する\n                                    </Button>\n                                )}\n                            </Stack>\n                        </Card>\n                    ) : (\n                        <Grid cols={{ sm: 2, lg: 3 }} gap=\"lg\">\n                            {collections.map(c => (\n                                <CollectionCard\n                                    key={c.id}\n                                    collection={c}\n                                    onDelete={isOwner ? () => removeCollection(c.id) : undefined}\n                                    onAddToSet={user ? (id) => setCollectionToAddToSet(id) : undefined}\n                                />\n                            ))}\n                        </Grid>\n                    )}\n                </Stack>\n            </Container>\n\n            {/* コレクション追加モーダル */}\n            {showAddModal && (\n                <View className=\"fixed inset-0 z-modal flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm\">\n                    <Card className=\"w-full max-w-2xl max-h-[80vh] flex flex-col p-0 overflow-hidden\">\n                        <View className=\"p-6 border-b border-surface-muted bg-surface-base\">\n                            <Flex justify=\"between\" align=\"center\">\n                                <Text variant=\"h3\" weight=\"bold\">コレクションをセットに追加</Text>\n                                <Button variant=\"ghost\" size=\"sm\" onClick={() => setShowAddModal(false)}>\n                                    閉じる\n                                </Button>\n                            </Flex>\n                        </View>\n\n                        <View className=\"flex-1 overflow-y-auto p-6\">\n                            {availableCollections.length === 0 ? (\n                                <Text color=\"secondary\" align=\"center\" className=\"py-10\">\n                                    追加できるコレクションがありません\n                                </Text>\n                            ) : (\n                                <Grid cols={{ sm: 2 }} gap=\"md\">\n                                    {availableCollections.map(mc => (\n                                        <Card\n                                            key={mc.id}\n                                            padding=\"sm\"\n                                            className=\"hover:border-brand-primary cursor-pointer transition-colors border border-surface-muted\"\n                                            onClick={() => {\n                                                addCollection(mc.id, collections.length);\n                                                setShowAddModal(false);\n                                            }}\n                                        >\n                                            <Flex gap=\"sm\" align=\"center\">\n                                                <View className=\"w-10 h-10 rounded bg-brand-primary/10 flex items-center justify-center text-brand-primary shrink-0\">\n                                                    <FolderOpen size={20} />\n                                                </View>\n                                                <Stack gap=\"none\" className=\"flex-1 overflow-hidden\">\n                                                    <Text weight=\"bold\" variant=\"xs\" className=\"truncate\">{mc.name}</Text>\n                                                    <Text variant=\"xs\" color=\"secondary\" className=\"truncate opacity-70\">\n                                                        {mc.questionCount || 0} 問\n                                                    </Text>\n                                                </Stack>\n                                                <Plus size={18} className=\"text-brand-primary\" />\n                                            </Flex>\n                                        </Card>\n                                    ))}\n                                </Grid>\n                            )}\n                        </View>\n                    </Card>\n                </View>\n            )}\n\n            {showQuizOptions && (\n                <QuizOptionModal\n                    selectedCount={collections.length}\n                    onStart={handleStartQuiz}\n                    onCancel={() => setShowQuizOptions(false)}\n                    loading={isStartingQuiz}\n                />\n            )}\n\n            {collectionToAddToSet && (\n                <AddToSetModal\n                    collectionId={collectionToAddToSet}\n                    onClose={() => setCollectionToAddToSet(null)}\n                />\n            )}\n        </View>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/app/collections/[collectionId]/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":16,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Button"},"fix":{"range":[298,359],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Plus' is defined but never used.","line":20,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":14,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Plus"},"fix":{"range":[1146,1183],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'router' is assigned a value but never used.","line":29,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":29,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState, useEffect } from 'react';\nimport { useParams, useRouter } from 'next/navigation';\nimport { Container } from '@/src/design/primitives/Container';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { Spinner } from '@/src/design/baseComponents/Spinner';\nimport { Collection } from '@/src/entities/collection';\nimport { Question } from '@/src/entities/question';\nimport { getCollection } from '@/src/features/collections/api';\nimport { getCollectionQuestions } from '@/src/features/questions/api';\nimport { CollectionHeader } from '@/src/features/collections/components/CollectionHeader';\nimport { QuestionList } from '@/src/features/questions/components/QuestionList';\nimport { QuestionForm } from '@/src/features/questions/components/QuestionForm';\nimport { EditRequestReviewList } from '@/src/features/questions/components/EditRequestReviewList';\nimport { BackButton } from '@/src/shared/components/Navigation/BackButton';\nimport { useAuth } from '@/src/shared/auth/useAuth';\nimport { Plus } from 'lucide-react';\nimport { AiGenerationModal } from '@/src/features/collections/components/AiGenerationModal';\nimport { PdfGenerationModal } from '@/src/features/collections/components/PdfGenerationModal';\nimport { CsvImportModal } from '@/src/features/collections/components/CsvImportModal';\nimport { AiQuickBar } from '@/src/features/collections/components/AiQuickBar';\nimport { View } from '@/src/design/primitives/View';\n\nexport default function CollectionDetailPage() {\n    const params = useParams();\n    const router = useRouter();\n    const { user } = useAuth();\n    const collectionId = params.collectionId as string;\n\n    const [collection, setCollection] = useState<Collection | null>(null);\n    const [questions, setQuestions] = useState<Question[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [isOwner, setIsOwner] = useState(false);\n    const [showForm, setShowForm] = useState(false);\n    const [editingQuestion, setEditingQuestion] = useState<Question | undefined>(undefined);\n    const [isAiModalOpen, setIsAiModalOpen] = useState(false);\n    const [isPdfModalOpen, setIsPdfModalOpen] = useState(false);\n    const [isCsvModalOpen, setIsCsvModalOpen] = useState(false);\n    const [isEditMode, setIsEditMode] = useState(false);\n\n    useEffect(() => {\n        const fetchData = async () => {\n            try {\n                const data = await getCollection(collectionId);\n                setCollection(data);\n                const qList = await getCollectionQuestions(collectionId);\n                setQuestions(qList);\n                setIsOwner(!!(user && user.id === data.userId));\n            } catch (err) {\n                console.error('Failed to fetch collection details', err);\n            } finally {\n                setLoading(false);\n            }\n        };\n        fetchData();\n    }, [collectionId, user]);\n\n    const handleQuestionDeleted = (id: string) => {\n        setQuestions(prev => prev.filter(q => q.id !== id));\n    };\n\n    const handleAddQuestion = () => {\n        setEditingQuestion(undefined);\n        setShowForm(true);\n    };\n\n    const handleEditQuestion = (question: Question) => {\n        setEditingQuestion(question);\n        setShowForm(true);\n    };\n\n    const handleQuestionSaved = () => {\n        // Simple reload to get updated list and counts\n        window.location.reload();\n    };\n\n    if (loading) {\n        return (\n            <View className=\"flex justify-center py-20 min-h-screen bg-surface-muted\">\n                <Spinner size=\"lg\" />\n            </View>\n        );\n    }\n\n    if (!collection) {\n        return (\n            <View className=\"min-h-screen bg-surface-muted pt-20\">\n                <BackButton />\n                <Container className=\"py-20 text-center\">\n                    <Text color=\"danger\">コレクションが見つかりません</Text>\n                </Container>\n            </View>\n        );\n    }\n\n    return (\n        <View className=\"min-h-screen bg-surface-muted\">\n            <BackButton />\n            <Container className=\"pt-20 pb-12\">\n                <Stack gap=\"xl\">\n                    <CollectionHeader\n                        collection={collection}\n                        isOwner={isOwner}\n                        questionCount={questions.length}\n                        onEdit={() => setShowForm(true)}\n                    />\n\n                    {isOwner && (\n                        <AiQuickBar\n                            collectionId={collectionId}\n                            onSuccess={handleQuestionSaved}\n                        />\n                    )}\n\n                    {isOwner && (\n                        <EditRequestReviewList\n                            collectionId={collectionId}\n                            onActionSuccess={handleQuestionSaved}\n                        />\n                    )}\n\n                    <QuestionList\n                        questions={questions}\n                        isOwner={isOwner}\n                        isEditMode={isEditMode}\n                        onToggleEditMode={() => setIsEditMode(!isEditMode)}\n                        onQuestionDeleted={handleQuestionDeleted}\n                        onEditQuestion={handleEditQuestion}\n                        onAddQuestion={handleAddQuestion}\n                        onImportCsv={() => setIsCsvModalOpen(true)}\n                        onSuccess={handleQuestionSaved}\n                    />\n                </Stack>\n            </Container>\n\n            {showForm && (\n                <QuestionForm\n                    collectionId={collectionId}\n                    question={editingQuestion}\n                    onSaved={handleQuestionSaved}\n                    onCancel={() => { setShowForm(false); setEditingQuestion(undefined); }}\n                />\n            )}\n\n            <AiGenerationModal\n                isOpen={isAiModalOpen}\n                onClose={() => setIsAiModalOpen(false)}\n                collectionId={collectionId}\n                onSuccess={handleQuestionSaved}\n            />\n\n            <PdfGenerationModal\n                isOpen={isPdfModalOpen}\n                onClose={() => setIsPdfModalOpen(false)}\n                collectionId={collectionId}\n                onSuccess={handleQuestionSaved}\n            />\n\n            <CsvImportModal\n                isOpen={isCsvModalOpen}\n                onClose={() => setIsCsvModalOpen(false)}\n                collectionId={collectionId}\n                onSuccess={handleQuestionSaved}\n            />\n        </View>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/app/collections/[collectionId]/ranking/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'index' is defined but never used.","line":120,"column":66,"nodeType":"Identifier","messageId":"unusedVar","endLine":120,"endColumn":71},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":140,"column":57,"nodeType":"JSXOpeningElement","endLine":140,"endColumn":148}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useEffect, useState } from 'react';\nimport { useParams, useRouter } from 'next/navigation';\nimport { View } from '@/src/design/primitives/View';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { Card } from '@/src/design/baseComponents/Card';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { Flex } from '@/src/design/primitives/Flex';\nimport { BackButton } from '@/src/shared/components/Navigation/BackButton';\nimport { getLeaderboard, startRankingQuiz } from '@/src/features/quiz/api';\nimport { getCollection } from '@/src/features/collections/api';\nimport { Collection } from '@/src/entities/collection';\nimport { LeaderboardResponse } from '@/src/features/quiz/api';\nimport { Trophy, Play, User } from 'lucide-react';\nimport { useAuth } from '@/src/shared/auth/useAuth';\n\nexport default function RankingLeaderboardPage() {\n    const params = useParams();\n    const router = useRouter();\n    const { user } = useAuth();\n    const collectionId = params.collectionId as string;\n\n    const [collection, setCollection] = useState<Collection | null>(null);\n    const [leaderboard, setLeaderboard] = useState<LeaderboardResponse | null>(null);\n    const [loading, setLoading] = useState(true);\n\n    useEffect(() => {\n        const fetchData = async () => {\n            try {\n                const [c, l] = await Promise.all([\n                    getCollection(collectionId),\n                    getLeaderboard(collectionId)\n                ]);\n                setCollection(c);\n                setLeaderboard(l);\n            } catch (err) {\n                console.error('Failed to fetch ranking data', err);\n            } finally {\n                setLoading(false);\n            }\n        };\n        fetchData();\n    }, [collectionId]);\n\n    const handleStartQuiz = async () => {\n        try {\n            const resp = await startRankingQuiz(collectionId);\n            sessionStorage.setItem('quizData', JSON.stringify(resp));\n            router.push('/quiz');\n        } catch (err) {\n            console.error('Failed to start ranking quiz', err);\n            alert('クイズの開始に失敗しました。');\n        }\n    };\n\n    if (loading) {\n        return (\n            <div className=\"min-h-screen bg-surface-muted flex items-center justify-center\">\n                <Text>読み込み中...</Text>\n            </div>\n        );\n    }\n\n    if (!collection) {\n        return (\n            <div className=\"min-h-screen bg-surface-muted flex flex-col items-center justify-center gap-4\">\n                <Text variant=\"h2\">コレクションが見つかりません</Text>\n                <Button onClick={() => router.push('/home')}>ホームに戻る</Button>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"min-h-screen bg-surface-muted pt-24 pb-12 px-4\">\n            <BackButton />\n\n            <View className=\"max-w-2xl mx-auto\">\n                <Stack gap=\"xl\">\n                    {/* Header Section */}\n                    <Stack gap=\"sm\" align=\"center\" className=\"text-center\">\n                        <View className=\"bg-brand-primary/10 p-4 rounded-full mb-2\">\n                            <Trophy size={48} className=\"text-brand-primary\" />\n                        </View>\n                        <Text variant=\"h1\" weight=\"bold\">{collection.name}</Text>\n                        <Text color=\"secondary\">ランキングクイズ・リーダーボード</Text>\n\n                        <View className=\"mt-4\">\n                            <Button\n                                size=\"lg\"\n                                color=\"primary\"\n                                className=\"px-8 py-6 rounded-full shadow-lg hover:scale-105 transition-transform\"\n                                onClick={handleStartQuiz}\n                            >\n                                <Flex gap=\"sm\" align=\"center\">\n                                    <Play size={20} fill=\"currentColor\" />\n                                    <Text weight=\"bold\">クイズに挑戦する</Text>\n                                </Flex>\n                            </Button>\n                        </View>\n                    </Stack>\n\n                    {/* Leaderboard Table */}\n                    <Card className=\"overflow-hidden border-none shadow-xl\">\n                        <Stack gap=\"none\">\n                            <View className=\"bg-brand-primary p-4 text-white\">\n                                <Flex justify=\"between\" align=\"center\">\n                                    <Text weight=\"bold\" className=\"text-white\">順位</Text>\n                                    <Text weight=\"bold\" className=\"text-white\">ユーザー</Text>\n                                    <Text weight=\"bold\" className=\"text-white\">スコア</Text>\n                                </Flex>\n                            </View>\n\n                            {leaderboard?.entries.length === 0 ? (\n                                <View className=\"p-12 text-center\">\n                                    <Text color=\"secondary\">まだ記録がありません。一番乗りを目指しましょう！</Text>\n                                </View>\n                            ) : (\n                                leaderboard?.entries.map((entry, index) => {\n                                    const isCurrentUser = entry.userId === user?.id;\n                                    return (\n                                        <View\n                                            key={entry.userId}\n                                            className={`p-4 border-b border-surface-muted last:border-none transition-colors ${isCurrentUser ? 'bg-brand-primary/5' : 'hover:bg-brand-primary/[0.02]'}`}\n                                        >\n                                            <Flex justify=\"between\" align=\"center\">\n                                                <View className=\"w-12\">\n                                                    <View className={`w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm ${entry.rank === 1 ? 'bg-yellow-400 text-white' :\n                                                            entry.rank === 2 ? 'bg-slate-300 text-white' :\n                                                                entry.rank === 3 ? 'bg-amber-600 text-white' :\n                                                                    'text-secondary'\n                                                        }`}>\n                                                        {entry.rank}\n                                                    </View>\n                                                </View>\n\n                                                <Flex gap=\"md\" align=\"center\" className=\"flex-1\">\n                                                    {entry.iconUrl ? (\n                                                        <img src={entry.iconUrl} alt={entry.username} className=\"w-8 h-8 rounded-full shadow-sm\" />\n                                                    ) : (\n                                                        <View className=\"w-8 h-8 rounded-full bg-slate-200 flex items-center justify-center\">\n                                                            <User size={16} className=\"text-slate-400\" />\n                                                        </View>\n                                                    )}\n                                                    <Text weight={isCurrentUser ? \"bold\" : \"medium\"} color={isCurrentUser ? \"primary\" : \"secondary\"}>\n                                                        {entry.username}\n                                                        {isCurrentUser && <span className=\"ml-2 text-xs bg-brand-primary text-white px-2 py-0.5 rounded-full\">あなた</span>}\n                                                    </Text>\n                                                </Flex>\n\n                                                <View className=\"text-right\">\n                                                    <Text weight=\"bold\" color=\"primary\" variant=\"detail\">{entry.score.toLocaleString()}</Text>\n                                                    <Text variant=\"xs\" color=\"secondary\" className=\"text-[10px]\">pts</Text>\n                                                </View>\n                                            </Flex>\n                                        </View>\n                                    );\n                                })\n                            )}\n                        </Stack>\n                    </Card>\n\n                    <View className=\"text-center px-8\">\n                        <Text variant=\"xs\" color=\"secondary\">\n                            ※ スコアは正解数と回答時間によって算出されます。より早く正確に答えて上位を目指しましょう！\n                        </Text>\n                    </View>\n                </Stack>\n            </View>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/app/design/example/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/app/edit-requests/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/app/home/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":16,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Button"},"fix":{"range":[327,388],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useRecentCollections' is defined but never used.","line":10,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":30,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"useRecentCollections"},"fix":{"range":[388,476],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CollectionCard' is defined but never used.","line":11,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":24,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"CollectionCard"},"fix":{"range":[476,563],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Spinner' is defined but never used.","line":12,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":17,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Spinner"},"fix":{"range":[563,626],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Link' is defined but never used.","line":14,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":12,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Link"},"fix":{"range":[679,709],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Flex' is defined but never used.","line":21,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":14,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Flex"},"fix":{"range":[1161,1214],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'cn' is defined but never used.","line":26,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":12,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"cn"},"fix":{"range":[1483,1527],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'createMatchRoom' is defined but never used.","line":28,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":25,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"createMatchRoom"},"fix":{"range":[1572,1633],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'router' is assigned a value but never used.","line":31,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'user' is assigned a value but never used.","line":32,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React from 'react';\nimport { Container } from '@/src/design/primitives/Container';\nimport { Card } from '@/src/design/baseComponents/Card';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { Grid } from '@/src/design/primitives/Grid';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { useRecentCollections } from '@/src/features/collections/hooks/useCollections';\nimport { CollectionCard } from '@/src/features/collections/components/CollectionCard';\nimport { Spinner } from '@/src/design/baseComponents/Spinner';\nimport { useAuth } from '@/src/shared/auth/useAuth';\nimport Link from 'next/link';\nimport { NavCards } from '@/src/features/home/components/NavCards';\nimport { TimelineTabs } from '@/src/features/home/components/TimelineTabs';\nimport { ResumeQuizSummary } from '@/src/features/quiz/components/ResumeQuizSummary';\nimport { EditRequestNotification } from '@/src/features/home/components/EditRequestNotification';\nimport { SectionHeader } from '@/src/shared/components/SectionHeader';\nimport { View } from '@/src/design/primitives/View';\nimport { Flex } from '@/src/design/primitives/Flex';\nimport { Newspaper, Swords, LogIn, Plus } from 'lucide-react';\nimport { BattleJoinModal } from '@/src/features/battle/components/BattleJoinModal';\nimport { BattleCreateModal } from '@/src/features/battle/components/BattleCreateModal';\nimport { useState } from 'react';\nimport { cn } from '@/src/shared/utils/cn';\nimport { useRouter } from 'next/navigation';\nimport { createMatchRoom } from '@/src/features/battle/api';\n\nexport default function Home() {\n  const router = useRouter();\n  const { user } = useAuth();\n  const [showJoin, setShowJoin] = useState(false);\n  const [showCreate, setShowCreate] = useState(false);\n\n  return (\n    <View className=\"min-h-screen bg-surface-muted py-12\">\n      <Container>\n        <Stack gap=\"xl\">\n          {/* ナビゲーションカード */}\n          <NavCards />\n\n          {/* 通知・再開セクション */}\n          <Stack gap=\"sm\">\n            <EditRequestNotification />\n            <ResumeQuizSummary />\n          </Stack>\n\n          {/* 対戦（バトル）セクション */}\n          <Stack gap=\"lg\" id=\"battle\">\n            <SectionHeader\n              icon={Swords}\n              title=\"リアルタイム対戦\"\n              description=\"友達や他のユーザーとクイズで競い合いましょう\"\n            />\n            <Grid cols={{ sm: 1, md: 2 }} gap=\"md\">\n              <Card\n                onClick={() => setShowCreate(true)}\n                bg=\"base\"\n                className=\"cursor-pointer transition-all hover:shadow-lg hover:-translate-y-1 active:scale-95 border-2 border-brand-primary/10\"\n              >\n                <Stack gap=\"md\" align=\"center\" className=\"py-8\">\n                  <View bg=\"muted\" className=\"p-4 rounded-brand-full text-brand-primary\">\n                    <Plus size={32} />\n                  </View>\n                  <Stack gap=\"xs\" align=\"center\">\n                    <Text variant=\"h3\" weight=\"bold\">ルームを作成</Text>\n                    <Text variant=\"xs\" color=\"secondary\" align=\"center\">\n                      ルームを新規作成して友達を招待します\n                    </Text>\n                  </Stack>\n                </Stack>\n              </Card>\n\n              <Card\n                onClick={() => setShowJoin(true)}\n                bg=\"base\"\n                className=\"cursor-pointer transition-all hover:shadow-lg hover:-translate-y-1 active:scale-95 border-2 border-brand-secondary/20\"\n              >\n                <Stack gap=\"md\" align=\"center\" className=\"py-8\">\n                  <View bg=\"muted\" className=\"p-4 rounded-brand-full text-brand-secondary\">\n                    <LogIn size={32} />\n                  </View>\n                  <Stack gap=\"xs\" align=\"center\">\n                    <Text variant=\"h3\" weight=\"bold\">ルームに参加</Text>\n                    <Text variant=\"xs\" color=\"secondary\" align=\"center\">\n                      ルームIDを入力して既存のルームに参加します\n                    </Text>\n                  </Stack>\n                </Stack>\n              </Card>\n            </Grid>\n          </Stack>\n\n          {/* 通知・再開セクション */}\n          <Stack gap=\"sm\">\n            <EditRequestNotification />\n            <ResumeQuizSummary />\n          </Stack>\n\n          {/* タイムライン */}\n          <Stack gap=\"lg\">\n            <SectionHeader\n              icon={Newspaper}\n              title=\"タイムライン\"\n              description=\"コミュニティの活動をチェックしましょう\"\n            />\n            <TimelineTabs />\n          </Stack>\n        </Stack>\n      </Container>\n\n      <BattleJoinModal isOpen={showJoin} onClose={() => setShowJoin(false)} />\n      <BattleCreateModal isOpen={showCreate} onClose={() => setShowCreate(false)} />\n    </View>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/app/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/app/login/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/app/page.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/workspace/frontend/app/page.tsx:24:7\n  22 |   useEffect(() => {\n  23 |     if (!authLoading) {\n> 24 |       setReady(true);\n     |       ^^^^^^^^ Avoid calling setState() directly within an effect\n  25 |     }\n  26 |   }, [authLoading]);\n  27 |","line":24,"column":7,"nodeType":null,"endLine":24,"endColumn":15}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState, useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { View } from '@/src/design/primitives/View';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { useAuth } from '@/src/shared/auth/useAuth';\nimport Image from 'next/image';\n\n/**\n * ルート画面 (準備画面)\n * 旧環境 (frontend-old) の構成をデザインシステムで再現。\n * 無料デプロイ環境のコールドスタート対策として機能します。\n */\nexport default function LandingPage() {\n  const router = useRouter();\n  const { loading: authLoading } = useAuth();\n  const [ready, setReady] = useState(false);\n\n  useEffect(() => {\n    if (!authLoading) {\n      setReady(true);\n    }\n  }, [authLoading]);\n\n  const handleStart = () => {\n    if (ready) {\n      router.push('/home');\n    }\n  };\n\n  return (\n    <View bg=\"base\" className=\"min-h-screen flex items-center justify-center p-6\">\n      <Stack gap=\"xl\" align=\"center\" className=\"max-w-sm w-full\">\n        {/* ロゴとアプリ名 */}\n        <Stack gap=\"md\" align=\"center\">\n          <View\n            className=\"relative w-24 h-24 overflow-hidden rounded-brand-lg\"\n            bg=\"muted\"\n          >\n            <Image\n              src=\"/logo_black.png\"\n              alt=\"AiQ Logo\"\n              fill\n              className=\"object-contain p-2\"\n            />\n          </View>\n          <Text variant=\"h1\" weight=\"bold\" color=\"primary\" className=\"tracking-tight\">\n            AiQ\n          </Text>\n          <Text variant=\"body\" color=\"secondary\" className=\"text-center\">\n            あなた専用のクイズ学習アプリ。\n          </Text>\n        </Stack>\n\n        <View className=\"w-full mt-8\">\n          <Button\n            size=\"lg\"\n            fullWidth\n            loading={!ready}\n            onClick={handleStart}\n            className=\"py-6 text-lg\"\n          >\n            はじめる\n          </Button>\n        </View>\n      </Stack>\n    </View>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/app/quiz/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useMemo' is defined but never used.","line":3,"column":51,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":58,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useMemo"},"fix":{"range":[63,72],"text":""},"desc":"Remove unused variable \"useMemo\"."}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/workspace/frontend/app/quiz/page.tsx:35:17\n  33 |             if (data.quizId && data.questions) {\n  34 |                 // Ranking Quiz (Bulk Mode)\n> 35 |                 setRankingQuizId(data.quizId);\n     |                 ^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  36 |                 const qs = data.questions.map((q: any) => ({\n  37 |                     id: q.id,\n  38 |                     questionText: q.questionText,","line":35,"column":17,"nodeType":null,"endLine":35,"endColumn":33},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":36,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":36,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1693,1696],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1693,1696],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'submission' is assigned a value but never used.","line":73,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":73,"endColumn":37}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { View } from '@/src/design/primitives/View';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { QuizForm } from '@/src/features/quiz/components/QuizForm';\nimport { Result } from '@/src/features/quiz/components/Result';\nimport { submitAnswer, submitRankingAllAnswers } from '@/src/features/quiz/api';\nimport { Question } from '@/src/entities/question';\nimport { CasualQuiz, AnswerHistory } from '@/src/entities/quiz';\n\nimport { BackButton } from '@/src/shared/components/Navigation/BackButton';\n\nexport default function QuizPage() {\n    const router = useRouter();\n\n    const [questions, setQuestions] = useState<Question[]>([]);\n    const [quiz, setQuiz] = useState<CasualQuiz | null>(null);\n    const [rankingQuizId, setRankingQuizId] = useState<string | null>(null);\n    const [currentIndex, setCurrentIndex] = useState(0);\n    const [isCorrect, setIsCorrect] = useState<boolean | null>(null);\n    const [userAnswers, setUserAnswers] = useState<AnswerHistory[]>([]);\n    const [isSubmitting, setIsSubmitting] = useState(false);\n\n    useEffect(() => {\n        if (typeof window === 'undefined') return;\n        const stored = sessionStorage.getItem('quizData');\n        if (stored) {\n            const data = JSON.parse(stored);\n            if (data.quizId && data.questions) {\n                // Ranking Quiz (Bulk Mode)\n                setRankingQuizId(data.quizId);\n                const qs = data.questions.map((q: any) => ({\n                    id: q.id,\n                    questionText: q.questionText,\n                    correctAnswers: ['???'], // Hide until the end\n                    collectionId: data.collectionId\n                }));\n                setQuestions(qs);\n            } else {\n                // Casual Quiz\n                setQuestions(data.questions || []);\n                setQuiz(data.quiz || null);\n            }\n        }\n    }, []);\n\n    const judgeAnswer = useCallback((userAnswer: string, correctAnswers: string[]): boolean => {\n        const normalized = userAnswer.trim().toLowerCase();\n        return correctAnswers.some(ans => ans.trim().toLowerCase() === normalized);\n    }, []);\n\n    const handleAnswer = useCallback(async (userAnswerText: string) => {\n        const q = questions[currentIndex];\n\n        if (rankingQuizId) {\n            // Ranking Mode: Just store answer and move to next (no feedback)\n            const answer: AnswerHistory = {\n                question: q,\n                userAnswer: userAnswerText,\n                correct: false, // Don't know yet\n            };\n            const updatedAnswers = [...userAnswers, answer];\n            setUserAnswers(updatedAnswers);\n\n            if (currentIndex + 1 >= questions.length) {\n                // Finish and submit all\n                setIsSubmitting(true);\n                try {\n                    const submission = updatedAnswers.map(a => ({\n                        question_id: a.question.id,\n                        answer: a.userAnswer,\n                        time_taken_millis: 0, // Could add timer here\n                    }));\n\n                    // Note: We need to use camelCase for the API client if it handles conversion, \n                    // or snake_case if it doesn't. Based on api/index.ts, we use camelCase in TS.\n                    const resp = await submitRankingAllAnswers(rankingQuizId, updatedAnswers.map(a => ({\n                        questionId: a.question.id,\n                        answer: a.userAnswer,\n                        timeTakenMillis: 0,\n                    })));\n\n                    // Enrich answers with actual results from backend\n                    const enrichedAnswers = updatedAnswers.map(a => {\n                        const results = resp.detailedResults || [];\n                        const result = results.find(r =>\n                            r.questionId.toLowerCase() === a.question.id.toLowerCase()\n                        );\n\n                        if (result) {\n                            return {\n                                ...a,\n                                correct: result.isCorrect,\n                                question: {\n                                    ...a.question,\n                                    correctAnswers: [result.correctAnswer],\n                                }\n                            };\n                        } else {\n                            return a;\n                        }\n                    });\n\n                    sessionStorage.setItem('quizResult', JSON.stringify(resp));\n                    sessionStorage.setItem('quizAnswers', JSON.stringify(enrichedAnswers));\n                    router.push('/quiz/score');\n                } catch (err) {\n                    console.error('Failed to submit ranking answers', err);\n                    alert('回答の送信に失敗しました。');\n                    setIsSubmitting(false);\n                }\n            } else {\n                setCurrentIndex(prev => prev + 1);\n            }\n        } else if (quiz) {\n            // Casual mode: Show feedback\n            const correct = judgeAnswer(userAnswerText, q.correctAnswers);\n            setIsCorrect(correct);\n\n            const answer: AnswerHistory = {\n                question: q,\n                userAnswer: userAnswerText,\n                correct,\n            };\n            setUserAnswers(prev => [...prev, answer]);\n\n            try {\n                await submitAnswer(quiz.id, {\n                    questionId: q.id,\n                    userAnswer: userAnswerText,\n                    elapsedMillis: 0,\n                });\n            } catch (err) {\n                console.error('Failed to submit casual answer', err);\n            }\n        }\n    }, [questions, currentIndex, quiz, rankingQuizId, judgeAnswer, userAnswers, router]);\n\n    const handleNext = useCallback(() => {\n        if (currentIndex + 1 >= questions.length) {\n            if (typeof window !== 'undefined') {\n                sessionStorage.setItem('quizAnswers', JSON.stringify(userAnswers));\n            }\n            router.push('/quiz/score');\n        } else {\n            setCurrentIndex(i => i + 1);\n            setIsCorrect(null);\n        }\n    }, [currentIndex, questions, userAnswers, router]);\n\n    if (isSubmitting) {\n        return (\n            <div className=\"min-h-screen flex flex-col items-center justify-center bg-surface-muted\">\n                <Stack gap=\"md\" align=\"center\">\n                    <View className=\"w-12 h-12 border-4 border-brand-primary border-t-transparent rounded-full animate-spin\" />\n                    <Text weight=\"bold\">結果を送信中...</Text>\n                </Stack>\n            </div>\n        );\n    }\n\n    if (questions.length === 0) {\n        return (\n            <div className=\"min-h-screen flex flex-col bg-surface-muted\">\n                <BackButton />\n                <View className=\"flex-1 flex flex-col items-center justify-center gap-4\">\n                    <Text variant=\"h2\" weight=\"bold\">クイズデータが見つかりません</Text>\n                    <Text color=\"secondary\">クイズはスタート画面から始めてください。</Text>\n                    <Button variant=\"solid\" color=\"primary\" onClick={() => router.push('/home')}>\n                        ホームに戻る\n                    </Button>\n                </View>\n            </div>\n        );\n    }\n\n    const currentQuestion = questions[currentIndex];\n\n    return (\n        <div className=\"min-h-screen flex flex-col bg-surface-muted pt-20\">\n            <BackButton />\n            <View className=\"flex-1 flex items-center justify-center px-4\">\n                {isCorrect !== null ? (\n                    <Result\n                        isCorrect={isCorrect}\n                        correctAnswer={currentQuestion.correctAnswers.join(' / ')}\n                        description={currentQuestion.descriptionText}\n                        onNext={handleNext}\n                        question={currentQuestion}\n                    />\n                ) : (\n                    <QuizForm\n                        key={currentIndex} // Reset form for each question\n                        questionText={currentQuestion.questionText}\n                        questionNumber={currentIndex + 1}\n                        totalQuestions={questions.length}\n                        onSubmitAnswer={handleAnswer}\n                    />\n                )}\n            </View>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/app/quiz/resume/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Container' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":19,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Container"},"fix":{"range":[42,105],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'props' is defined but never used.","line":41,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":41,"endColumn":46},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":41,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":41,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1705,1708],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1705,1708],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React from 'react';\nimport { Container } from '@/src/design/primitives/Container';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { ResumeQuizList } from '@/src/features/quiz/components/ResumeQuizList';\nimport { View } from '@/src/design/primitives/View';\nimport { BackButton } from '@/src/shared/components/Navigation/BackButton';\nimport { History } from 'lucide-react';\nimport { Flex } from '@/src/design/primitives/Flex';\n\nexport default function ResumeQuizPage() {\n    return (\n        <View className=\"min-h-screen bg-surface-muted/30 pb-20\">\n            <View className=\"max-w-4xl mx-auto px-4 pt-8\">\n                <Stack gap=\"xl\">\n                    <Stack gap=\"xs\">\n                        <BackButton />\n                        <Flex align=\"center\" gap=\"sm\">\n                            <History className=\"text-brand-primary\" size={28} />\n                            <Text variant=\"h1\" weight=\"bold\" className=\"tracking-tight\">\n                                学習を再開する\n                            </Text>\n                        </Flex>\n                        <Text color=\"secondary\">\n                            中断したクイズの続きから学習を再開できます。\n                        </Text>\n                    </Stack>\n\n                    <Card variant=\"outline\" padding=\"none\" className=\"bg-transparent border-none shadow-none\">\n                        <ResumeQuizList />\n                    </Card>\n                </Stack>\n            </View>\n        </View>\n    );\n}\n\n// Simple wrapper to avoid duplicating too much logic if ResumeQuizList has its own SectionHeader\nfunction Card({ children, className, ...props }: any) {\n    return <View className={className}>{children}</View>;\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/app/quiz/score/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'RotateCcw' is defined but never used.","line":14,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":25,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"RotateCcw"},"fix":{"range":[629,640],"text":""},"desc":"Remove unused variable \"RotateCcw\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":21,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1037,1040],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1037,1040],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/workspace/frontend/app/quiz/score/page.tsx:29:13\n  27 |         const storedResult = sessionStorage.getItem('quizResult');\n  28 |         if (storedResult) {\n> 29 |             setRankingResult(JSON.parse(storedResult));\n     |             ^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  30 |             sessionStorage.removeItem('quizResult');\n  31 |         }\n  32 |","line":29,"column":13,"nodeType":null,"endLine":29,"endColumn":29}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState, useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { Container } from '@/src/design/primitives/Container';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { Flex } from '@/src/design/primitives/Flex';\nimport { Card } from '@/src/design/baseComponents/Card';\nimport { View } from '@/src/design/primitives/View';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { AnswerHistory } from '@/src/entities/quiz';\nimport { Question } from '@/src/entities/question';\nimport { Home, RotateCcw, CheckCircle, XCircle, Trophy, MessageSquare } from 'lucide-react';\nimport { cn } from '@/src/shared/utils/cn';\nimport { EditRequestModal } from '@/src/features/questions/components/EditRequestModal';\n\nexport default function QuizScorePage() {\n    const router = useRouter();\n    const [answers, setAnswers] = useState<AnswerHistory[]>([]);\n    const [rankingResult, setRankingResult] = useState<any>(null);\n    const [selectedQuestion, setSelectedQuestion] = useState<Question | null>(null);\n\n    useEffect(() => {\n        if (typeof window === 'undefined') return;\n\n        const storedResult = sessionStorage.getItem('quizResult');\n        if (storedResult) {\n            setRankingResult(JSON.parse(storedResult));\n            sessionStorage.removeItem('quizResult');\n        }\n\n        const storedAnswers = sessionStorage.getItem('quizAnswers');\n        if (storedAnswers) {\n            setAnswers(JSON.parse(storedAnswers));\n            sessionStorage.removeItem('quizAnswers');\n        }\n\n        sessionStorage.removeItem('quizData');\n    }, []);\n\n    const correctCount = rankingResult ? rankingResult.correctCount : answers.filter(a => a.correct).length;\n    const totalCount = rankingResult ? rankingResult.totalQuestions : answers.length;\n    const percentage = totalCount > 0 ? Math.round((correctCount / totalCount) * 100) : 0;\n    const score = rankingResult?.score;\n\n    if (!rankingResult && answers.length === 0) {\n        return (\n            <View className=\"min-h-screen flex flex-col items-center justify-center gap-4 bg-surface-muted\">\n                <Text variant=\"h2\" weight=\"bold\">結果データが見つかりません</Text>\n                <Button variant=\"solid\" color=\"primary\" onClick={() => router.push('/home')}>\n                    ホームに戻る\n                </Button>\n            </View>\n        );\n    }\n\n    return (\n        <View className=\"min-h-screen bg-surface-muted py-12\">\n            <Container>\n                <Stack gap=\"xl\">\n                    {/* Score Summary */}\n                    <Card className=\"border border-gray-300 text-center\">\n                        <Stack gap=\"lg\" align=\"center\" className=\"py-6\">\n                            <Trophy size={48} className=\"text-brand-primary\" />\n                            <Text variant=\"h1\" weight=\"bold\">クイズ完了！</Text>\n\n                            <View className=\"text-center\">\n                                <Text\n                                    variant=\"h1\"\n                                    weight=\"bold\"\n                                    className={cn(\n                                        percentage >= 80 ? \"text-brand-success\" :\n                                            percentage >= 50 ? \"text-brand-warning\" :\n                                                \"text-brand-danger\"\n                                    )}\n                                >\n                                    {score !== undefined ? `${score.toLocaleString()} pts` : `${percentage}%`}\n                                </Text>\n                                <Stack gap=\"xs\" align=\"center\">\n                                    <Text color=\"secondary\" variant=\"detail\" weight=\"medium\">\n                                        {correctCount} / {totalCount} 正解\n                                    </Text>\n                                    {rankingResult?.rank && (\n                                        <View className=\"bg-brand-primary/10 px-4 py-2 rounded-brand-full border border-brand-primary/20 animate-in fade-in zoom-in duration-500\">\n                                            <Flex gap=\"sm\" align=\"center\">\n                                                <Trophy size={20} className=\"text-brand-primary\" />\n                                                <Text variant=\"h3\" weight=\"bold\" color=\"primary\">\n                                                    現在の順位: {rankingResult.rank}位\n                                                </Text>\n                                            </Flex>\n                                        </View>\n                                    )}\n                                </Stack>\n                            </View>\n\n                            <Flex gap=\"md\">\n                                {rankingResult && (\n                                    <Button\n                                        variant=\"solid\"\n                                        color=\"primary\"\n                                        onClick={() => router.push(`/collections/${rankingResult.collectionId}/ranking`)}\n                                        className=\"gap-1.5\"\n                                    >\n                                        <Trophy size={16} />\n                                        ランキングを見る\n                                    </Button>\n                                )}\n                                <Button\n                                    variant=\"outline\"\n                                    onClick={() => router.push('/home')}\n                                    className=\"gap-1.5\"\n                                >\n                                    <Home size={16} />\n                                    ホーム\n                                </Button>\n                            </Flex>\n                        </Stack>\n                    </Card>\n\n                    {/* Answer History (Only if available) */}\n                    {answers.length > 0 && (\n                        <Stack gap=\"md\">\n                            <Text variant=\"h3\" weight=\"bold\">回答一覧</Text>\n                            {answers.map((answer, index) => (\n                                <Card\n                                    key={index}\n                                    className={cn(\n                                        \"border-2\",\n                                        answer.correct\n                                            ? \"border-brand-success/30 bg-brand-success/5\"\n                                            : \"border-brand-danger/30 bg-brand-danger/5\"\n                                    )}\n                                >\n                                    <Flex gap=\"md\" align=\"start\">\n                                        <View className=\"mt-1 shrink-0\">\n                                            {answer.correct ? (\n                                                <CheckCircle size={20} className=\"text-brand-success\" />\n                                            ) : (\n                                                <XCircle size={20} className=\"text-brand-danger\" />\n                                            )}\n                                        </View>\n                                        <Stack gap=\"xs\" className=\"flex-1\">\n                                            <Flex justify=\"between\" align=\"start\">\n                                                <Text weight=\"medium\">{answer.question.questionText}</Text>\n                                                <Button\n                                                    variant=\"ghost\"\n                                                    size=\"sm\"\n                                                    className=\"h-7 px-2 text-[10px] gap-1 text-secondary hover:text-brand-primary\"\n                                                    onClick={() => setSelectedQuestion(answer.question)}\n                                                >\n                                                    <MessageSquare size={12} />\n                                                    修正提案\n                                                </Button>\n                                            </Flex>\n                                            <Flex gap=\"lg\" align=\"center\" wrap={true}>\n                                                <Text variant=\"xs\" color=\"secondary\" as=\"span\">\n                                                    あなたの答え: <Text weight=\"bold\" className=\"inline\" as=\"span\">{answer.userAnswer}</Text>\n                                                </Text>\n                                                {!answer.correct && answer.question.correctAnswers[0] !== '???' && (\n                                                    <Text variant=\"xs\" color=\"primary\" as=\"span\">\n                                                        正解: <Text weight=\"bold\" color=\"primary\" className=\"inline\" as=\"span\">{answer.question.correctAnswers.join(' / ')}</Text>\n                                                    </Text>\n                                                )}\n                                            </Flex>\n                                        </Stack>\n                                    </Flex>\n                                </Card>\n                            ))}\n                        </Stack>\n                    )}\n                </Stack>\n            </Container>\n\n            {selectedQuestion && (\n                <EditRequestModal\n                    question={selectedQuestion}\n                    onClose={() => setSelectedQuestion(null)}\n                />\n            )}\n        </View>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/app/quiz/start/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/app/settings/password/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/app/users/[userId]/favorites/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/app/users/[userId]/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'cn' is defined but never used.","line":16,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":12,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"cn"},"fix":{"range":[726,770],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'updated' is defined but never used.","line":175,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":175,"endColumn":40},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'s' is defined but never used.","line":185,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":185,"endColumn":34}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState } from 'react';\nimport { useParams, useRouter } from 'next/navigation';\nimport { Container } from '@/src/design/primitives/Container';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { Spinner } from '@/src/design/baseComponents/Spinner';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { UserHeader } from '@/src/features/users/components/UserHeader';\nimport { UserContentTabs } from '@/src/features/users/components/UserContentTabs';\nimport { useProfile } from '@/src/features/users/hooks/useProfile';\nimport { Plus } from 'lucide-react';\n\nimport { useAuth } from '@/src/shared/auth/useAuth';\nimport { cn } from '@/src/shared/utils/cn';\nimport { BackButton } from '@/src/shared/components/Navigation/BackButton';\n\nimport { Collection, CollectionSet } from '@/src/entities/collection';\nimport { CollectionCreateForm } from '@/src/features/collections/components/CollectionCreateForm';\nimport { CollectionEditModal } from '@/src/features/collections/components/CollectionEditModal';\nimport { deleteCollection } from '@/src/features/collections/api';\n\nimport { startRankingQuiz } from '@/src/features/quiz/api';\n\nimport { CollectionSetForm } from '@/src/features/collectionSets/components/CollectionSetForm';\nimport { deleteSet } from '@/src/features/collectionSets/api';\nimport { AddToSetModal } from '@/src/features/collectionSets/components/AddToSetModal';\nimport { useUserCollections, useUserCollectionSets } from '@/src/features/collections/hooks/useCollections';\n\nexport default function UserPage() {\n    const params = useParams();\n    const router = useRouter();\n    const { user } = useAuth();\n    const userId = params.userId as string;\n\n    const { profile, loading: profileLoading, error: profileError } = useProfile(userId);\n    const { collections } = useUserCollections(userId);\n    const { collectionSets, refresh: refreshSets } = useUserCollectionSets(userId);\n\n    const [showCreateForm, setShowCreateForm] = useState(false);\n    const [showCreateSetForm, setShowCreateSetForm] = useState(false);\n    const [editingCollection, setEditingCollection] = useState<Collection | null>(null);\n    const [editingSet, setEditingSet] = useState<CollectionSet | null>(null);\n\n    const [targetCollectionId, setTargetCollectionId] = useState<string | null>(null);\n    const [isAddToSetModalOpen, setIsAddToSetModalOpen] = useState(false);\n\n    const isOwnProfile = !!(user && user.id === userId);\n\n    const handleOpenAddToSet = (collectionId: string) => {\n        setTargetCollectionId(collectionId);\n        setIsAddToSetModalOpen(true);\n    };\n\n    const handleStartRanking = async (id: string) => {\n        try {\n            const resp = await startRankingQuiz(id);\n            if (typeof window !== 'undefined') {\n                sessionStorage.setItem('quizData', JSON.stringify(resp));\n            }\n            router.push('/quiz');\n        } catch (err) {\n            console.error('Failed to start ranking quiz', err);\n        }\n    };\n\n    const handleDeleteCollection = async (id: string) => {\n        if (!confirm('本当にこのコレクションを削除しますか？内の問題もすべて削除されます。')) return;\n        try {\n            await deleteCollection(id);\n            window.location.reload();\n        } catch (err) {\n            console.error('Failed to delete collection', err);\n        }\n    };\n\n    const handleEditCollection = (id: string) => {\n        const target = collections.find(c => c.id === id);\n        if (target) {\n            setEditingCollection(target);\n        }\n    };\n\n    const handleDeleteSet = async (id: string) => {\n        try {\n            await deleteSet(id);\n            refreshSets();\n        } catch (err) {\n            console.error('Failed to delete set', err);\n        }\n    };\n\n    const handleEditSet = (id: string) => {\n        const target = collectionSets.find(s => s.id === id);\n        if (target) {\n            setEditingSet(target);\n        }\n    };\n\n    if (profileLoading) {\n        return (\n            <div className=\"flex justify-center py-20\">\n                <Spinner size=\"lg\" />\n            </div>\n        );\n    }\n\n    if (profileError || !profile) {\n        return (\n            <Container className=\"py-20 text-center\">\n                <Text color=\"danger\">エラー: {profileError || 'ユーザーが見つかりません'}</Text>\n            </Container>\n        );\n    }\n\n    return (\n        <div className=\"min-h-screen bg-surface-muted transition-all duration-300\">\n            <BackButton />\n            <Container className=\"pt-20 pb-12\">\n                <Stack gap=\"xl\">\n                    <UserHeader profile={profile} />\n\n                    <UserContentTabs\n                        userId={userId}\n                        isSelectionMode={false}\n                        selectedIds={[]}\n                        onToggleCollection={() => { }}\n                        onDeleteCollection={isOwnProfile ? handleDeleteCollection : undefined}\n                        onEditCollection={isOwnProfile ? handleEditCollection : undefined}\n                        onStartRanking={handleStartRanking}\n                        onAddToSet={handleOpenAddToSet} // Available for all collections\n                        onDeleteSet={isOwnProfile ? handleDeleteSet : undefined}\n                        onEditSet={isOwnProfile ? handleEditSet : undefined}\n                        collectionActions={isOwnProfile && (\n                            <Button\n                                size=\"md\"\n                                variant=\"outline\"\n                                className=\"gap-1.5\"\n                                onClick={() => setShowCreateForm(true)}\n                            >\n                                <Plus size={18} />\n                                新規作成\n                            </Button>\n                        )}\n                        setActions={isOwnProfile && (\n                            <Button\n                                size=\"md\"\n                                variant=\"outline\"\n                                className=\"gap-1.5\"\n                                onClick={() => setShowCreateSetForm(true)}\n                            >\n                                <Plus size={18} />\n                                新規作成\n                            </Button>\n                        )}\n                        hideExtras={false} // Show extras on user profile\n                    />\n                </Stack>\n            </Container>\n\n            {showCreateForm && (\n                <CollectionCreateForm\n                    onCreated={(c) => {\n                        setShowCreateForm(false);\n                        router.push(`/collections/${c.id}`);\n                    }}\n                    onCancel={() => setShowCreateForm(false)}\n                />\n            )}\n\n            {editingCollection && (\n                <CollectionEditModal\n                    collection={editingCollection}\n                    onUpdated={(updated) => {\n                        setEditingCollection(null);\n                        window.location.reload();\n                    }}\n                    onCancel={() => setEditingCollection(null)}\n                />\n            )}\n\n            {showCreateSetForm && (\n                <CollectionSetForm\n                    onSuccess={(s) => {\n                        setShowCreateSetForm(false);\n                        refreshSets();\n                    }}\n                    onCancel={() => setShowCreateSetForm(false)}\n                />\n            )}\n\n            {editingSet && (\n                <CollectionSetForm\n                    initialData={editingSet}\n                    onSuccess={() => {\n                        setEditingSet(null);\n                        refreshSets();\n                    }}\n                    onCancel={() => setEditingSet(null)}\n                />\n            )}\n\n            {isAddToSetModalOpen && targetCollectionId && (\n                <AddToSetModal\n                    collectionId={targetCollectionId}\n                    onClose={() => setIsAddToSetModalOpen(false)}\n                    onSuccess={() => {\n                        setTargetCollectionId(null);\n                        setIsAddToSetModalOpen(false);\n                    }}\n                />\n            )}\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/app/users/official/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/app/users/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/postcss.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/baseComponents/Badge.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'RadiusKey' is defined but never used.","line":4,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":34,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"RadiusKey"},"fix":{"range":[160,171],"text":""},"desc":"Remove unused variable \"RadiusKey\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { cva, type VariantProps } from 'class-variance-authority';\nimport { cn } from '@/src/shared/utils/cn';\nimport { BrandColorKey, RadiusKey } from '../tokens/keys';\n\nconst variantMap: Record<BrandColorKey, string> = {\n    primary: 'bg-brand-primary/10 text-brand-primary border-brand-primary/20',\n    secondary: 'bg-brand-secondary/10 text-brand-secondary border-brand-secondary/20',\n    danger: 'bg-brand-danger/10 text-brand-danger border-brand-danger/20',\n    success: 'bg-brand-success/10 text-brand-success border-brand-success/20',\n    heart: 'bg-brand-heart/10 text-brand-heart border-brand-heart/20',\n    warning: 'bg-brand-warning/10 text-brand-warning border-brand-warning/20',\n    info: 'bg-brand-info/10 text-brand-info border-brand-info/20',\n};\n\nconst badgeVariants = cva(\n    'inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2',\n    {\n        variants: {\n            variant: variantMap,\n            rounded: {\n                none: 'rounded-none',\n                sm: 'rounded-brand-sm',\n                md: 'rounded-brand-md',\n                lg: 'rounded-brand-lg',\n                full: 'rounded-brand-full',\n            },\n        },\n        defaultVariants: {\n            variant: 'primary',\n            rounded: 'full',\n        },\n    }\n);\n\nexport interface BadgeProps\n    extends Omit<React.HTMLAttributes<HTMLDivElement>, 'color'>,\n    VariantProps<typeof badgeVariants> { }\n\n/**\n * ステータスやカテゴリなどの小さな情報を表示するためのバッジコンポーネントです。\n */\nexport function Badge({ className, variant, rounded, ...props }: BadgeProps) {\n    return (\n        <div className={cn(badgeVariants({ variant, rounded, className }))} {...props} />\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/baseComponents/Breadcrumbs.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'cn' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":12,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"cn"},"fix":{"range":[101,145],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { Flex } from '../primitives/Flex';\nimport { Text } from './Text';\nimport { cn } from '@/src/shared/utils/cn';\nimport { ChevronRight } from 'lucide-react';\n\nexport interface BreadcrumbItem {\n    label: string;\n    href?: string;\n    icon?: React.ReactNode;\n}\n\nexport interface BreadcrumbsProps {\n    items: BreadcrumbItem[];\n    separator?: React.ReactNode;\n    className?: string;\n}\n\n/**\n * ページの階層構造を示すナビゲーションコンポーネントです。\n */\nexport function Breadcrumbs({\n    items,\n    separator = <ChevronRight size={14} className=\"text-slate-400\" />,\n    className\n}: BreadcrumbsProps) {\n    return (\n        <nav aria-label=\"Breadcrumb\" className={className}>\n            <Flex align=\"center\" gap=\"xs\" wrap>\n                {items.map((item, index) => {\n                    const isLast = index === items.length - 1;\n\n                    return (\n                        <React.Fragment key={index}>\n                            <Flex align=\"center\" gap=\"xs\">\n                                {item.icon}\n                                {isLast || !item.href ? (\n                                    <Text\n                                        variant=\"xs\"\n                                        weight={isLast ? 'bold' : 'medium'}\n                                        color={isLast ? 'primary' : 'muted'}\n                                    >\n                                        {item.label}\n                                    </Text>\n                                ) : (\n                                    <a\n                                        href={item.href}\n                                        className=\"text-xs font-medium text-slate-500 hover:text-brand-primary transition-colors\"\n                                    >\n                                        {item.label}\n                                    </a>\n                                )}\n                            </Flex>\n                            {!isLast && separator}\n                        </React.Fragment>\n                    );\n                })}\n            </Flex>\n        </nav>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/baseComponents/Button.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'RadiusKey' is defined but never used.","line":4,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":34,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"RadiusKey"},"fix":{"range":[160,171],"text":""},"desc":"Remove unused variable \"RadiusKey\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { cva, type VariantProps } from 'class-variance-authority';\nimport { cn } from '@/src/shared/utils/cn';\nimport { BrandColorKey, RadiusKey } from '../tokens/keys';\n\nconst variantMap: Record<BrandColorKey, string> = {\n    primary: '',\n    secondary: '',\n    danger: '',\n    success: '',\n    heart: '',\n    warning: '',\n    info: '',\n};\n\nconst buttonVariants = cva(\n    'inline-flex items-center justify-center whitespace-nowrap transition-all cursor-pointer focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-focus-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 active:scale-95',\n    {\n        variants: {\n            variant: {\n                solid: '',\n                outline: 'border-2 bg-transparent',\n                ghost: 'bg-transparent',\n            },\n            color: variantMap,\n            size: {\n                sm: 'h-8 px-3 text-xs',\n                md: 'h-10 px-4 text-sm',\n                lg: 'h-12 px-6 text-base',\n                icon: 'h-10 w-10',\n            },\n            rounded: {\n                none: 'rounded-none',\n                sm: 'rounded-brand-sm',\n                md: 'rounded-brand-md',\n                lg: 'rounded-brand-lg',\n                full: 'rounded-brand-full',\n            },\n            fullWidth: {\n                true: 'w-full',\n            },\n        },\n        compoundVariants: [\n            // Solid variants\n            { variant: 'solid', color: 'primary', className: 'bg-brand-primary text-white hover:bg-brand-primary/90 focus-visible:ring-brand-primary/20' },\n            { variant: 'solid', color: 'secondary', className: 'bg-brand-secondary text-white hover:bg-brand-secondary/90 focus-visible:ring-brand-secondary/20' },\n            { variant: 'solid', color: 'danger', className: 'bg-brand-danger text-white hover:bg-brand-danger/90 focus-visible:ring-brand-danger/20' },\n            { variant: 'solid', color: 'success', className: 'bg-brand-success text-white hover:bg-brand-success/90 focus-visible:ring-brand-success/20' },\n            { variant: 'solid', color: 'heart', className: 'bg-brand-heart text-white hover:bg-brand-heart/90 focus-visible:ring-brand-heart/20' },\n            { variant: 'solid', color: 'warning', className: 'bg-brand-warning text-white hover:bg-brand-warning/90 focus-visible:ring-brand-warning/20' },\n            { variant: 'solid', color: 'info', className: 'bg-brand-info text-white hover:bg-brand-info/90 focus-visible:ring-brand-info/20' },\n\n            // Outline variants\n            { variant: 'outline', color: 'primary', className: 'border-brand-primary text-brand-primary hover:bg-brand-primary/10 focus-visible:ring-brand-primary/20' },\n            { variant: 'outline', color: 'secondary', className: 'border-brand-secondary text-brand-secondary hover:bg-brand-secondary/10 focus-visible:ring-brand-secondary/20' },\n            { variant: 'outline', color: 'danger', className: 'border-brand-danger text-brand-danger hover:bg-brand-danger/10 focus-visible:ring-brand-danger/20' },\n            { variant: 'outline', color: 'success', className: 'border-brand-success text-brand-success hover:bg-brand-success/10 focus-visible:ring-brand-success/20' },\n            { variant: 'outline', color: 'heart', className: 'border-brand-heart text-brand-heart hover:bg-brand-heart/10 focus-visible:ring-brand-heart/20' },\n            { variant: 'outline', color: 'warning', className: 'border-brand-warning text-brand-warning hover:bg-brand-warning/10 focus-visible:ring-brand-warning/20' },\n            { variant: 'outline', color: 'info', className: 'border-brand-info text-brand-info hover:bg-brand-info/10 focus-visible:ring-brand-info/20' },\n\n            // Ghost variants\n            { variant: 'ghost', color: 'primary', className: 'text-brand-primary hover:bg-brand-primary/10' },\n            { variant: 'ghost', color: 'secondary', className: 'text-brand-secondary hover:bg-brand-secondary/10' },\n            { variant: 'ghost', color: 'danger', className: 'text-brand-danger hover:bg-brand-danger/10' },\n            { variant: 'ghost', color: 'success', className: 'text-brand-success hover:bg-brand-success/10' },\n            { variant: 'ghost', color: 'warning', className: 'text-brand-warning hover:bg-brand-warning/10' },\n            { variant: 'ghost', color: 'info', className: 'text-brand-info hover:bg-brand-info/10' },\n        ],\n        defaultVariants: {\n            variant: 'solid',\n            color: 'primary',\n            size: 'md',\n            rounded: 'md',\n            fullWidth: false,\n        },\n    }\n);\n\nimport { Spinner } from '../baseComponents/Spinner';\n\nexport interface ButtonProps\n    extends Omit<React.ButtonHTMLAttributes<HTMLButtonElement>, 'color'>,\n    VariantProps<typeof buttonVariants> {\n    asChild?: boolean;\n    loading?: boolean;\n    fullWidth?: boolean;\n}\n\n/**\n * ユーザーがアクションを実行するためのボタンコンポーネントです。\n */\nexport const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n    ({ className, variant, color, size, rounded, fullWidth, loading, children, disabled, ...props }, ref) => {\n        return (\n            <button\n                className={cn(buttonVariants({ variant, color, size, rounded, fullWidth, className }))}\n                ref={ref}\n                disabled={disabled || loading}\n                {...props}\n            >\n                {loading && <Spinner size=\"sm\" className=\"mr-2\" />}\n                {children}\n            </button>\n        );\n    }\n);\n\nButton.displayName = 'Button';\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/baseComponents/Card.tsx","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":5,"column":18,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":5,"endColumn":27,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[138,179],"text":"type CardProps = ViewProps"},"desc":"Replace empty interface with a type alias."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { cn } from '@/src/shared/utils/cn';\nimport { View, type ViewProps } from '../primitives/View';\n\nexport interface CardProps extends ViewProps { }\n\n/**\n * 情報を整理して表示するためのコンテナコンポーネントです。\n * デフォルトで背景色、角丸、影が適用されます。\n */\nexport const Card = React.forwardRef<HTMLElement, CardProps>(\n    ({ className, bg = 'card', rounded = 'lg', shadow = 'sm', padding = 'md', ...props }, ref) => {\n        return (\n            <View\n                ref={ref}\n                bg={bg}\n                rounded={rounded}\n                shadow={shadow}\n                padding={padding}\n                className={cn(className)}\n                {...props}\n            />\n        );\n    }\n);\n\nCard.displayName = 'Card';\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/baseComponents/Checkbox.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/baseComponents/Divider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/baseComponents/Drawer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/baseComponents/FormField.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/baseComponents/IconButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/baseComponents/Input.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":53,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":53,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1762,1765],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1762,1765],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { cva, type VariantProps } from 'class-variance-authority';\nimport { cn } from '@/src/shared/utils/cn';\nimport { RadiusKey } from '../tokens/keys';\n\nconst radiusMap: Record<RadiusKey, string> = {\n    none: 'rounded-none',\n    sm: 'rounded-brand-sm',\n    md: 'rounded-brand-md',\n    lg: 'rounded-brand-lg',\n    full: 'rounded-brand-full',\n};\n\nconst inputVariants = cva(\n    'w-full transition-all outline-none focus:ring-2 focus:ring-focus-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50',\n    {\n        variants: {\n            variant: {\n                default: 'border border-gray-300 bg-surface-base focus:border-brand-primary focus:ring-brand-primary/20',\n                error: 'border-brand-danger focus:ring-brand-danger/20',\n            },\n            size: {\n                sm: 'px-2 py-1 text-sm',\n                md: 'px-3 py-2 text-base',\n                lg: 'px-4 py-3 text-lg',\n            },\n            rounded: radiusMap,\n        },\n        defaultVariants: {\n            variant: 'default',\n            size: 'md',\n            rounded: 'md',\n        },\n    }\n);\n\nexport interface InputProps\n    extends Omit<React.InputHTMLAttributes<HTMLInputElement> & React.TextareaHTMLAttributes<HTMLTextAreaElement>, 'size' | 'color'>,\n    VariantProps<typeof inputVariants> {\n    multeline?: boolean;\n}\n\n/**\n * ユーザー入力を受け付けるための基本コンポーネントです。\n * `multeline` プロパティを有効にすることで textarea として動作します。\n */\nexport const Input = React.forwardRef<HTMLInputElement | HTMLTextAreaElement, InputProps>(\n    ({ className, variant, size, rounded, multeline = false, ...props }, ref) => {\n        const Component = multeline ? 'textarea' : 'input';\n\n        return (\n            <Component\n                ref={ref as any}\n                className={cn(inputVariants({ variant, size, rounded, className }))}\n                {...props}\n            />\n        );\n    }\n);\n\nInput.displayName = 'Input';\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/baseComponents/Label.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ref' is defined but never used.","line":50,"column":94,"nodeType":"Identifier","messageId":"unusedVar","endLine":50,"endColumn":97}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { cva, type VariantProps } from 'class-variance-authority';\nimport { cn } from '@/src/shared/utils/cn';\nimport { Flex, type FlexProps } from '@/src/design/primitives/Flex';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { SurfaceColorKey } from '../tokens/keys';\n\nconst bgMap: Record<SurfaceColorKey, string> = {\n    transparent: 'bg-transparent',\n    base: 'bg-surface-base',\n    muted: 'bg-surface-muted',\n    card: 'bg-surface-card',\n    // Labelの色の実体を独自に定義（例：少し透過させるなど）\n    primary: 'bg-brand-primary text-white',\n    secondary: 'bg-brand-secondary text-white',\n    danger: 'bg-brand-danger text-white',\n    success: 'bg-brand-success text-white',\n    heart: 'bg-brand-heart text-white',\n    warning: 'bg-brand-warning text-white',\n    info: 'bg-brand-info text-white',\n};\n\nconst labelVariants = cva('', {\n    variants: {\n        variant: {\n            default: '',\n            outline: 'border border-brand-secondary',\n            filled: 'bg-surface-muted',\n        },\n        bg: bgMap,\n    },\n    defaultVariants: {\n        variant: 'default',\n        bg: 'transparent',\n    },\n});\n\nexport interface LabelProps\n    extends Omit<FlexProps, 'bg' | 'color'>,\n    VariantProps<typeof labelVariants> {\n    label?: string;\n    icon?: React.ReactNode;\n    iconRight?: boolean;\n}\n\n/**\n * テキストとアイコン（オプション）を表示するためのラベルコンポーネントです。\n */\nexport const Label = React.forwardRef<HTMLElement, LabelProps>(\n    ({ className, label, icon, iconRight = false, variant, bg, align = 'center', ...props }, ref) => {\n        return (\n            <Flex\n                align={align}\n                className={cn(labelVariants({ variant, bg, className }))}\n                {...props}\n            >\n                {!iconRight && icon && <span className={cn(label && \"mr-2\")}>{icon}</span>}\n                {label && <Text as=\"span\" variant=\"detail\" weight=\"medium\" color=\"inherit\">{label}</Text>}\n                {iconRight && icon && <span className={cn(label && \"ml-2\")}>{icon}</span>}\n            </Flex>\n        );\n    }\n);\n\nLabel.displayName = 'Label';\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/baseComponents/Modal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/baseComponents/Range.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/baseComponents/SecurityNotice.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/baseComponents/Select.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/baseComponents/Skeleton.tsx","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":5,"column":18,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":5,"endColumn":31,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[138,183],"text":"type SkeletonProps = ViewProps"},"desc":"Replace empty interface with a type alias."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { cn } from '@/src/shared/utils/cn';\nimport { View, type ViewProps } from '../primitives/View';\n\nexport interface SkeletonProps extends ViewProps { }\n\n/**\n * コンテンツの読み込み中を表示するためのスケルトンコンポーネントです。\n * シマー（キラキラ）アニメーションがデフォルトで適用されます。\n */\nexport function Skeleton({ className, rounded = 'md', ...props }: SkeletonProps) {\n    return (\n        <View\n            rounded={rounded}\n            className={cn(\n                'bg-surface-muted relative overflow-hidden',\n                'before:absolute before:inset-0 before:-translate-x-full before:animate-shimmer before:bg-gradient-to-r before:from-transparent before:via-white/20 dark:before:via-white/10 before:to-transparent',\n                className\n            )}\n            {...props}\n        />\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/baseComponents/Spinner.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/baseComponents/Switch.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'cn' is defined but never used.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":12,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"cn"},"fix":{"range":[27,71],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'className' is defined but never used.","line":12,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { cn } from '@/src/shared/utils/cn';\n\nexport interface SwitchProps extends React.InputHTMLAttributes<HTMLInputElement> {\n    label?: string;\n}\n\n/**\n * ユーザーが設定を切り替えるためのトグルスイッチコンポーネントです。\n */\nexport const Switch = React.forwardRef<HTMLInputElement, SwitchProps>(\n    ({ className, label, ...props }, ref) => {\n        return (\n            <label className=\"inline-flex cursor-pointer items-center space-x-2 select-none group\">\n                <div className=\"relative\">\n                    <input\n                        ref={ref}\n                        type=\"checkbox\"\n                        className=\"peer sr-only\"\n                        {...props}\n                    />\n                    <div className=\"h-6 w-11 rounded-full bg-gray-200 transition-colors peer-checked:bg-brand-primary peer-focus:ring-2 peer-focus:ring-focus-ring peer-focus:ring-offset-2 group-has-[:disabled]:opacity-50\"></div>\n                    <div className=\"absolute left-1 top-1 h-4 w-4 rounded-full bg-white transition-transform peer-checked:translate-x-5 group-has-[:disabled]:opacity-50\"></div>\n                </div>\n                {label && (\n                    <span className=\"text-base text-foreground group-has-[:disabled]:opacity-50\">\n                        {label}\n                    </span>\n                )}\n            </label>\n        );\n    }\n);\n\nSwitch.displayName = 'Switch';\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/baseComponents/Tabs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/baseComponents/Text.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/baseComponents/TextArea.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/baseComponents/Toast.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":38,"column":129,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":132,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1461,1464],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1461,1464],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { cn } from '@/src/shared/utils/cn';\nimport { View } from '../primitives/View';\nimport { Flex } from '../primitives/Flex';\nimport { Text } from '../baseComponents/Text';\nimport { BrandColorKey } from '../tokens/keys';\n\nexport interface ToastProps {\n    message: string;\n    description?: string;\n    variant?: BrandColorKey;\n    onClose?: () => void;\n}\n\n/**\n * 一時的な通知メッセージを表示するためのトーストコンポーネントです。\n */\nexport function Toast({ message, description, variant = 'primary', onClose }: ToastProps) {\n    return (\n        <View\n            bg=\"card\"\n            shadow=\"lg\"\n            rounded=\"md\"\n            padding=\"md\"\n            className={cn(\n                \"border-l-4 w-[300px] animate-fast animate-in slide-in-from-right-5 fade-in\",\n                variant === 'primary' && \"border-brand-primary\",\n                variant === 'secondary' && \"border-brand-secondary\",\n                variant === 'danger' && \"border-brand-danger\",\n                variant === 'success' && \"border-brand-success\",\n                variant === 'warning' && \"border-brand-warning\",\n                variant === 'info' && \"border-brand-info\",\n                variant === 'heart' && \"border-brand-heart\"\n            )}\n        >\n            <Flex justify=\"between\" align=\"start\">\n                <View className=\"flex-1\">\n                    <Text weight=\"bold\" color={(variant === 'heart' ? 'heart' : variant === 'danger' ? 'danger' : 'default') as any}>\n                        {message}\n                    </Text>\n                    {description && (\n                        <Text variant=\"detail\" color=\"muted\" className=\"mt-1\">\n                            {description}\n                        </Text>\n                    )}\n                </View>\n                {onClose && (\n                    <button\n                        onClick={onClose}\n                        className=\"text-gray-400 hover:text-gray-600 transition-colors ml-2\"\n                    >\n                        ✕\n                    </button>\n                )}\n            </Flex>\n        </View>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/baseComponents/Tooltip.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/primitives/Container.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/primitives/Flex.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/primitives/Grid.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/primitives/Portal.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/workspace/frontend/src/design/primitives/Portal.tsx:19:9\n  17 |\n  18 |     useEffect(() => {\n> 19 |         setMounted(true);\n     |         ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  20 |\n  21 |         let el = document.getElementById(id);\n  22 |         if (!el) {","line":19,"column":9,"nodeType":null,"endLine":19,"endColumn":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useEffect, useState } from 'react';\nimport { createPortal } from 'react-dom';\n\ninterface PortalProps {\n    children: React.ReactNode;\n    id?: string;\n}\n\n/**\n * 子要素を body の直下にレンダリングするためのコンポーネントです。\n * z-index のスタッキングコンテキスト問題を回避するために使用します。\n */\nexport function Portal({ children, id = 'portal-root' }: PortalProps) {\n    const [mounted, setMounted] = useState(false);\n\n    useEffect(() => {\n        setMounted(true);\n\n        let el = document.getElementById(id);\n        if (!el) {\n            el = document.createElement('div');\n            el.id = id;\n            document.body.appendChild(el);\n        }\n\n        return () => {\n            // 他に Portal が残っていないかチェックし、なければ削除することも検討できますが、\n            // 一般的には残しておいても問題ありません。\n        };\n    }, [id]);\n\n    if (!mounted) return null;\n\n    const portalRoot = document.getElementById(id);\n    if (!portalRoot) return null;\n\n    return createPortal(children, portalRoot);\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/primitives/Stack.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/primitives/View.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/design/tokens/keys.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/entities/battle.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/entities/collection.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/entities/question.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/entities/quiz.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/entities/user.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/auth/api/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/auth/components/LoginForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/auth/components/RegisterForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/auth/types/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/battle/api/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/battle/components/BattleCreateModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Flex' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":14,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Flex"},"fix":{"range":[288,341],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":97,"column":76,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":97,"endColumn":79,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3654,3657],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3654,3657],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState } from 'react';\nimport { Modal } from '@/src/design/baseComponents/Modal';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { Flex } from '@/src/design/primitives/Flex';\nimport { Globe, Lock, Users, Plus } from 'lucide-react';\nimport { useRouter } from 'next/navigation';\nimport { createMatchRoom } from '../api';\nimport { View } from '@/src/design/primitives/View';\nimport { cn } from '@/src/shared/utils/cn';\n\ninterface BattleCreateModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n}\n\ntype Visibility = 'public' | 'private' | 'followers';\n\nexport function BattleCreateModal({ isOpen, onClose }: BattleCreateModalProps) {\n    const router = useRouter();\n    const [visibility, setVisibility] = useState<Visibility>('public');\n    const [loading, setLoading] = useState(false);\n\n    const handleCreate = async () => {\n        setLoading(true);\n        try {\n            const resp = await createMatchRoom({\n                collectionIds: [], // Currently empty, but can be expanded later\n                filterTypes: [],\n                sortKeys: [],\n                totalQuestions: 10,\n                maxBuzzesPerRound: 2,\n                visibility: visibility\n            });\n            router.push(`/battle/${resp.roomId}?token=${resp.joinToken}`);\n            onClose();\n        } catch (err) {\n            console.error('Failed to create room', err);\n            alert('ルームの作成に失敗しました');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <Modal isOpen={isOpen} onClose={onClose} title=\"ルームを作成\" size=\"sm\">\n            <Stack gap=\"xl\" className=\"py-2\">\n                <Stack gap=\"md\">\n                    <Text variant=\"xs\" weight=\"bold\">公開範囲</Text>\n                    <Stack gap=\"sm\">\n                        <VisibilityOption\n                            icon={<Globe size={18} />}\n                            title=\"公開\"\n                            description=\"全ユーザーがロビーから参加できます\"\n                            selected={visibility === 'public'}\n                            onClick={() => setVisibility('public')}\n                        />\n                        <VisibilityOption\n                            icon={<Lock size={18} />}\n                            title=\"非公開\"\n                            description=\"URLを知っている人のみ参加できます\"\n                            selected={visibility === 'private'}\n                            onClick={() => setVisibility('private')}\n                        />\n                        <VisibilityOption\n                            icon={<Users size={18} />}\n                            title=\"フォロワー限定\"\n                            description=\"あなたがフォローしているユーザーのみ参加できます\"\n                            selected={visibility === 'followers'}\n                            onClick={() => setVisibility('followers')}\n                        />\n                    </Stack>\n                </Stack>\n\n                <Button\n                    variant=\"solid\"\n                    color=\"primary\"\n                    className=\"w-full gap-2 h-12\"\n                    onClick={handleCreate}\n                    disabled={loading}\n                >\n                    {loading ? '作成中...' : (\n                        <>\n                            <Plus size={20} />\n                            ルームを作成して開始\n                        </>\n                    )}\n                </Button>\n            </Stack>\n        </Modal>\n    );\n}\n\nfunction VisibilityOption({ icon, title, description, selected, onClick }: any) {\n    return (\n        <View\n            onClick={onClick}\n            className={cn(\n                \"p-3 rounded-xl border-2 cursor-pointer transition-all flex items-start gap-3\",\n                selected\n                    ? \"border-brand-primary bg-brand-primary/5 shadow-sm\"\n                    : \"border-surface-muted hover:border-surface-primary bg-surface-base\"\n            )}\n        >\n            <View className={cn(\"mt-0.5\", selected ? \"text-brand-primary\" : \"text-secondary\")}>\n                {icon}\n            </View>\n            <Stack gap=\"none\">\n                <Text weight=\"bold\" color={selected ? \"primary\" : \"default\"}>{title}</Text>\n                <Text variant=\"xs\" color=\"secondary\" className=\"leading-tight\">{description}</Text>\n            </Stack>\n        </View>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/battle/components/BattleJoinModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/battle/components/BattleLobby.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":199,"column":37,"nodeType":"JSXOpeningElement","endLine":199,"endColumn":112}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState } from 'react';\nimport { Card } from '@/src/design/baseComponents/Card';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { Flex } from '@/src/design/primitives/Flex';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { MatchRoom } from '@/src/entities/battle';\nimport { User, Shield, Users, Play, Copy, Check, Library } from 'lucide-react';\nimport { Spinner } from '@/src/design/baseComponents/Spinner';\nimport { View } from '@/src/design/primitives/View';\nimport { cn } from '@/src/shared/utils/cn';\nimport { FilterCondition, SortCondition } from '@/src/entities/quiz';\nimport { QuizOptionsModal } from '@/src/features/quiz/components/QuizOptionsModal';\nimport { CollectionBrowser } from '@/src/features/collections/components/CollectionBrowser';\nimport { FixedSelectionTray } from '@/src/features/collections/components/FixedSelectionTray';\nimport { AddToSetModal } from '@/src/features/collectionSets/components/AddToSetModal';\n\ninterface BattleLobbyProps {\n    room: MatchRoom;\n    onStart: () => void;\n    isHost: boolean;\n    onUpdateConfig: (maxBuzzes: number) => void;\n    maxBuzzes: number;\n    onResetMatch: (collectionIds: string[], filters: FilterCondition[], sorts: SortCondition[], totalQuestions: number) => void;\n    selfId: string | null;\n}\n\nexport function BattleLobby({ room, onStart, isHost, onUpdateConfig, maxBuzzes, onResetMatch, selfId }: BattleLobbyProps) {\n    const [copied, setCopied] = useState(false);\n    const [selectedCollections, setSelectedCollections] = useState<{ id: string, name: string, questionCount: number }[]>([]);\n    const [appliedCollectionCount, setAppliedCollectionCount] = useState(0);\n\n    // Quiz options state\n    const [filters, setFilters] = useState<FilterCondition[]>([]);\n    const [sorts, setSorts] = useState<SortCondition[]>([]);\n    const [limit, setLimit] = useState(0);\n    const [isManualLimit, setIsManualLimit] = useState(false);\n    const [isSettingsOpen, setIsSettingsOpen] = useState(false);\n\n    // Add to set state\n    const [targetCollectionId, setTargetCollectionId] = useState<string | null>(null);\n    const [isAddToSetModalOpen, setIsAddToSetModalOpen] = useState(false);\n\n    const totalQuestions = selectedCollections.reduce((sum, c) => sum + (c.questionCount || 0), 0);\n\n    const qrCodeUrl = typeof window !== 'undefined'\n        ? `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(window.location.href)}`\n        : '';\n\n    const handleCopy = () => {\n        if (typeof window !== 'undefined') {\n            navigator.clipboard.writeText(window.location.href);\n            setCopied(true);\n            setTimeout(() => setCopied(false), 2000);\n        }\n    };\n\n    const handleToggleCollection = (id: string, name: string, count?: number) => {\n        setSelectedCollections(prev => {\n            const isRemoving = prev.some(c => c.id === id);\n            const next = isRemoving\n                ? prev.filter(c => c.id !== id)\n                : [...prev, { id, name, questionCount: count || 0 }];\n\n            // Smart Limit: If not manually adjusted, sync with total\n            if (!isManualLimit) {\n                const newTotal = next.reduce((sum, c) => sum + (c.questionCount || 0), 0);\n                setLimit(newTotal);\n            }\n\n            return next;\n        });\n    };\n\n    const handleLimitChange = (newLimit: number) => {\n        setLimit(newLimit);\n        setIsManualLimit(true);\n    };\n\n    const handleOpenAddToSet = (id: string) => {\n        setTargetCollectionId(id);\n        setIsAddToSetModalOpen(true);\n    };\n\n    const handleReset = () => {\n        if (selectedCollections.length > 0) {\n            onResetMatch(selectedCollections.map(c => c.id), filters, sorts, limit);\n            setAppliedCollectionCount(selectedCollections.length);\n            setSelectedCollections([]);\n            // Reset manual state after applying if desired, or keep it.\n            // Let's keep it for now.\n        }\n    };\n\n    return (\n        <Stack gap=\"xl\" className=\"w-full max-w-5xl mx-auto animate-in fade-in slide-in-from-bottom-4 duration-500 pb-20\">\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n                {/* 参加情報のカード */}\n                <Card padding=\"lg\" className=\"lg:col-span-2 border-2 border-brand-primary/20 shadow-xl overflow-visible relative h-fit\">\n                    <View className=\"absolute -top-4 left-6 px-4 py-1 bg-brand-primary text-white text-xs font-bold rounded-full shadow-lg\">\n                        WAITING FOR PLAYERS\n                    </View>\n\n                    <Stack gap=\"lg\">\n                        <Flex justify=\"between\" align=\"center\">\n                            <Stack gap=\"none\">\n                                <Text variant=\"h3\" weight=\"bold\">対戦ロビー</Text>\n                                <Text variant=\"xs\" color=\"secondary\">プレイヤーが集まるまでお待ちください</Text>\n                            </Stack>\n                            <Flex gap=\"sm\" align=\"center\" className=\"bg-surface-muted px-3 py-1.5 rounded-lg border border-surface-muted\">\n                                <Text variant=\"xs\" color=\"secondary\" weight=\"bold\">ROOM ID:</Text>\n                                <Text variant=\"xs\" weight=\"bold\" className=\"font-mono\">{room.room_id.slice(0, 8)}</Text>\n                                <Button size=\"sm\" variant=\"ghost\" className=\"p-1 h-auto\" onClick={handleCopy} title=\"参加リンクをコピー\">\n                                    {copied ? <Check size={14} className=\"text-green-500\" /> : <Copy size={14} />}\n                                </Button>\n                            </Flex>\n                        </Flex>\n\n                        <Stack gap=\"md\">\n                            <Flex gap=\"sm\" align=\"center\" className=\"text-brand-primary\">\n                                <Users size={18} />\n                                <Text variant=\"detail\" weight=\"bold\">参加者 ({room.players.length})</Text>\n                            </Flex>\n\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\n                                {room.players.map((player) => {\n                                    const isMe = player.user_id === selfId;\n                                    return (\n                                        <View\n                                            key={player.user_id}\n                                            className={cn(\n                                                \"p-4 rounded-xl border transition-all flex items-center justify-between group\",\n                                                isMe ? \"border-brand-primary bg-brand-primary/5 shadow-sm\" : \"border-surface-muted bg-surface-base hover:border-brand-primary/30\"\n                                            )}\n                                        >\n                                            <Flex gap=\"md\" align=\"center\">\n                                                <View className={cn(\n                                                    \"p-2 rounded-full\",\n                                                    isMe ? \"bg-brand-primary text-white\" : \"bg-brand-primary/10 text-brand-primary\"\n                                                )}>\n                                                    {player.user_id === room.host_id ? <Shield size={18} /> : <User size={18} />}\n                                                </View>\n                                                <Stack gap=\"none\">\n                                                    <Text weight=\"bold\" variant=\"detail\">\n                                                        {player.username}\n                                                        {isMe && \" (YOU)\"}\n                                                    </Text>\n                                                    {player.user_id === room.host_id && (\n                                                        <Text variant=\"xs\" color=\"primary\" weight=\"bold\">HOST</Text>\n                                                    )}\n                                                </Stack>\n                                            </Flex>\n                                            <View className=\"w-2 h-2 rounded-full bg-green-500 animate-pulse\" />\n                                        </View>\n                                    );\n                                })}\n                            </div>\n                        </Stack>\n\n                        {isHost ? (\n                            <>\n                                <Button\n                                    variant=\"solid\"\n                                    color=\"primary\"\n                                    size=\"lg\"\n                                    className=\"w-full mt-4 py-6 text-lg shadow-lg shadow-brand-primary/20 gap-2\"\n                                    onClick={onStart}\n                                    disabled={room.players.length < 1 || appliedCollectionCount === 0}\n                                >\n                                    <Play size={20} fill=\"currentColor\" />\n                                    対戦を開始する\n                                </Button>\n                                {isHost && appliedCollectionCount === 0 && (\n                                    <View className=\"mt-4 p-4 bg-brand-primary/5 border-2 border-dashed border-brand-primary/30 rounded-xl\">\n                                        <Text variant=\"xs\" color=\"primary\" weight=\"bold\" align=\"center\" className=\"animate-pulse\">\n                                            ※下のセレクターから問題集を選んで「適用」してください\n                                        </Text>\n                                    </View>\n                                )}\n                            </>\n                        ) : (\n                            <View className=\"mt-4 p-4 rounded-xl bg-brand-primary/5 border border-brand-primary/10 flex items-center justify-center gap-3\">\n                                <Spinner size=\"sm\" />\n                                <Text variant=\"xs\" weight=\"bold\" color=\"primary\">ホストの開始を待っています...</Text>\n                            </View>\n                        )}\n                    </Stack>\n                </Card>\n\n                <Stack gap=\"lg\" className=\"h-fit\">\n                    {/* QRコードカード */}\n                    <Card padding=\"lg\" className=\"border border-surface-muted shadow-lg bg-surface-base\">\n                        <Stack gap=\"md\" align=\"center\">\n                            <Text variant=\"detail\" weight=\"bold\">スマホでスキャンして参加</Text>\n                            {qrCodeUrl && (\n                                <View className=\"p-3 bg-white rounded-xl border border-surface-muted shadow-inner\">\n                                    <img src={qrCodeUrl} alt=\"QR Code\" className=\"w-40 h-40 md:w-48 md:h-48\" />\n                                </View>\n                            )}\n                            <Text variant=\"xs\" color=\"secondary\" className=\"text-center px-2\">\n                                スキャンするとすぐに参加画面へ移動できます\n                            </Text>\n                        </Stack>\n                    </Card>\n\n                    {/* 部屋設定 (ホストのみ、サイドバーへ移動) */}\n                    {isHost && (\n                        <Card padding=\"lg\" className=\"border border-surface-muted shadow-lg bg-surface-base\">\n                            <Stack gap=\"md\">\n                                <Text variant=\"xs\" color=\"secondary\" weight=\"bold\">1人あたりの回答権数</Text>\n                                <Flex gap=\"sm\" align=\"center\" className=\"flex-wrap\">\n                                    {[1, 2, 3, 5].map((val) => (\n                                        <Button\n                                            key={val}\n                                            size=\"sm\"\n                                            variant={maxBuzzes === val ? \"solid\" : \"outline\"}\n                                            onClick={() => onUpdateConfig(val)}\n                                            className=\"px-4\"\n                                        >\n                                            {val}回\n                                        </Button>\n                                    ))}\n                                </Flex>\n                            </Stack>\n                        </Card>\n                    )}\n                </Stack>\n            </div>\n\n            {/* 問題セレクター（ホスト専用、統合表示） */}\n            {isHost && (\n                <Card padding=\"none\" className=\"border border-surface-muted shadow-xl overflow-hidden bg-surface-base\">\n                    <View className=\"p-6 border-b border-surface-muted bg-surface-muted/10\">\n                        <Flex gap=\"md\" align=\"center\">\n                            <Library className=\"text-brand-primary\" size={24} />\n                            <Stack gap=\"none\">\n                                <Text variant=\"h4\" weight=\"bold\">クイズ問題集を選択</Text>\n                                <Text variant=\"xs\" color=\"secondary\">\n                                    {appliedCollectionCount > 0\n                                        ? `現在 ${appliedCollectionCount} 件のコレクションが適用されています`\n                                        : \"対戦で使用するコレクションを選んでください\"}\n                                </Text>\n                            </Stack>\n                        </Flex>\n                    </View>\n\n                    <View className=\"p-6 min-h-[500px]\">\n                        <CollectionBrowser\n                            selectedIds={selectedCollections.map(c => c.id)}\n                            onToggleCollection={handleToggleCollection}\n                            onAddToSet={handleOpenAddToSet}\n                        />\n                    </View>\n                </Card>\n            )}\n\n            {/* ボトム固定トレイ (ホスト専用) */}\n            {isHost && (\n                <>\n                    <FixedSelectionTray\n                        selectedCollections={selectedCollections}\n                        onRemoveCollection={(id) => handleToggleCollection(id, \"\", 0)}\n                        onClearAll={() => {\n                            setSelectedCollections([]);\n                            if (!isManualLimit) setLimit(0);\n                        }}\n                        onOpenSettings={() => setIsSettingsOpen(true)}\n                        onStart={handleReset}\n                        startLabel=\"適用してリセット\"\n                        limit={limit}\n                    />\n\n                    {/* 設定モーダル */}\n                    <QuizOptionsModal\n                        isOpen={isSettingsOpen}\n                        onClose={() => setIsSettingsOpen(false)}\n                        filters={filters}\n                        sorts={sorts}\n                        limit={limit}\n                        maxLimit={totalQuestions > 0 ? totalQuestions : 0}\n                        onFilterChange={setFilters}\n                        onSortChange={setSorts}\n                        onLimitChange={handleLimitChange}\n                    />\n\n                    {/* セットに追加モーダル */}\n                    {isAddToSetModalOpen && targetCollectionId && (\n                        <AddToSetModal\n                            collectionId={targetCollectionId}\n                            onClose={() => setIsAddToSetModalOpen(false)}\n                            onSuccess={() => {\n                                setTargetCollectionId(null);\n                                setIsAddToSetModalOpen(false);\n                            }}\n                        />\n                    )}\n                </>\n            )}\n        </Stack >\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/battle/components/BattleQuiz.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Trophy' is defined but never used.","line":11,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":16,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Trophy"},"fix":{"range":[494,501],"text":""},"desc":"Remove unused variable \"Trophy\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Check' is defined but never used.","line":11,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":50,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Check"},"fix":{"range":[527,534],"text":""},"desc":"Remove unused variable \"Check\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Bell' is defined but never used.","line":11,"column":55,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":59,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Bell"},"fix":{"range":[537,543],"text":""},"desc":"Remove unused variable \"Bell\"."}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/workspace/frontend/src/features/battle/components/BattleQuiz.tsx:81:13\n  79 |     useEffect(() => {\n  80 |         if (!expiresAtMs) {\n> 81 |             setTimeLeftMs(0);\n     |             ^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  82 |             return;\n  83 |         }\n  84 |","line":81,"column":13,"nodeType":null,"endLine":81,"endColumn":26},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/workspace/frontend/src/features/battle/components/BattleQuiz.tsx:103:9\n  101 |\n  102 |     useEffect(() => {\n> 103 |         setAnswer('');\n      |         ^^^^^^^^^ Avoid calling setState() directly within an effect\n  104 |     }, [question.id]);\n  105 |\n  106 |     const handleSubmit = (e: React.FormEvent) => {","line":103,"column":9,"nodeType":null,"endLine":103,"endColumn":18}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport { Card } from '@/src/design/baseComponents/Card';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { Flex } from '@/src/design/primitives/Flex';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { Input } from '@/src/design/baseComponents/Input';\nimport { MatchQuestion, PlayerScore } from '@/src/entities/battle';\nimport { Trophy, Clock, Zap, MessageSquare, Check, X, Bell } from 'lucide-react';\nimport { cn } from '@/src/shared/utils/cn';\nimport { View } from '@/src/design/primitives/View';\n\ninterface BattleQuizProps {\n    question: MatchQuestion;\n    buzzedUserId: string | null;\n    lastRoundResult: { correct_answer: string; scores: PlayerScore[] } | null;\n    players: PlayerScore[];\n    selfId: string | null;\n    onBuzz: () => void;\n    onSubmit: (answer: string) => void;\n    expiresAtMs: number | null;\n    answerResult: { user_id: string, is_correct: boolean } | null;\n    currentQuestionIndex: number;\n    totalQuestions: number;\n}\n\nexport function BattleQuiz({\n    question,\n    buzzedUserId,\n    lastRoundResult,\n    players,\n    selfId,\n    onBuzz,\n    onSubmit,\n    expiresAtMs,\n    answerResult,\n    currentQuestionIndex,\n    totalQuestions\n}: BattleQuizProps) {\n    const [answer, setAnswer] = useState('');\n    const [timeLeftMs, setTimeLeftMs] = useState<number>(0);\n    const inputRef = useRef<HTMLInputElement>(null);\n    const isMyBuzz = buzzedUserId === selfId;\n    const isSomeoneBuzzed = buzzedUserId !== null;\n\n    // VFX Overlay\n    const renderVFX = () => {\n        if (!answerResult) return null;\n        const isCorrect = answerResult.is_correct;\n        const username = players.find(p => p.user_id === answerResult.user_id)?.username || 'Someone';\n\n        return (\n            <View className=\"absolute inset-0 z-[2000] flex items-start justify-center pointer-events-none overflow-hidden pt-12 md:pt-16\">\n                <View className={cn(\n                    \"flex flex-col items-center animate-in zoom-in duration-300 scale-75 md:scale-90\",\n                    isCorrect ? \"text-brand-success/60\" : \"text-brand-danger/60\"\n                )}>\n                    {isCorrect ? (\n                        <View className=\"relative\">\n                            <View className=\"text-6xl md:text-7xl font-bold border-8 border-brand-success/40 rounded-full w-16 h-16 md:w-24 md:h-24 flex items-center justify-center\" style={{ borderWidth: 8 }}>\n                                <View className=\"w-10 h-10 md:w-14 md:h-14\" />\n                            </View>\n                        </View>\n                    ) : (\n                        <X size={80} strokeWidth={4} className=\"md:size-[120px] opacity-60\" />\n                    )}\n                    <View className=\"bg-surface/40 backdrop-blur-sm px-3 py-1.5 rounded-lg mt-2 border border-surface-muted/50 shadow-md\">\n                        <Text variant=\"xs\" weight=\"bold\" color={isCorrect ? \"success\" : \"danger\"}>\n                            {username} {isCorrect ? 'Correct!' : 'Incorrect!'}\n                        </Text>\n                    </View>\n                </View>\n            </View>\n        );\n    };\n\n    useEffect(() => {\n        if (!expiresAtMs) {\n            setTimeLeftMs(0);\n            return;\n        }\n\n        const updateTimer = () => {\n            const now = Date.now();\n            const diff = Math.max(0, expiresAtMs - now);\n            setTimeLeftMs(diff);\n        };\n\n        updateTimer();\n        const interval = setInterval(updateTimer, 50);\n        return () => clearInterval(interval);\n    }, [expiresAtMs]);\n\n    useEffect(() => {\n        if (isMyBuzz) {\n            setTimeout(() => inputRef.current?.focus(), 100);\n        }\n    }, [isMyBuzz]);\n\n    useEffect(() => {\n        setAnswer('');\n    }, [question.id]);\n\n    const handleSubmit = (e: React.FormEvent) => {\n        e.preventDefault();\n        if (answer.trim()) {\n            onSubmit(answer.trim());\n        }\n    };\n\n    const buzzedUser = players.find(p => p.user_id === buzzedUserId);\n\n    return (\n        <Stack gap=\"xl\" className=\"w-full max-w-4xl mx-auto animate-in fade-in zoom-in-95 duration-500 relative\">\n            {renderVFX()}\n            {/* Header: Progress & Scores */}\n            <Flex justify=\"between\" align=\"end\" className=\"px-2\">\n                <Stack gap=\"xs\">\n                    <Text variant=\"xs\" color=\"primary\" weight=\"bold\" className=\"uppercase tracking-widest opacity-60\">\n                        Question {currentQuestionIndex + 1} of {totalQuestions}\n                    </Text>\n                    <Flex gap=\"sm\" align=\"center\">\n                        <View className=\"h-2 w-48 bg-surface-muted rounded-full overflow-hidden\">\n                            <View\n                                className=\"h-full bg-brand-primary transition-all duration-1000\"\n                                style={{ width: `${((currentQuestionIndex + 1) / totalQuestions) * 100}%` }}\n                            />\n                        </View>\n                    </Flex>\n                </Stack>\n\n                {/* Timer Section */}\n                {expiresAtMs && !lastRoundResult && (\n                    <Stack gap=\"xs\" align=\"end\" className=\"flex-1 max-w-[200px]\">\n                        <Flex gap=\"xs\" align=\"center\">\n                            <Clock size={14} className={cn(timeLeftMs < 5000 ? \"text-brand-danger animate-pulse\" : \"text-secondary\")} />\n                            <Text variant=\"xs\" weight=\"bold\" color={timeLeftMs < 5000 ? \"danger\" : \"secondary\"}>\n                                {(timeLeftMs / 1000).toFixed(1)}s\n                            </Text>\n                        </Flex>\n                        <View className=\"h-1.5 w-full bg-surface-muted rounded-full overflow-hidden\">\n                            <View\n                                className={cn(\n                                    \"h-full transition-all duration-100\",\n                                    timeLeftMs < 5000 ? \"bg-brand-danger\" : \"bg-yellow-500\"\n                                )}\n                                style={{ width: `${(timeLeftMs / (isSomeoneBuzzed ? 10000 : 20000)) * 100}%` }}\n                            />\n                        </View>\n                    </Stack>\n                )}\n\n                <Flex gap=\"md\" className=\"hidden md:flex\">\n                    {players.slice(0, 3).map((p, i) => (\n                        <Flex key={p.user_id} align=\"center\" gap=\"xs\" className={cn(\n                            \"px-3 py-1 rounded-full border transition-all\",\n                            p.user_id === selfId ? \"border-brand-primary bg-brand-primary/10\" : \"border-surface-muted bg-surface-base\"\n                        )}>\n                            <Text variant=\"xs\" weight=\"bold\" color={i === 0 ? \"primary\" : \"secondary\"}>\n                                #{i + 1} {p.username}\n                            </Text>\n                            <Text variant=\"xs\" weight=\"bold\">{p.score}</Text>\n                        </Flex>\n                    ))}\n                </Flex>\n            </Flex>\n\n            {/* Main Question Card */}\n            <Card padding=\"xl\" className=\"relative border-t-4 border-t-brand-primary shadow-2xl min-h-[300px] flex flex-col justify-center overflow-visible\">\n                {/* Buzz Overlay */}\n                {isSomeoneBuzzed && !lastRoundResult && (\n                    <View className=\"absolute -top-6 left-1/2 -translate-x-1/2 px-6 py-2 bg-yellow-400 text-slate-900 font-black rounded-full shadow-xl animate-bounce flex items-center gap-2 border-2 border-white\">\n                        <Zap size={18} fill=\"currentColor\" />\n                        {buzzedUser?.username.toUpperCase()} BUZZED!\n                    </View>\n                )}\n\n                <Stack gap=\"xl\" align=\"center\" className=\"text-center\">\n                    <Text variant=\"h2\" weight=\"bold\" className=\"leading-tight text-3xl md:text-5xl\">\n                        {question.question_text}\n                    </Text>\n                    {question.description_text && (\n                        <Text color=\"secondary\" className=\"opacity-70 italic\">\n                            {question.description_text}\n                        </Text>\n                    )}\n                </Stack>\n\n                {/* Answer Result Feedback */}\n                {lastRoundResult && (\n                    <View className=\"absolute inset-0 bg-surface-base/90 backdrop-blur-sm z-10 flex flex-col items-center justify-center p-8 animate-in fade-in duration-300 rounded-brand-xl\">\n                        <Stack gap=\"lg\" align=\"center\" className=\"text-center\">\n                            <View className=\"p-4 rounded-full bg-brand-primary/10 text-brand-primary\">\n                                <MessageSquare size={48} />\n                            </View>\n                            <Stack gap=\"none\">\n                                <Text variant=\"xs\" color=\"secondary\" weight=\"bold\">正解は...</Text>\n                                <Text variant=\"h1\" color=\"primary\" weight=\"bold\" className=\"text-4xl\">{lastRoundResult.correct_answer}</Text>\n                            </Stack>\n                            <Text variant=\"xs\" className=\"animate-pulse opacity-60\">次の問題へ進みます...</Text>\n                        </Stack>\n                    </View>\n                )}\n            </Card>\n\n            {/* Action Area */}\n            <View className=\"h-32 flex items-center justify-center\">\n                {!isSomeoneBuzzed && !lastRoundResult ? (\n                    <Button\n                        variant=\"solid\"\n                        color=\"primary\"\n                        className=\"w-48 h-48 rounded-full shadow-2xl shadow-brand-primary/40 text-2xl font-black border-8 border-white hover:scale-105 active:scale-95 transition-all flex flex-col items-center justify-center gap-2 group p-0\"\n                        onClick={onBuzz}\n                    >\n                        <Zap size={48} fill=\"white\" className=\"group-hover:animate-pulse\" />\n                        BUZZ!\n                    </Button>\n                ) : isMyBuzz && !lastRoundResult ? (\n                    <form onSubmit={handleSubmit} className=\"w-full max-w-md animate-in slide-in-from-bottom-4\">\n                        <Stack gap=\"md\">\n                            <Text align=\"center\" variant=\"xs\" weight=\"bold\" color=\"primary\" className=\"animate-pulse\">\n                                解答を入力してください！\n                            </Text>\n                            <Flex gap=\"sm\">\n                                <Input\n                                    ref={inputRef}\n                                    value={answer}\n                                    onChange={(e) => setAnswer(e.target.value)}\n                                    placeholder=\"答えを入力...\"\n                                    className=\"text-lg py-6 shadow-lg border-2 border-brand-primary\"\n                                    autoFocus\n                                />\n                                <Button type=\"submit\" variant=\"solid\" color=\"primary\" className=\"px-8 shadow-lg\">\n                                    送信\n                                </Button>\n                            </Flex>\n                        </Stack>\n                    </form>\n                ) : isSomeoneBuzzed && !lastRoundResult ? (\n                    <Stack gap=\"sm\" align=\"center\" className=\"animate-pulse\">\n                        <Flex gap=\"sm\" align=\"center\" className=\"text-yellow-500\">\n                            <Clock size={24} />\n                            <Text weight=\"bold\">{buzzedUser?.username}が回答中...</Text>\n                        </Flex>\n                        <Text variant=\"xs\" color=\"secondary\">他のプレイヤーが回答権を得るまでお待ちください</Text>\n                    </Stack>\n                ) : null}\n            </View>\n\n            {/* Players Sidebar (Mobile hidden, shown as bottom bar) */}\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mt-8\">\n                {players.map((p) => (\n                    <Card key={p.user_id} padding=\"sm\" className={cn(\n                        \"transition-all border-l-4\",\n                        p.user_id === selfId ? \"border-l-brand-primary bg-brand-primary/5\" : \"border-l-transparent\",\n                        buzzedUserId === p.user_id ? \"ring-2 ring-yellow-400 scale-105\" : \"opacity-80\"\n                    )}>\n                        <Flex justify=\"between\" align=\"center\">\n                            <Stack gap=\"none\" className=\"overflow-hidden\">\n                                <Text variant=\"xs\" weight=\"bold\" className=\"truncate\">{p.username}</Text>\n                                <Text variant=\"xs\" color=\"secondary\">{p.score} pts</Text>\n                            </Stack>\n                            {buzzedUserId === p.user_id && (\n                                <Zap size={16} className=\"text-yellow-500 fill-yellow-500\" />\n                            )}\n                        </Flex>\n                    </Card>\n                ))}\n            </div>\n        </Stack>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/battle/components/BattleResult.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":33,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1315,1318],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1315,1318],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React from 'react';\nimport { Card } from '@/src/design/baseComponents/Card';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { Flex } from '@/src/design/primitives/Flex';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { PlayerScore } from '@/src/entities/battle';\nimport { Trophy, Home, RotateCcw, Medal, Users, MessageSquare, CheckCircle2 } from 'lucide-react';\nimport { useRouter } from 'next/navigation';\nimport { View } from '@/src/design/primitives/View';\nimport { cn } from '@/src/shared/utils/cn';\nimport { EditRequestModal } from '@/src/features/questions/components/EditRequestModal';\nimport { useState } from 'react';\n\ninterface BattleResultProps {\n    scores: PlayerScore[];\n    isHost: boolean;\n    onReplay?: () => void;\n    onBackToLobby?: () => void;\n    roundSummaries?: {\n        questionId: string;\n        questionText: string;\n        correctAnswer: string;\n        correctCount: number;\n    }[];\n}\n\nexport function BattleResult({ scores, isHost, onReplay, onBackToLobby, roundSummaries = [] }: BattleResultProps) {\n    const router = useRouter();\n    const sortedScores = [...scores].sort((a, b) => b.score - a.score);\n    const [selectedQuestion, setSelectedQuestion] = useState<any | null>(null);\n\n    return (\n        <Stack gap=\"xl\" className=\"w-full max-w-2xl mx-auto animate-in fade-in slide-in-from-bottom-8 duration-700\">\n            <Card padding=\"xl\" className=\"border-4 border-brand-primary shadow-2xl relative overflow-visible\">\n                <View className=\"absolute -top-10 left-1/2 -translate-x-1/2 p-6 bg-brand-primary text-white rounded-full shadow-2xl border-4 border-white\">\n                    <Trophy size={48} />\n                </View>\n\n                <Stack gap=\"xl\" align=\"center\" className=\"mt-8\">\n                    <Stack gap=\"none\" align=\"center\">\n                        <Text variant=\"h2\" weight=\"bold\">BATTLE FINISHED!</Text>\n                        <Text color=\"secondary\">対戦結果</Text>\n                    </Stack>\n\n                    <Stack gap=\"md\" className=\"w-full\">\n                        {sortedScores.map((player, index) => {\n                            const isWinner = index === 0;\n                            return (\n                                <View\n                                    key={player.user_id}\n                                    className={cn(\n                                        \"p-6 rounded-2xl border-2 flex items-center justify-between transition-all\",\n                                        isWinner\n                                            ? \"bg-brand-primary/10 border-brand-primary shadow-lg scale-105\"\n                                            : \"bg-surface-base border-surface-muted\"\n                                    )}\n                                >\n                                    <Flex gap=\"lg\" align=\"center\">\n                                        <View className={cn(\n                                            \"w-12 h-12 rounded-full flex items-center justify-center font-black text-xl\",\n                                            index === 0 ? \"bg-yellow-400 text-slate-900\" :\n                                                index === 1 ? \"bg-slate-300 text-slate-800\" :\n                                                    index === 2 ? \"bg-amber-600 text-white\" :\n                                                        \"bg-surface-muted text-secondary\"\n                                        )}>\n                                            {index === 0 ? <Medal size={24} /> : index + 1}\n                                        </View>\n                                        <Stack gap=\"none\">\n                                            <Text weight=\"bold\" variant=\"h3\" className={isWinner ? \"text-brand-primary font-black\" : \"\"}>\n                                                {player.username}\n                                                {isWinner && \" 👑\"}\n                                            </Text>\n                                            <Text variant=\"xs\" color=\"secondary\" weight=\"bold\">\n                                                {isWinner ? \"WINNER\" : \"RANK \" + (index + 1)}\n                                            </Text>\n                                        </Stack>\n                                    </Flex>\n                                    <View className=\"text-right\">\n                                        <Text variant=\"h2\" weight=\"bold\" color={isWinner ? \"primary\" : \"secondary\"}>\n                                            {player.score.toLocaleString()}\n                                        </Text>\n                                        <Text variant=\"xs\" color=\"muted\" weight=\"bold\">POINTS</Text>\n                                    </View>\n                                </View>\n                            );\n                        })}\n                    </Stack>\n\n                    <Stack gap=\"md\" className=\"w-full mt-6\">\n                        {isHost ? (\n                            <>\n                                <Button\n                                    variant=\"solid\"\n                                    color=\"primary\"\n                                    className=\"py-6 text-lg font-bold shadow-lg shadow-brand-primary/20 gap-3\"\n                                    onClick={onReplay}\n                                >\n                                    <RotateCcw size={24} />\n                                    同じ設定で再戦\n                                </Button>\n                                <Button\n                                    variant=\"solid\"\n                                    color=\"secondary\"\n                                    className=\"py-6 text-lg font-bold gap-3\"\n                                    onClick={onBackToLobby}\n                                >\n                                    <Users size={24} />\n                                    ロビーに戻る\n                                </Button>\n                            </>\n                        ) : (\n                            <View className=\"p-6 rounded-2xl bg-surface-muted text-center border-2 border-surface-muted animate-pulse\">\n                                <Text weight=\"bold\" color=\"secondary\">\n                                    ホストが次のアクションを選択中...\n                                </Text>\n                            </View>\n                        )}\n\n                        <Button\n                            variant=\"ghost\"\n                            className=\"py-4 text-secondary hover:text-primary gap-2\"\n                            onClick={() => router.push('/home')}\n                        >\n                            <Home size={20} />\n                            終了してホームへ\n                        </Button>\n                    </Stack>\n                </Stack>\n            </Card>\n\n            {/* Question Breakdown Section */}\n            {roundSummaries.length > 0 && (\n                <Card padding=\"lg\" className=\"border-t-4 border-brand-primary\">\n                    <Stack gap=\"lg\">\n                        <Flex gap=\"sm\" align=\"center\">\n                            <CheckCircle2 className=\"text-brand-primary\" size={24} />\n                            <Text variant=\"h3\" weight=\"bold\">ROUND BREAKDOWN</Text>\n                        </Flex>\n\n                        <Stack gap=\"md\">\n                            {roundSummaries.map((summary, idx) => (\n                                <View key={idx} className=\"p-4 rounded-xl bg-surface-muted/30 border border-surface-muted\">\n                                    <Flex justify=\"between\" align=\"start\" gap=\"md\">\n                                        <Stack gap=\"xs\" className=\"flex-1\">\n                                            <Flex gap=\"sm\" align=\"center\">\n                                                <View className=\"px-2 py-0.5 rounded bg-brand-primary/10 text-brand-primary text-[10px] font-bold\">\n                                                    Q{idx + 1}\n                                                </View>\n                                                <Text variant=\"detail\" weight=\"bold\" className=\"line-clamp-2\">\n                                                    {summary.questionText}\n                                                </Text>\n                                            </Flex>\n                                            <Text variant=\"xs\" color=\"secondary\">\n                                                正解: <span className=\"text-brand-primary font-medium\">{summary.correctAnswer}</span>\n                                            </Text>\n                                        </Stack>\n\n                                        <Stack align=\"end\" gap=\"xs\">\n                                            <Flex align=\"center\" gap=\"xs\" className=\"bg-brand-primary/10 px-2 py-1 rounded-lg\">\n                                                <Text variant=\"xs\" color=\"primary\" weight=\"bold\">{summary.correctCount}</Text>\n                                                <Text variant=\"xs\" color=\"secondary\" className=\"scale-[0.8] origin-left\">正解</Text>\n                                            </Flex>\n                                            <Button\n                                                variant=\"ghost\"\n                                                size=\"sm\"\n                                                className=\"h-7 px-2 text-[10px] gap-1 text-secondary hover:text-brand-primary\"\n                                                onClick={() => setSelectedQuestion({\n                                                    id: summary.questionId,\n                                                    questionText: summary.questionText,\n                                                    correctAnswers: [summary.correctAnswer],\n                                                    descriptionText: ''\n                                                })}\n                                            >\n                                                <MessageSquare size={12} />\n                                                修正提案\n                                            </Button>\n                                        </Stack>\n                                    </Flex>\n                                </View>\n                            ))}\n                        </Stack>\n                    </Stack>\n                </Card>\n            )}\n\n            {selectedQuestion && (\n                <EditRequestModal\n                    question={selectedQuestion}\n                    onClose={() => setSelectedQuestion(null)}\n                />\n            )}\n        </Stack>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/battle/hooks/useBattle.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'RoomStatus' is defined but never used.","line":2,"column":83,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":93,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"RoomStatus"},"fix":{"range":[146,158],"text":""},"desc":"Remove unused variable \"RoomStatus\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback, useRef } from 'react';\nimport { MatchRoom, MatchQuestion, PlayerScore, WsServerMessage, WsClientMessage, RoomStatus } from '@/src/entities/battle';\nimport { getMatchWsUrl } from '../api';\nimport { FilterCondition, SortCondition } from '@/src/entities/quiz';\n\nexport function useBattle(roomId: string, joinToken: string) {\n    const [room, setRoom] = useState<MatchRoom | null>(null);\n    const [questions, setQuestions] = useState<MatchQuestion[]>([]);\n    const [currentQuestionIndex, setCurrentQuestionIndex] = useState(-1);\n    const [buzzedUserId, setBuzzedUserId] = useState<string | null>(null);\n    const [lastRoundResult, setLastRoundResult] = useState<{ correct_answer: string; scores: PlayerScore[] } | null>(null);\n    const [answerResult, setAnswerResult] = useState<{ user_id: string, is_correct: boolean } | null>(null);\n    const [expiresAtMs, setExpiresAtMs] = useState<number | null>(null);\n    const [maxBuzzes, setMaxBuzzes] = useState(2);\n    const [error, setError] = useState<string | null>(null);\n    const [isConnected, setIsConnected] = useState(false);\n    const [selfId, setSelfId] = useState<string | null>(null);\n    const [selfUsername, setSelfUsername] = useState<string | null>(null);\n    const [roundSummaries, setRoundSummaries] = useState<{\n        questionId: string;\n        questionText: string;\n        correctAnswer: string;\n        correctCount: number;\n    }[]>([]);\n\n    const socketRef = useRef<WebSocket | null>(null);\n    const questionsRef = useRef<MatchQuestion[]>([]);\n\n    useEffect(() => {\n        questionsRef.current = questions;\n    }, [questions]);\n\n    const sendMessage = useCallback((msg: WsClientMessage) => {\n        if (socketRef.current?.readyState === WebSocket.OPEN) {\n            socketRef.current.send(JSON.stringify(msg));\n        }\n    }, []);\n\n    useEffect(() => {\n        if (!roomId) return;\n\n        const token = typeof window !== 'undefined' ? localStorage.getItem('token') : null;\n        const url = `${getMatchWsUrl(roomId)}${token ? `?token=${token}` : ''}`;\n        const ws = new WebSocket(url);\n        socketRef.current = ws;\n\n        ws.onopen = () => {\n            setIsConnected(true);\n            setError(null);\n            sendMessage({ type: 'JoinRoom', room_id: roomId, join_token: joinToken });\n        };\n\n        ws.onmessage = (event) => {\n            console.log('[DEBUG] WS Message received:', event.data);\n            try {\n                const data: WsServerMessage = JSON.parse(event.data);\n                console.log('[DEBUG] Parsed WS Data:', data);\n\n                switch (data.type) {\n                    case 'RoomStateUpdate':\n                        setRoom({\n                            room_id: roomId,\n                            host_id: data.host_id,\n                            status: data.status,\n                            players: data.players\n                        });\n                        break;\n\n                    case 'MatchStarted':\n                        setQuestions(data.questions);\n                        setRoundSummaries([]); // Reset for new match\n                        setRoom(prev => {\n                            if (prev) return { ...prev, status: 'Playing' };\n                            return {\n                                room_id: roomId,\n                                host_id: '',\n                                status: 'Playing',\n                                players: []\n                            };\n                        });\n                        break;\n\n                    case 'RoundStarted':\n                        setCurrentQuestionIndex(data.question_index);\n                        setBuzzedUserId(null);\n                        setLastRoundResult(null);\n                        setExpiresAtMs(data.expires_at_ms);\n\n                        // Initialize summary for this round\n                        const q = questionsRef.current[data.question_index];\n                        if (q) {\n                            setRoundSummaries(prev => [\n                                ...prev,\n                                {\n                                    questionId: q.id,\n                                    questionText: q.question_text,\n                                    correctAnswer: '', // Will be filled in RoundResult\n                                    correctCount: 0\n                                }\n                            ]);\n                        }\n                        break;\n\n                    case 'PlayerBuzzed':\n                        setBuzzedUserId(data.user_id);\n                        setExpiresAtMs(data.expires_at_ms);\n                        break;\n\n                    case 'AnswerResult':\n                        setAnswerResult({ user_id: data.user_id, is_correct: data.is_correct });\n                        if (data.is_correct) {\n                            setRoundSummaries(prev => {\n                                const lastIndex = prev.length - 1;\n                                if (lastIndex >= 0) {\n                                    const last = prev[lastIndex];\n                                    const updated = [...prev];\n                                    updated[lastIndex] = { ...last, correctCount: last.correctCount + 1 };\n                                    return updated;\n                                }\n                                return prev;\n                            });\n                        }\n                        if (!data.is_correct) {\n                            setBuzzedUserId(null);\n                        }\n                        // Clear answer result after 3 seconds\n                        setTimeout(() => setAnswerResult(null), 3000);\n                        break;\n\n                    case 'RoundResult':\n                        setLastRoundResult({\n                            correct_answer: data.correct_answer,\n                            scores: data.scores\n                        });\n\n                        // Update correct answer for the current summary\n                        setRoundSummaries(prev => {\n                            const lastIndex = prev.length - 1;\n                            if (lastIndex >= 0) {\n                                const updated = [...prev];\n                                updated[lastIndex] = { ...updated[lastIndex], correctAnswer: data.correct_answer };\n                                return updated;\n                            }\n                            return prev;\n                        });\n                        setRoom(prev => prev ? { ...prev, players: data.scores } : null);\n                        setExpiresAtMs(null);\n                        break;\n\n                    case 'MatchResult':\n                        setRoom(prev => prev ? { ...prev, status: 'Finished', players: data.final_scores } : null);\n                        setExpiresAtMs(null);\n                        break;\n\n                    case 'Joined':\n                        setSelfId(data.user_id);\n                        setSelfUsername(data.username);\n                        break;\n\n                    case 'RoomConfigUpdated':\n                        setMaxBuzzes(data.max_buzzes);\n                        break;\n\n                    case 'Error':\n                        console.error('[DEBUG] WS Error message:', data.message);\n                        setError(data.message);\n                        break;\n                }\n            } catch (e) {\n                console.error('Failed to parse WS message', e);\n            }\n        };\n\n        ws.onerror = () => {\n            setError('WebSocket接続エラーが発生しました');\n        };\n\n        ws.onclose = () => {\n            setIsConnected(false);\n        };\n\n        return () => {\n            ws.close();\n        };\n    }, [roomId, joinToken, sendMessage]);\n\n    const startMatch = useCallback(() => sendMessage({ type: 'StartMatch' }), [sendMessage]);\n    const buzz = useCallback(() => sendMessage({ type: 'Buzz' }), [sendMessage]);\n    const submitAnswer = useCallback((answer: string) => sendMessage({ type: 'SubmitAnswer', answer }), [sendMessage]);\n    const updateConfig = useCallback((max_buzzes: number) => sendMessage({ type: 'UpdateConfig', max_buzzes }), [sendMessage]);\n    const backToLobby = useCallback(() => sendMessage({ type: 'BackToLobby' }), [sendMessage]);\n    const resetMatch = useCallback((collection_ids: string[], filters: FilterCondition[], sorts: SortCondition[], total_questions: number) =>\n        sendMessage({\n            type: 'ResetMatch',\n            collection_ids,\n            filter_types: filters.map(f => f.type),\n            sort_keys: sorts.map(s => s.key),\n            total_questions\n        }), [sendMessage]);\n\n    return {\n        room,\n        questions,\n        currentQuestionIndex,\n        buzzedUserId,\n        lastRoundResult,\n        answerResult,\n        expiresAtMs,\n        maxBuzzes,\n        selfId,\n        selfUsername,\n        roundSummaries,\n        error,\n        isConnected,\n        startMatch,\n        buzz,\n        submitAnswer,\n        updateConfig,\n        backToLobby,\n        resetMatch\n    };\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/collectionSets/api/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/collectionSets/components/AddToSetModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Card' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":14,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Card"},"fix":{"range":[42,99],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'X' is defined but never used.","line":14,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":23,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"X"},"fix":{"range":[647,650],"text":""},"desc":"Remove unused variable \"X\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":33,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1306,1309],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1306,1309],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React from 'react';\nimport { Card } from '@/src/design/baseComponents/Card';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { Flex } from '@/src/design/primitives/Flex';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { View } from '@/src/design/primitives/View';\nimport { Spinner } from '@/src/design/baseComponents/Spinner';\nimport { useUserCollectionSets } from '@/src/features/collections/hooks/useCollections';\nimport { useAuth } from '@/src/shared/auth/useAuth';\nimport { addCollectionToSet } from '../api';\nimport { FolderOpen, X, Plus } from 'lucide-react';\nimport { Modal } from '@/src/design/baseComponents/Modal';\n\ninterface AddToSetModalProps {\n    collectionId: string;\n    onClose: () => void;\n    onSuccess?: () => void;\n}\n\nexport function AddToSetModal({ collectionId, onClose, onSuccess }: AddToSetModalProps) {\n    const { user } = useAuth();\n    const { collectionSets, loading } = useUserCollectionSets(user?.id);\n\n    const handleAdd = async (setId: string) => {\n        try {\n            // displayOrderは現時点では簡易的に0を指定\n            await addCollectionToSet(setId, { collectionId, displayOrder: 0 });\n            onSuccess?.();\n            onClose();\n        } catch (err: any) {\n            console.error('Failed to add collection to set', err);\n            // 本来はToastなどを使いたいが、プロジェクトの慣習に合わせる\n            alert('セットへの追加に失敗しました。既に含まれている可能性があります。');\n        }\n    };\n\n    return (\n        <Modal\n            isOpen={true}\n            onClose={onClose}\n            title=\"セットに追加\"\n            size=\"md\"\n            footer={\n                <Button variant=\"outline\" className=\"w-full\" onClick={onClose}>\n                    キャンセル\n                </Button>\n            }\n        >\n            <Stack gap=\"md\">\n                <Text variant=\"xs\" color=\"secondary\">このコレクションを追加するセットを選択してください</Text>\n\n                <View className=\"max-h-[400px] overflow-y-auto pr-1\">\n                    {loading ? (\n                        <Flex justify=\"center\" className=\"py-10\">\n                            <Spinner />\n                        </Flex>\n                    ) : collectionSets.length === 0 ? (\n                        <Stack gap=\"md\" align=\"center\" className=\"py-10 text-center\">\n                            <FolderOpen size={40} className=\"text-slate-200\" />\n                            <Text color=\"secondary\">セットがまだありません</Text>\n                            <Text variant=\"xs\" color=\"secondary\" className=\"max-w-[200px]\">\n                                プロフィールページから新しいコレクションセットを作成できます\n                            </Text>\n                        </Stack>\n                    ) : (\n                        <Stack gap=\"sm\">\n                            {collectionSets.map(set => (\n                                <View\n                                    key={set.id}\n                                    onClick={() => handleAdd(set.id)}\n                                    className=\"group p-4 rounded-lg border border-surface-muted hover:border-brand-primary hover:bg-brand-primary/[0.02] cursor-pointer transition-all flex items-center justify-between\"\n                                >\n                                    <Flex gap=\"md\" align=\"center\">\n                                        <View className=\"p-2 rounded bg-brand-primary/10 text-brand-primary group-hover:bg-brand-primary group-hover:text-white transition-colors\">\n                                            <FolderOpen size={18} />\n                                        </View>\n                                        <Stack gap=\"none\">\n                                            <Text weight=\"bold\" variant=\"detail\">{set.name}</Text>\n                                            <Text variant=\"xs\" color=\"secondary\" className=\"opacity-70\">\n                                                作成: {new Date(set.createdAt).toLocaleDateString()}\n                                            </Text>\n                                        </Stack>\n                                    </Flex>\n                                    <Plus size={18} className=\"text-brand-primary opacity-0 group-hover:opacity-100 transition-opacity\" />\n                                </View>\n                            ))}\n                        </Stack>\n                    )}\n                </View>\n            </Stack>\n        </Modal>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/collectionSets/components/CollectionSetCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/collectionSets/components/CollectionSetForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Card' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":14,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Card"},"fix":{"range":[429,486],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { View } from '@/src/design/primitives/View';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { createSet, updateSet, CreateCollectionSetRequest, UpdateCollectionSetRequest } from '../api';\nimport { CollectionSet } from '@/src/entities/collection';\nimport { Card } from '@/src/design/baseComponents/Card';\nimport { Modal } from '@/src/design/baseComponents/Modal';\n\ninterface CollectionSetFormProps {\n    initialData?: CollectionSet;\n    onSuccess: (set: CollectionSet) => void;\n    onCancel: () => void;\n}\n\nexport function CollectionSetForm({ initialData, onSuccess, onCancel }: CollectionSetFormProps) {\n    const [name, setName] = useState(initialData?.name || '');\n    const [description, setDescription] = useState(initialData?.descriptionText || '');\n    const [isOpen, setIsOpen] = useState(initialData?.isOpen ?? false);\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState<string | null>(null);\n\n    const isEdit = !!initialData;\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setLoading(true);\n        setError(null);\n\n        try {\n            let result: CollectionSet;\n            if (isEdit) {\n                const req: UpdateCollectionSetRequest = { name, descriptionText: description, isOpen };\n                result = await updateSet(initialData.id, req);\n            } else {\n                const req: CreateCollectionSetRequest = { name, descriptionText: description, isOpen };\n                result = await createSet(req);\n            }\n            onSuccess(result);\n        } catch (err) {\n            setError('送信に失敗しました。');\n            console.error(err);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <Modal\n            isOpen={true}\n            onClose={onCancel}\n            title={isEdit ? 'セットを編集' : '新しいセットを作成'}\n            size=\"md\"\n            footer={\n                <View className=\"flex gap-3 pt-2\">\n                    <Button\n                        type=\"button\"\n                        variant=\"ghost\"\n                        fullWidth\n                        onClick={onCancel}\n                        disabled={loading}\n                    >\n                        キャンセル\n                    </Button>\n                    <Button\n                        type=\"submit\"\n                        variant=\"solid\"\n                        fullWidth\n                        loading={loading}\n                        onClick={handleSubmit}\n                    >\n                        {isEdit ? '更新' : '作成'}\n                    </Button>\n                </View>\n            }\n        >\n            <form onSubmit={handleSubmit}>\n                <Stack gap=\"lg\">\n                    {error && (\n                        <View bg=\"danger\" padding=\"sm\" rounded=\"md\">\n                            <Text color=\"secondary\" variant=\"xs\">{error}</Text>\n                        </View>\n                    )}\n\n                    <Stack gap=\"xs\">\n                        <label className=\"text-xs font-bold text-slate-500 ml-1\">名前</label>\n                        <input\n                            type=\"text\"\n                            value={name}\n                            onChange={(e) => setName(e.target.value)}\n                            className=\"w-full p-3 rounded-brand-md border border-surface-muted bg-surface-base focus:border-brand-primary outline-none transition-all\"\n                            placeholder=\"セット名を入力...\"\n                            required\n                        />\n                    </Stack>\n\n                    <Stack gap=\"xs\">\n                        <label className=\"text-xs font-bold text-slate-500 ml-1\">説明</label>\n                        <textarea\n                            value={description}\n                            onChange={(e) => setDescription(e.target.value)}\n                            className=\"w-full p-3 rounded-brand-md border border-surface-muted bg-surface-base focus:border-brand-primary outline-none transition-all min-h-[100px] resize-none\"\n                            placeholder=\"セットの説明を入力...\"\n                        />\n                    </Stack>\n\n                    <label className=\"flex items-center gap-3 cursor-pointer group\">\n                        <input\n                            type=\"checkbox\"\n                            checked={isOpen}\n                            onChange={(e) => setIsOpen(e.target.checked)}\n                            className=\"w-5 h-5 rounded border-surface-muted text-brand-primary focus:ring-brand-primary cursor-pointer\"\n                        />\n                        <Stack gap=\"none\">\n                            <Text variant=\"xs\" weight=\"bold\">公開する</Text>\n                            <Text variant=\"xs\" color=\"secondary\" className=\"opacity-70\">セットを他のユーザーからも見えるようにします</Text>\n                        </Stack>\n                    </label>\n                </Stack>\n            </form>\n        </Modal>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/collectionSets/hooks/useCollectionSets.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CollectionSet' is defined but never used.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":23,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CollectionSet"},"fix":{"range":[54,68],"text":""},"desc":"Remove unused variable \"CollectionSet\"."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'refresh'. Either include it or remove the dependency array.","line":26,"column":8,"nodeType":"ArrayExpression","endLine":26,"endColumn":15,"suggestions":[{"desc":"Update the dependencies array to be: [refresh, setId]","fix":{"range":[892,899],"text":"[refresh, setId]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\nimport { CollectionSet, CollectionSetResponse } from '@/src/entities/collection';\nimport { getSet, addCollectionToSet, removeCollectionFromSet } from '../api';\n\nexport function useCollectionSet(setId: string | undefined) {\n    const [data, setData] = useState<CollectionSetResponse | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState<string | null>(null);\n\n    const refresh = async () => {\n        if (!setId) return;\n        setLoading(true);\n        try {\n            const resp = await getSet(setId);\n            setData(resp);\n            setError(null);\n        } catch (err) {\n            setError(err instanceof Error ? err.message : 'Failed to fetch collection set');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    useEffect(() => {\n        refresh();\n    }, [setId]);\n\n    const addCollection = async (collectionId: string, displayOrder: number) => {\n        if (!setId) return;\n        await addCollectionToSet(setId, { collectionId, displayOrder });\n        await refresh();\n    };\n\n    const removeCollection = async (collectionId: string) => {\n        if (!setId) return;\n        await removeCollectionFromSet(setId, collectionId);\n        await refresh();\n    };\n\n    return { set: data?.set, collections: data?.collections || [], loading, error, refresh, addCollection, removeCollection };\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/collections/api/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/collections/components/AiGenerationModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/collections/components/AiQuickBar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/collections/components/CollectionBrowser.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/collections/components/CollectionCard.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/workspace/frontend/src/features/collections/components/CollectionCard.tsx:55:9\n  53 |\n  54 |     useEffect(() => {\n> 55 |         setIsFavorited(collection.isFavorited || false);\n     |         ^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  56 |         setFavCount(collection.favoriteCount || 0);\n  57 |     }, [collection.isFavorited, collection.favoriteCount]);\n  58 |","line":55,"column":9,"nodeType":null,"endLine":55,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleRankStart' is assigned a value but never used.","line":59,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":59,"endColumn":26}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React from 'react';\nimport { Card } from '@/src/design/baseComponents/Card';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { Flex } from '@/src/design/primitives/Flex';\nimport { Badge } from '@/src/design/baseComponents/Badge';\nimport { View } from '@/src/design/primitives/View';\nimport { Collection } from '@/src/entities/collection';\nimport { Book, Heart, Trophy, Trash2, Edit, FolderPlus } from 'lucide-react';\nimport { useRouter } from 'next/navigation';\nimport { Checkbox } from '@/src/design/baseComponents/Checkbox';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { addFavorite, removeFavorite } from '@/src/features/favorites/api';\nimport { useAuth } from '@/src/shared/auth/useAuth';\nimport { cn } from '@/src/shared/utils/cn';\nimport { useState, useEffect } from 'react';\n\ninterface CollectionCardProps {\n    collection: Collection;\n    selectable?: boolean;\n    selected?: boolean;\n    isSelectionMode?: boolean;\n    onSelect?: (id: string, name: string, count?: number) => void;\n    onStartRanking?: (id: string) => void;\n    onDelete?: (id: string) => void;\n    onEdit?: (id: string) => void;\n    onAddToSet?: (id: string) => void;\n    onClick?: () => void;\n    hideExtras?: boolean; // New prop to hide Fav/Ranking/Set buttons\n}\n\nexport function CollectionCard({\n    collection,\n    selectable = false,\n    selected = false,\n    isSelectionMode = false,\n    onSelect,\n    onStartRanking,\n    onDelete,\n    onEdit,\n    onAddToSet,\n    onClick,\n    hideExtras = false\n}: CollectionCardProps) {\n    const router = useRouter();\n    const { isAuthenticated, user } = useAuth();\n    const [isFavorited, setIsFavorited] = useState(collection.isFavorited || false);\n    const [favCount, setFavCount] = useState(collection.favoriteCount || 0);\n\n    const isOwner = user?.id === collection.userId;\n\n    useEffect(() => {\n        setIsFavorited(collection.isFavorited || false);\n        setFavCount(collection.favoriteCount || 0);\n    }, [collection.isFavorited, collection.favoriteCount]);\n\n    const handleRankStart = (e: React.MouseEvent) => {\n        e.preventDefault();\n        e.stopPropagation();\n        onStartRanking?.(collection.id);\n    };\n\n    const handleDelete = (e: React.MouseEvent) => {\n        e.preventDefault();\n        e.stopPropagation();\n        if (window.confirm(`「${collection.name}」を削除しますか？`)) {\n            onDelete?.(collection.id);\n        }\n    };\n\n    const handleFavoriteToggle = async (e: React.MouseEvent) => {\n        e.preventDefault();\n        e.stopPropagation();\n        if (!isAuthenticated) return;\n\n        try {\n            if (isFavorited) {\n                await removeFavorite(collection.id);\n                setIsFavorited(false);\n                setFavCount(prev => Math.max(0, prev - 1));\n            } else {\n                await addFavorite(collection.id);\n                setIsFavorited(true);\n                setFavCount(prev => prev + 1);\n            }\n        } catch (err) {\n            console.error('お気に入り操作に失敗しました', err);\n        }\n    };\n\n    const handleCardClick = (e: React.MouseEvent) => {\n        if (isSelectionMode) {\n            e.preventDefault();\n            e.stopPropagation();\n            onSelect?.(collection.id, collection.name, collection.questionCount);\n        }\n    };\n\n    return (\n        <View className=\"relative group h-full\">\n            {/* チェックボックス — 選択モードまたは selectable の場合に表示 */}\n            {(isSelectionMode || selectable) && (\n                <View\n                    zIndex=\"docked\"\n                    className={cn(\n                        \"absolute top-2 left-2 transition-all duration-300 p-2 rounded-full\",\n                        selected\n                            ? \"opacity-100 scale-100 bg-brand-primary/10\"\n                            : \"opacity-40 group-hover:opacity-100 scale-95\"\n                    )}\n                >\n                    <Checkbox\n                        checked={selected}\n                        onChange={(e) => {\n                            e.stopPropagation();\n                            onSelect?.(collection.id, collection.name, collection.questionCount);\n                        }}\n                        onClick={(e) => {\n                            e.stopPropagation();\n                        }}\n                        className=\"w-5 h-5 cursor-pointer shadow-sm\"\n                    />\n                </View>\n            )}\n\n\n            {/* カード本体 — クリックで詳細ページへ遷移 (選択モード時は無効化) */}\n            <View\n                onClick={(e) => {\n                    handleCardClick(e);\n                    if (isSelectionMode) return;\n\n                    if (onClick) {\n                        onClick();\n                    } else {\n                        router.push(`/collections/${collection.id}`);\n                    }\n                }}\n                className={cn(\"h-full\", !isSelectionMode && \"cursor-pointer\")}\n            >\n                <Card\n                    border=\"primary\"\n                    shadow={selected ? \"lg\" : \"sm\"}\n                    bg={selected ? \"primary\" : \"card\"}\n                    className={cn(\n                        \"h-full transition-all duration-500 group-hover:shadow-lg group-hover:border-brand-primary/60 group-hover:-translate-y-0.5 overflow-hidden relative\",\n                        selected && \"ring-4 ring-brand-primary/20 bg-brand-primary/[0.02]\"\n                    )}\n                >\n                    {/* 操作ボタン */}\n                    <View zIndex=\"docked\" className=\"absolute top-3 right-3 flex gap-2\">\n                        {onAddToSet && !hideExtras && (\n                            <Button\n                                size=\"sm\"\n                                variant=\"ghost\"\n                                className=\"p-2 h-auto rounded-full text-brand-primary bg-brand-primary/10 hover:bg-brand-primary/30 shadow-sm transition-all active:scale-90 border-2 border-brand-primary/20\"\n                                onClick={(e) => {\n                                    e.preventDefault();\n                                    e.stopPropagation();\n                                    onAddToSet(collection.id);\n                                }}\n                                title=\"セットに追加\"\n                            >\n                                <FolderPlus size={16} strokeWidth={2.5} />\n                            </Button>\n                        )}\n                        {onEdit && isOwner && (\n                            <Button\n                                size=\"sm\"\n                                variant=\"ghost\"\n                                className=\"p-2 h-auto rounded-full text-brand-primary bg-brand-primary/10 hover:bg-brand-primary/30 shadow-sm transition-all active:scale-90\"\n                                onClick={(e) => {\n                                    e.preventDefault();\n                                    e.stopPropagation();\n                                    onEdit(collection.id);\n                                }}\n                                title=\"コレクションを編集\"\n                            >\n                                <Edit size={16} strokeWidth={2.5} />\n                            </Button>\n                        )}\n                        {onDelete && (\n                            <Button\n                                size=\"sm\"\n                                variant=\"ghost\"\n                                color=\"danger\"\n                                className=\"p-2 h-auto rounded-full text-brand-danger bg-brand-danger/10 hover:bg-brand-danger/30 shadow-sm transition-all active:scale-90\"\n                                onClick={handleDelete}\n                                title=\"コレクションを削除\"\n                            >\n                                <Trash2 size={16} strokeWidth={2.5} />\n                            </Button>\n                        )}\n                    </View>\n                    <Stack gap=\"lg\" className=\"h-full p-1\">\n                        <Flex justify=\"between\" align=\"start\">\n                            <Stack gap=\"xs\" className={cn(\n                                \"flex-1\",\n                                (selectable || isSelectionMode) && \"pl-10\",\n                                (onEdit || onDelete || (onAddToSet && !hideExtras)) && \"pr-24\"\n                            )}>\n                                <Text weight=\"bold\" variant=\"detail\" className=\"line-clamp-1 group-hover:text-brand-primary transition-colors text-brand-primary/90\">\n                                    {collection.name}\n                                </Text>\n                                <Flex gap=\"xs\" align=\"center\">\n                                    <Text variant=\"xs\" color=\"secondary\" className=\"font-medium opacity-80\">\n                                        by {collection.authorName || '匿名'}\n                                    </Text>\n                                    {collection.isOfficial && (\n                                        <Badge variant=\"primary\" className=\"px-2 py-0\">Official</Badge>\n                                    )}\n                                </Flex>\n                            </Stack>\n                        </Flex>\n\n                        {collection.descriptionText && (\n                            <Text variant=\"xs\" color=\"secondary\" className=\"line-clamp-3 leading-relaxed opacity-90 min-h-[3rem]\">\n                                {collection.descriptionText}\n                            </Text>\n                        )}\n\n                        <Flex justify=\"between\" align=\"center\" className=\"mt-auto pt-5 border-t border-surface-muted/50\">\n                            <Flex gap=\"xl\">\n                                <Flex\n                                    gap=\"xs\"\n                                    align=\"center\"\n                                    title=\"問題数\"\n                                >\n                                    <Book size={16} strokeWidth={2.5} className=\"text-brand-primary\" />\n                                    <Text variant=\"xs\" weight=\"bold\" color=\"primary\">{collection.questionCount || 0}</Text>\n                                </Flex>\n                                {!hideExtras && (\n                                    <Flex\n                                        gap=\"xs\"\n                                        align=\"center\"\n                                        className={cn(\n                                            \"transition-all cursor-pointer hover:scale-110 active:scale-95\",\n                                            !isFavorited && \"opacity-50\"\n                                        )}\n                                        title=\"お気に入り\"\n                                        onClick={handleFavoriteToggle}\n                                    >\n                                        <Heart\n                                            size={16}\n                                            strokeWidth={2.5}\n                                            className={cn(isFavorited ? \"text-brand-heart fill-brand-heart\" : \"text-brand-heart/50\")}\n                                        />\n                                        <Text variant=\"xs\" weight=\"bold\" color={isFavorited ? \"danger\" : \"secondary\"}>{favCount}</Text>\n                                    </Flex>\n                                )}\n                                {collection.userRank && (\n                                    <Flex gap=\"xs\" align=\"center\" title=\"あなたの順位\" className=\"bg-brand-primary/10 px-2 py-0.5 rounded-full\">\n                                        <Trophy size={14} className=\"text-brand-primary\" />\n                                        <Text variant=\"xs\" weight=\"bold\" color=\"primary\">{collection.userRank}位</Text>\n                                    </Flex>\n                                )}\n                            </Flex>\n\n                            {!hideExtras && (\n                                <Flex gap=\"xs\">\n                                    <Button\n                                        size=\"sm\"\n                                        variant=\"ghost\"\n                                        className=\"p-2 h-auto rounded-full text-brand-primary hover:bg-brand-primary/10 transition-transform active:scale-90\"\n                                        onClick={(e) => {\n                                            e.preventDefault();\n                                            e.stopPropagation();\n                                            router.push(`/collections/${collection.id}/ranking`);\n                                        }}\n                                        title=\"ランキングを見る\"\n                                    >\n                                        <Trophy size={18} strokeWidth={2.5} />\n                                    </Button>\n                                </Flex>\n                            )}\n                        </Flex>\n                    </Stack>\n                </Card>\n            </View>\n        </View >\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/collections/components/CollectionCreateForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Card' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":14,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Card"},"fix":{"range":[56,113],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'X' is defined but never used.","line":10,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":11,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"X"},"fix":{"range":[407,409],"text":""},"desc":"Remove unused variable \"X\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FolderPlus' is defined but never used.","line":10,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":23,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"FolderPlus"},"fix":{"range":[398,444],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState } from 'react';\nimport { Card } from '@/src/design/baseComponents/Card';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { Flex } from '@/src/design/primitives/Flex';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { Input } from '@/src/design/baseComponents/Input';\nimport { X, FolderPlus } from 'lucide-react';\nimport { createCollection } from '@/src/features/collections/api';\nimport { Collection } from '@/src/entities/collection';\nimport { Checkbox } from '@/src/design/baseComponents/Checkbox';\nimport { TextArea } from '@/src/design/baseComponents/TextArea';\nimport { Modal } from '@/src/design/baseComponents/Modal';\n\ninterface CollectionCreateFormProps {\n    onCreated: (collection: Collection) => void;\n    onCancel: () => void;\n}\n\nexport function CollectionCreateForm({ onCreated, onCancel }: CollectionCreateFormProps) {\n    const [name, setName] = useState('');\n    const [descriptionText, setDescriptionText] = useState('');\n    const [isOpen, setIsOpen] = useState(true);\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState<string | null>(null);\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        if (!name.trim()) {\n            setError('コレクション名は必須です');\n            return;\n        }\n        setLoading(true);\n        setError(null);\n        try {\n            const created = await createCollection({\n                name: name.trim(),\n                descriptionText: descriptionText.trim() || undefined,\n                isOpen\n            });\n            onCreated(created);\n        } catch (err) {\n            console.error('コレクション作成に失敗', err);\n            setError('作成に失敗しました');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <Modal\n            isOpen={true}\n            onClose={onCancel}\n            title=\"新しいコレクション\"\n            size=\"md\"\n            footer={\n                <Flex gap=\"sm\" justify=\"end\">\n                    <Button variant=\"outline\" type=\"button\" onClick={onCancel}>\n                        キャンセル\n                    </Button>\n                    <Button variant=\"solid\" color=\"primary\" onClick={handleSubmit} disabled={loading}>\n                        {loading ? '作成中...' : '作成'}\n                    </Button>\n                </Flex>\n            }\n        >\n            <form onSubmit={handleSubmit}>\n                <Stack gap=\"lg\">\n                    <Stack gap=\"md\">\n                        <Stack gap=\"xs\">\n                            <Text variant=\"xs\" weight=\"bold\">コレクション名 *</Text>\n                            <Input\n                                value={name}\n                                onChange={(e) => setName(e.target.value)}\n                                placeholder=\"例: 英語の基本単語\"\n                                autoFocus\n                            />\n                        </Stack>\n\n                        <Stack gap=\"xs\">\n                            <Text variant=\"xs\" weight=\"bold\">説明（任意）</Text>\n                            <TextArea\n                                value={descriptionText}\n                                onChange={(e) => setDescriptionText(e.target.value)}\n                                placeholder=\"コレクションの内容について説明を入力してください\"\n                            />\n                        </Stack>\n\n                        <Flex gap=\"sm\" align=\"center\">\n                            <Checkbox\n                                checked={isOpen}\n                                onChange={() => setIsOpen(!isOpen)}\n                            />\n                            <Text variant=\"xs\">公開する</Text>\n                        </Flex>\n                    </Stack>\n\n                    {error && (\n                        <Text variant=\"xs\" color=\"danger\">{error}</Text>\n                    )}\n                </Stack>\n            </form>\n        </Modal>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/collections/components/CollectionEditModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Card' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":14,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Card"},"fix":{"range":[56,113],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'X' is defined but never used.","line":10,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":11,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"X"},"fix":{"range":[407,409],"text":""},"desc":"Remove unused variable \"X\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Edit3' is defined but never used.","line":10,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":18,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Edit3"},"fix":{"range":[398,439],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'View' is defined but never used.","line":15,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":14,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"View"},"fix":{"range":[692,745],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState } from 'react';\nimport { Card } from '@/src/design/baseComponents/Card';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { Flex } from '@/src/design/primitives/Flex';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { Input } from '@/src/design/baseComponents/Input';\nimport { X, Edit3 } from 'lucide-react';\nimport { updateCollection } from '@/src/features/collections/api';\nimport { Collection } from '@/src/entities/collection';\nimport { Checkbox } from '@/src/design/baseComponents/Checkbox';\nimport { TextArea } from '@/src/design/baseComponents/TextArea';\nimport { View } from '@/src/design/primitives/View';\nimport { Modal } from '@/src/design/baseComponents/Modal';\n\ninterface CollectionEditModalProps {\n    collection: Collection;\n    onUpdated: (collection: Collection) => void;\n    onCancel: () => void;\n}\n\nexport function CollectionEditModal({ collection, onUpdated, onCancel }: CollectionEditModalProps) {\n    const [name, setName] = useState(collection.name);\n    const [descriptionText, setDescriptionText] = useState(collection.descriptionText || '');\n    const [isOpen, setIsOpen] = useState(collection.isOpen);\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState<string | null>(null);\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        if (!name.trim()) {\n            setError('コレクション名は必須です');\n            return;\n        }\n        setLoading(true);\n        setError(null);\n        try {\n            const updated = await updateCollection(collection.id, {\n                name: name.trim(),\n                descriptionText: descriptionText.trim() || undefined,\n                isOpen\n            });\n            onUpdated(updated);\n        } catch (err) {\n            console.error('コレクション更新に失敗', err);\n            setError('更新に失敗しました');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <Modal\n            isOpen={true}\n            onClose={onCancel}\n            title=\"コレクションの編集\"\n            size=\"md\"\n            footer={\n                <Flex gap=\"sm\" justify=\"end\">\n                    <Button variant=\"outline\" type=\"button\" onClick={onCancel}>\n                        キャンセル\n                    </Button>\n                    <Button variant=\"solid\" color=\"primary\" onClick={handleSubmit} disabled={loading}>\n                        {loading ? '保存中...' : '変更を保存'}\n                    </Button>\n                </Flex>\n            }\n        >\n            <form onSubmit={handleSubmit}>\n                <Stack gap=\"lg\">\n                    <Stack gap=\"md\">\n                        <Stack gap=\"xs\">\n                            <Text variant=\"xs\" weight=\"bold\">コレクション名 *</Text>\n                            <Input\n                                value={name}\n                                onChange={(e) => setName(e.target.value)}\n                                placeholder=\"例: 英語の基本単語\"\n                                autoFocus\n                            />\n                        </Stack>\n\n                        <Stack gap=\"xs\">\n                            <Text variant=\"xs\" weight=\"bold\">説明</Text>\n                            <TextArea\n                                value={descriptionText}\n                                onChange={(e) => setDescriptionText(e.target.value)}\n                                placeholder=\"コレクションの内容について説明を入力してください\"\n                            />\n                        </Stack>\n\n                        <label className=\"flex items-center gap-3 cursor-pointer group\">\n                            <Checkbox\n                                checked={isOpen}\n                                onChange={() => setIsOpen(!isOpen)}\n                            />\n                            <Stack gap=\"none\">\n                                <Text variant=\"xs\" weight=\"bold\">公開する</Text>\n                                <Text variant=\"xs\" color=\"secondary\" className=\"opacity-70\">このコレクションを他のユーザーからも見えるようにします</Text>\n                            </Stack>\n                        </label>\n                    </Stack>\n\n                    {error && (\n                        <Text variant=\"xs\" color=\"danger\">{error}</Text>\n                    )}\n                </Stack>\n            </form>\n        </Modal>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/collections/components/CollectionHeader.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Sparkles' is defined but never used.","line":16,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":32,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Sparkles"},"fix":{"range":[768,778],"text":""},"desc":"Remove unused variable \"Sparkles\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FileText' is defined but never used.","line":16,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":42,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"FileText"},"fix":{"range":[778,788],"text":""},"desc":"Remove unused variable \"FileText\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FileUp' is defined but never used.","line":16,"column":54,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":60,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"FileUp"},"fix":{"range":[798,806],"text":""},"desc":"Remove unused variable \"FileUp\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CsvImportModal' is defined but never used.","line":17,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":24,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"CsvImportModal"},"fix":{"range":[830,881],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AiGenerationModal' is defined but never used.","line":18,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":27,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"AiGenerationModal"},"fix":{"range":[881,938],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'PdfGenerationModal' is defined but never used.","line":19,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":28,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"PdfGenerationModal"},"fix":{"range":[938,997],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState } from 'react';\nimport { Card } from '@/src/design/baseComponents/Card';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { Flex } from '@/src/design/primitives/Flex';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { Badge } from '@/src/design/baseComponents/Badge';\nimport { View } from '@/src/design/primitives/View';\nimport { Collection } from '@/src/entities/collection';\nimport { useAuth } from '@/src/shared/auth/useAuth';\nimport { Heart, Edit, Globe, Lock, BookOpen } from 'lucide-react';\nimport { addFavorite, removeFavorite } from '@/src/features/favorites/api';\nimport { cn } from '@/src/shared/utils/cn';\nimport { MoreVertical, Sparkles, FileText, Download, FileUp } from 'lucide-react';\nimport { CsvImportModal } from './CsvImportModal';\nimport { AiGenerationModal } from './AiGenerationModal';\nimport { PdfGenerationModal } from './PdfGenerationModal';\nimport { exportCsv } from '../api';\nimport { useToast } from '@/src/shared/contexts/ToastContext';\n\ninterface CollectionHeaderProps {\n    collection: Collection;\n    isOwner: boolean;\n    questionCount: number;\n    onEdit?: () => void;\n}\n\nexport function CollectionHeader({ collection, isOwner, questionCount, onEdit }: CollectionHeaderProps) {\n    const { isAuthenticated } = useAuth();\n    const { showToast } = useToast();\n    const [isFavorited, setIsFavorited] = useState(collection.isFavorited || false);\n    const [favCount, setFavCount] = useState(collection.favoriteCount || 0);\n    const [loading, setLoading] = useState(false);\n    const [isActionMenuOpen, setIsActionMenuOpen] = useState(false);\n\n    React.useEffect(() => {\n        setIsFavorited(collection.isFavorited || false);\n        setFavCount(collection.favoriteCount || 0);\n    }, [collection.isFavorited, collection.favoriteCount]);\n\n    const handleFavoriteToggle = async () => {\n        if (!isAuthenticated || loading) return;\n        setLoading(true);\n        try {\n            if (isFavorited) {\n                await removeFavorite(collection.id);\n                setIsFavorited(false);\n                setFavCount(prev => Math.max(0, prev - 1));\n            } else {\n                await addFavorite(collection.id);\n                setIsFavorited(true);\n                setFavCount(prev => prev + 1);\n            }\n        } catch (err) {\n            console.error('お気に入り操作に失敗しました', err);\n            showToast({ message: 'お気に入り操作に失敗しました', variant: 'danger' });\n        } finally {\n            setLoading(false);\n        }\n    };\n    const handleExportCsv = async () => {\n        try {\n            const blob = await exportCsv(collection.id);\n            const url = window.URL.createObjectURL(blob);\n            const a = document.createElement('a');\n            a.href = url;\n            a.download = `${collection.name}.csv`;\n            document.body.appendChild(a);\n            a.click();\n            window.URL.revokeObjectURL(url);\n            document.body.removeChild(a);\n            showToast({ message: 'CSVをエクスポートしました', variant: 'success' });\n        } catch (err) {\n            console.error(err);\n            showToast({ message: 'エクスポートに失敗しました', variant: 'danger' });\n        }\n    };\n\n    return (\n        <Card className=\"border border-gray-300\">\n            <Stack gap=\"lg\">\n                <Flex justify=\"between\" align=\"start\" className=\"flex-wrap gap-4\">\n                    <Stack gap=\"sm\" className=\"flex-1\">\n                        <Flex gap=\"sm\" align=\"center\">\n                            <BookOpen size={24} className=\"text-brand-primary\" />\n                            <Text variant=\"h2\" weight=\"bold\">{collection.name}</Text>\n                        </Flex>\n                        <Flex gap=\"sm\" align=\"center\">\n                            {collection.isOfficial && (\n                                <Badge variant=\"primary\">Official</Badge>\n                            )}\n                            <Badge variant=\"secondary\">\n                                {collection.isOpen ? (\n                                    <Flex gap=\"xs\" align=\"center\"><Globe size={12} /> 公開</Flex>\n                                ) : (\n                                    <Flex gap=\"xs\" align=\"center\"><Lock size={12} /> 非公開</Flex>\n                                )}\n                            </Badge>\n                        </Flex>\n                    </Stack>\n\n                    <Flex gap=\"sm\" align=\"center\">\n                        {isAuthenticated && (\n                            <Button\n                                variant=\"ghost\"\n                                size=\"sm\"\n                                onClick={handleFavoriteToggle}\n                                className={cn(\n                                    \"gap-1.5 transition-colors\",\n                                    isFavorited ? \"text-brand-heart\" : \"text-foreground/50\"\n                                )}\n                            >\n                                <Heart\n                                    size={20}\n                                    className={cn(isFavorited && \"fill-brand-heart\")}\n                                />\n                                <Text variant=\"xs\" weight=\"bold\">{favCount}</Text>\n                            </Button>\n                        )}\n                        {isOwner && onEdit && (\n                            <Flex gap=\"sm\">\n                                <Button variant=\"outline\" size=\"sm\" onClick={onEdit} className=\"gap-1.5\">\n                                    <Edit size={16} />\n                                    編集\n                                </Button>\n\n                                <View className=\"relative\">\n                                    <Button\n                                        variant=\"ghost\"\n                                        size=\"sm\"\n                                        onClick={() => setIsActionMenuOpen(!isActionMenuOpen)}\n                                        className=\"p-2\"\n                                    >\n                                        <MoreVertical size={20} />\n                                    </Button>\n\n                                    {isActionMenuOpen && (\n                                        <>\n                                            <View\n                                                className=\"fixed inset-0 z-40\"\n                                                onClick={() => setIsActionMenuOpen(false)}\n                                            />\n                                            <Card className=\"absolute right-0 top-full z-50 mt-2 w-48 p-2 shadow-lg\">\n                                                <Stack>\n                                                    <Button\n                                                        variant=\"ghost\"\n                                                        className=\"w-full justify-start gap-2 h-10 px-4\"\n                                                        onClick={() => {\n                                                            setIsActionMenuOpen(false);\n                                                            handleExportCsv();\n                                                        }}\n                                                    >\n                                                        <Download size={16} className=\"text-gray-500\" />\n                                                        CSVエクスポート\n                                                    </Button>\n                                                </Stack>\n                                            </Card>\n                                        </>\n                                    )}\n                                </View>\n                            </Flex>\n                        )}\n                    </Flex>\n                </Flex>\n\n                {collection.descriptionText && (\n                    <View className=\"border-t border-gray-200 pt-4\">\n                        <Text variant=\"detail\" color=\"secondary\" className=\"leading-relaxed\">\n                            {collection.descriptionText}\n                        </Text>\n                    </View>\n                )}\n\n                <Flex gap=\"lg\" className=\"border-t border-gray-200 pt-4\">\n                    <Flex gap=\"xs\" align=\"center\" className=\"text-foreground/60\">\n                        <BookOpen size={16} />\n                        <Text variant=\"xs\" weight=\"bold\">{questionCount} 問</Text>\n                    </Flex>\n                    <Flex gap=\"xs\" align=\"center\" className=\"text-foreground/60\">\n                        <Heart size={16} />\n                        <Text variant=\"xs\" weight=\"bold\">{favCount} お気に入り</Text>\n                    </Flex>\n                    {collection.authorName && (\n                        <Text variant=\"xs\" color=\"secondary\">\n                            作成者: {collection.authorName}\n                        </Text>\n                    )}\n                </Flex>\n            </Stack >\n        </Card >\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/collections/components/CsvImportModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Input' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":15,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Input"},"fix":{"range":[288,347],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState } from 'react';\nimport { Modal } from '@/src/design/baseComponents/Modal';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { Input } from '@/src/design/baseComponents/Input';\nimport { View } from '@/src/design/primitives/View';\nimport { Flex } from '@/src/design/primitives/Flex';\nimport { FileUp, AlertCircle, CheckCircle, Download } from 'lucide-react';\nimport { uploadCsv } from '../api';\nimport { useToast } from '@/src/shared/contexts/ToastContext';\nimport { cn } from '@/src/shared/utils/cn';\n\ninterface CsvImportModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    collectionId: string;\n    onSuccess: () => void;\n}\n\nexport function CsvImportModal({ isOpen, onClose, collectionId, onSuccess }: CsvImportModalProps) {\n    const [file, setFile] = useState<File | null>(null);\n    const [loading, setLoading] = useState(false);\n    const { showToast } = useToast();\n\n    const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const selectedFile = e.target.files?.[0];\n        if (selectedFile && selectedFile.type === 'text/csv' || selectedFile?.name.endsWith('.csv')) {\n            setFile(selectedFile);\n        } else {\n            showToast({ message: 'CSVファイルを選択してください', variant: 'warning' });\n            setFile(null);\n        }\n    };\n\n    const handleUpload = async () => {\n        if (!file) return;\n\n        setLoading(true);\n        try {\n            await uploadCsv(collectionId, file);\n            showToast({ message: 'CSVインポートが完了しました', variant: 'success' });\n            onSuccess();\n            onClose();\n        } catch (err) {\n            console.error(err);\n            showToast({ message: 'インポートに失敗しました。ファイル形式を確認してください。', variant: 'danger' });\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <Modal\n            isOpen={isOpen}\n            onClose={onClose}\n            title=\"CSVインポート\"\n            size=\"md\"\n        >\n            <Stack gap=\"xl\">\n                <View className=\"bg-brand-primary/5 p-4 rounded-lg border border-brand-primary/10\">\n                    <Stack gap=\"sm\">\n                        <Flex gap=\"sm\" align=\"center\" className=\"text-brand-primary\">\n                            <AlertCircle size={18} />\n                            <Text weight=\"bold\">インポートのヒント</Text>\n                        </Flex>\n                        <Stack gap=\"xs\">\n                            <Text variant=\"detail\" color=\"secondary\">\n                                CSVのヘッダーには「問題文」「正解」「解説」を含めてください。\n                            </Text>\n                            <Text variant=\"detail\" color=\"secondary\">\n                                (または英語で: question, answer, description)\n                            </Text>\n                        </Stack>\n                        <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            className=\"w-fit gap-1 text-brand-primary p-0 h-auto hover:bg-transparent\"\n                            onClick={() => {\n                                const csvContent = \"問題文,正解,解説\\n例: 日本の首都は？,東京,日本の政治・経済の中心地です。\";\n                                const blob = new Blob([new Uint8Array([0xEF, 0xBB, 0xBF]), csvContent], { type: 'text/csv;charset=utf-8' });\n                                const url = URL.createObjectURL(blob);\n                                const link = document.createElement('a');\n                                link.href = url;\n                                link.setAttribute('download', 'template.csv');\n                                document.body.appendChild(link);\n                                link.click();\n                                document.body.removeChild(link);\n                            }}\n                        >\n                            <Download size={14} />\n                            テンプレートをダウンロード\n                        </Button>\n                    </Stack>\n                </View>\n\n                <Stack gap=\"sm\">\n                    <Text weight=\"bold\" variant=\"xs\">CSVファイルを選択</Text>\n                    <View\n                        className={cn(\n                            \"relative border-2 border-dashed rounded-xl p-8 transition-all hover:bg-gray-50 flex flex-col items-center justify-center gap-4 cursor-pointer\",\n                            file ? \"border-brand-primary bg-brand-primary/5\" : \"border-gray-200\"\n                        )}\n                        onClick={() => document.getElementById('csv-upload-input')?.click()}\n                    >\n                        <input\n                            id=\"csv-upload-input\"\n                            type=\"file\"\n                            accept=\".csv\"\n                            className=\"hidden\"\n                            onChange={handleFileChange}\n                        />\n                        {file ? (\n                            <>\n                                <CheckCircle size={48} className=\"text-brand-primary\" />\n                                <Text weight=\"bold\">{file.name}</Text>\n                                <Text variant=\"xs\" color=\"secondary\">クリックしてファイルを選択し直す</Text>\n                            </>\n                        ) : (\n                            <>\n                                <FileUp size={48} className=\"text-gray-300\" />\n                                <Stack gap=\"xs\" align=\"center\">\n                                    <Text weight=\"bold\">クリックしてファイルを選択</Text>\n                                    <Text variant=\"xs\" color=\"secondary\">またはファイルをドラッグ＆ドロップ</Text>\n                                </Stack>\n                            </>\n                        )}\n                    </View>\n                </Stack>\n\n                <Flex justify=\"end\" gap=\"sm\">\n                    <Button variant=\"ghost\" onClick={onClose} disabled={loading}>\n                        キャンセル\n                    </Button>\n                    <Button\n                        variant=\"solid\"\n                        onClick={handleUpload}\n                        disabled={!file || loading}\n                        loading={loading}\n                    >\n                        インポートを開始\n                    </Button>\n                </Flex>\n            </Stack>\n        </Modal>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/collections/components/FixedSelectionTray.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/collections/components/PdfGenerationModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/collections/hooks/useAiGeneration.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/collections/hooks/useCollections.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'refresh'. Either include it or remove the dependency array.","line":51,"column":8,"nodeType":"ArrayExpression","endLine":51,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [refresh, userId]","fix":{"range":[1646,1654],"text":"[refresh, userId]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'refresh'. Either include it or remove the dependency array.","line":102,"column":8,"nodeType":"ArrayExpression","endLine":102,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [refresh, userId]","fix":{"range":[3159,3167],"text":"[refresh, userId]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\nimport { Collection, CollectionSet } from '@/src/entities/collection';\nimport { getRecentCollections, getUserCollections, getFolloweeCollections, getUserCollectionSets } from '../api';\n\nexport function useRecentCollections() {\n    const [collections, setCollections] = useState<Collection[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState<string | null>(null);\n\n    const refresh = async () => {\n        setLoading(true);\n        try {\n            const data = await getRecentCollections();\n            setCollections(data);\n            setError(null);\n        } catch (err) {\n            setError(err instanceof Error ? err.message : 'Failed to fetch collections');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    useEffect(() => {\n        refresh();\n    }, []);\n\n    return { collections, loading, error, refresh };\n}\n\nexport function useUserCollections(userId: string | undefined) {\n    const [collections, setCollections] = useState<Collection[]>([]);\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState<string | null>(null);\n\n    const refresh = async () => {\n        if (!userId) return;\n        setLoading(true);\n        try {\n            const data = await getUserCollections(userId);\n            setCollections(data);\n            setError(null);\n        } catch (err) {\n            setError(err instanceof Error ? err.message : 'Failed to fetch user collections');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    useEffect(() => {\n        refresh();\n    }, [userId]);\n\n    return { collections, loading, error, refresh };\n}\n\nexport function useFolloweeCollections() {\n    const [collections, setCollections] = useState<Collection[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState<string | null>(null);\n\n    const refresh = async () => {\n        setLoading(true);\n        try {\n            const data = await getFolloweeCollections();\n            setCollections(data);\n            setError(null);\n        } catch (err) {\n            setError(err instanceof Error ? err.message : 'Failed to fetch followee collections');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    useEffect(() => {\n        refresh();\n    }, []);\n\n    return { collections, loading, error, refresh };\n}\n\nexport function useUserCollectionSets(userId: string | undefined) {\n    const [collectionSets, setCollectionSets] = useState<CollectionSet[]>([]);\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState<string | null>(null);\n\n    const refresh = async () => {\n        if (!userId) return;\n        setLoading(true);\n        try {\n            const data = await getUserCollectionSets(userId);\n            setCollectionSets(data);\n            setError(null);\n        } catch (err) {\n            setError(err instanceof Error ? err.message : 'Failed to fetch collection sets');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    useEffect(() => {\n        refresh();\n    }, [userId]);\n\n    return { collectionSets, loading, error, refresh };\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/collections/types/index.ts","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":7,"column":18,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":7,"endColumn":41,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[122,191],"text":"type UpdateCollectionRequest = CreateCollectionRequest"},"desc":"Replace empty interface with a type alias."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export interface CreateCollectionRequest {\n    name: string;\n    descriptionText?: string;\n    isOpen: boolean;\n}\n\nexport interface UpdateCollectionRequest extends CreateCollectionRequest { }\n\nexport interface UpsertCollectionItem {\n    id?: string;\n    name?: string;\n    descriptionText?: string;\n    isOpen?: boolean;\n}\n\nexport interface BatchCollectionsRequest {\n    upsertItems: UpsertCollectionItem[];\n    deleteIds: string[];\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/favorites/api/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/follow/api/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/home/components/EditRequestNotification.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[551,554],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[551,554],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useEffect, useState } from 'react';\nimport { getMyPendingRequests } from '@/src/features/questions/api';\nimport { Card } from '@/src/design/baseComponents/Card';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Flex } from '@/src/design/primitives/Flex';\nimport { MessageSquare, ChevronRight } from 'lucide-react';\nimport { useRouter } from 'next/navigation';\nimport { View } from '@/src/design/primitives/View';\n\nexport function EditRequestNotification() {\n    const [requests, setRequests] = useState<any[]>([]);\n    const [loading, setLoading] = useState(true);\n    const router = useRouter();\n\n    useEffect(() => {\n        const fetchRequests = async () => {\n            try {\n                const data = await getMyPendingRequests();\n                setRequests(data);\n            } catch (err) {\n                console.error('Failed to fetch pending requests', err);\n            } finally {\n                setLoading(false);\n            }\n        };\n        fetchRequests();\n    }, []);\n\n    if (loading) return null;\n    if (requests.length === 0) return null;\n\n    const latest = requests[0];\n    const otherCount = requests.length - 1;\n\n    return (\n        <Card\n            onClick={() => router.push('/edit-requests')}\n            className=\"cursor-pointer hover:bg-surface-primary transition-colors border-brand-secondary/20 bg-brand-secondary/[0.02]\"\n            padding=\"sm\"\n        >\n            <Flex justify=\"between\" align=\"center\" className=\"px-2\">\n                <Flex gap=\"sm\" align=\"center\" className=\"min-w-0 flex-1\">\n                    <View className=\"bg-brand-secondary/10 p-2 rounded-full text-brand-secondary flex-shrink-0\">\n                        <MessageSquare size={18} />\n                    </View>\n                    <View className=\"min-w-0 flex-1\">\n                        <Text variant=\"detail\" weight=\"bold\" className=\"line-clamp-1\">\n                            修正依頼: <Text span color=\"primary\" weight=\"bold\">{latest.proposedQuestionText}</Text>\n                            {otherCount > 0 && (\n                                <Text span color=\"secondary\" weight=\"medium\" className=\"ml-2\">\n                                    他 {otherCount} 件\n                                </Text>\n                            )}\n                        </Text>\n                    </View>\n                </Flex>\n                <ChevronRight size={18} className=\"text-secondary opacity-30 flex-shrink-0 ml-2\" />\n            </Flex>\n        </Card>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/home/components/NavCards.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/home/components/TimelineTabs.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":84,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":84,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3016,3019],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3016,3019],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":84,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":84,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3030,3033],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3030,3033],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React from 'react';\nimport { Tabs, TabItem } from '@/src/design/baseComponents/Tabs';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { Grid } from '@/src/design/primitives/Grid';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Spinner } from '@/src/design/baseComponents/Spinner';\nimport { View } from '@/src/design/primitives/View';\nimport { Flex } from '@/src/design/primitives/Flex';\nimport { CollectionCard } from '@/src/features/collections/components/CollectionCard';\nimport { useRecentCollections, useFolloweeCollections } from '@/src/features/collections/hooks/useCollections';\nimport { useAuth } from '@/src/shared/auth/useAuth';\nimport { AddToSetModal } from '@/src/features/collectionSets/components/AddToSetModal';\nimport { QuizOptionModal } from '@/src/features/quiz/components/QuizOptionModal';\nimport { startCasualQuiz } from '@/src/features/quiz/api';\nimport { useRouter } from 'next/navigation';\nimport { useState } from 'react';\n\ninterface TimelineListProps {\n    type: 'recent' | 'following';\n    onAddToSet: (id: string) => void;\n    onQuickPlay: (id: string) => void;\n}\n\nfunction TimelineList({ type, onAddToSet, onQuickPlay }: TimelineListProps) {\n    const { isAuthenticated } = useAuth();\n    const recent = useRecentCollections();\n    const followee = useFolloweeCollections();\n\n    const currentData = type === 'following' ? followee : recent;\n\n    if (currentData.loading) {\n        return (\n            <Flex justify=\"center\" className=\"py-20\">\n                <Spinner size=\"lg\" />\n            </Flex>\n        );\n    }\n\n    if (currentData.error) {\n        return (\n            <View className=\"bg-brand-danger/10 p-6 rounded-lg text-center\">\n                <Text color=\"danger\">エラー: {currentData.error}</Text>\n            </View>\n        );\n    }\n\n    if (currentData.collections.length === 0) {\n        return (\n            <View className=\"py-20 text-center\">\n                <Text color=\"secondary\">投稿がありません</Text>\n            </View>\n        );\n    }\n\n    return (\n        <Grid cols={{ sm: 2, lg: 3 }} gap=\"lg\">\n            {currentData.collections.map((collection) => (\n                <CollectionCard\n                    key={collection.id}\n                    collection={collection}\n                    onAddToSet={isAuthenticated ? onAddToSet : undefined}\n                    onClick={() => {\n                        onQuickPlay(collection.id);\n                    }}\n                />\n            ))}\n        </Grid>\n    );\n}\n\nexport function TimelineTabs() {\n    const router = useRouter();\n    const { isAuthenticated } = useAuth();\n    const [collectionToAddToSet, setCollectionToAddToSet] = useState<string | null>(null);\n    const [selectedCollectionId, setSelectedCollectionId] = useState<string | null>(null);\n    const [isStartingQuiz, setIsStartingQuiz] = useState(false);\n\n    const handleQuickPlay = (id: string) => {\n        setSelectedCollectionId(id);\n    };\n\n    const handleStartQuiz = async (filters: any[], sorts: any[], limit: number) => {\n        if (!selectedCollectionId) return;\n        setIsStartingQuiz(true);\n        try {\n            const resp = await startCasualQuiz({\n                collectionIds: [selectedCollectionId],\n                filters,\n                sorts,\n                limit\n            });\n            if (typeof window !== 'undefined') {\n                sessionStorage.setItem('quizData', JSON.stringify(resp));\n            }\n            router.push('/quiz');\n        } catch (err) {\n            console.error('Failed to start quiz', err);\n        } finally {\n            setIsStartingQuiz(false);\n            setSelectedCollectionId(null);\n        }\n    };\n\n\n    const items: TabItem[] = [\n        {\n            id: 'recent',\n            label: '最新の投稿',\n            content: <TimelineList type=\"recent\" onAddToSet={setCollectionToAddToSet} onQuickPlay={handleQuickPlay} />\n        }\n    ];\n\n    if (isAuthenticated) {\n        items.unshift({\n            id: 'following',\n            label: 'フォロー中',\n            content: <TimelineList type=\"following\" onAddToSet={setCollectionToAddToSet} onQuickPlay={handleQuickPlay} />\n        });\n    }\n\n    return (\n        <Stack gap=\"lg\" className=\"w-full\">\n            <Tabs items={items} defaultTab={isAuthenticated ? 'following' : 'recent'} fitted />\n\n            {collectionToAddToSet && (\n                <AddToSetModal\n                    collectionId={collectionToAddToSet}\n                    onClose={() => setCollectionToAddToSet(null)}\n                />\n            )}\n\n            {selectedCollectionId && (\n                <QuizOptionModal\n                    selectedCount={1}\n                    onStart={handleStartQuiz}\n                    onCancel={() => setSelectedCollectionId(null)}\n                    loading={isStartingQuiz}\n                />\n            )}\n        </Stack>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/questions/api/index.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":29,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":29,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[787,790],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[787,790],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":61,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":61,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1620,1623],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1620,1623],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":78,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":78,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2059,2062],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2059,2062],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":79,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":79,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2096,2099],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2096,2099],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":89,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":89,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2325,2328],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2325,2328],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":90,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":90,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2364,2367],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2364,2367],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":98,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":98,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2562,2565],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2562,2565],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":99,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":99,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2601,2604],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2601,2604],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":107,"column":108,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":107,"endColumn":111,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2812,2815],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2812,2815],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":108,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":108,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2849,2852],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2849,2852],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { apiClient } from '@/src/shared/api/apiClient';\nimport { Question, QuestionInput } from '@/src/entities/question';\n\n/**\n * コレクションに含まれる問題一覧を取得\n */\nexport const getCollectionQuestions = async (collectionId: string): Promise<Question[]> => {\n    return await apiClient<Question[]>(`/collections/${collectionId}/questions`, {\n        authenticated: true,\n    });\n};\n\n/**\n * 問題を新規作成\n */\nexport const createQuestion = async (collectionId: string, data: QuestionInput): Promise<Question> => {\n    return await apiClient<Question>(`/collections/${collectionId}/questions`, {\n        method: 'POST',\n        body: JSON.stringify(data),\n        authenticated: true,\n    });\n};\n\n/**\n * 問題を一括作成・更新\n */\nexport const batchQuestions = async (\n    collectionId: string,\n    data: { upsertItems: any[], deleteIds: string[] }\n): Promise<Question[]> => {\n    return await apiClient<Question[]>(`/collections/${collectionId}/questions/batch`, {\n        method: 'POST',\n        body: JSON.stringify(data),\n        authenticated: true,\n    });\n};\n\n/**\n * 問題を更新\n */\nexport const updateQuestion = async (questionId: string, data: QuestionInput): Promise<Question> => {\n    return await apiClient<Question>(`/questions/${questionId}`, {\n        method: 'PUT',\n        body: JSON.stringify(data),\n        authenticated: true,\n    });\n};\n\n/**\n * 問題を削除\n */\nexport const deleteQuestion = async (questionId: string): Promise<void> => {\n    await apiClient<void>(`/questions/${questionId}`, {\n        method: 'DELETE',\n        authenticated: true,\n    });\n};\n/**\n * 問題の不足している箇所をAIで補完\n */\nexport const completeQuestions = async (data: { items: any[], complete_description?: boolean }): Promise<Question[]> => {\n    return await apiClient<Question[]>(`/ai/complete`, {\n        method: 'POST',\n        body: JSON.stringify(data),\n        authenticated: true,\n    });\n};\n\n/**\n * 編集リクエストを送信\n */\nexport const createEditRequest = async (data: {\n    questionId: string;\n    questionText: string;\n    correctAnswers: string[];\n    descriptionText?: string;\n    reasonId: number;\n}): Promise<any> => {\n    return await apiClient<any>(`/edit-requests`, {\n        method: 'POST',\n        body: JSON.stringify(data),\n        authenticated: true,\n    });\n};\n\n/**\n * コレクションに紐づく編集リクエスト一覧を取得\n */\nexport const getEditRequests = async (collectionId: string): Promise<any[]> => {\n    return await apiClient<any[]>(`/collections/${collectionId}/edit-requests`, {\n        authenticated: true,\n    });\n};\n\n/**\n * ログインユーザーがオーナーである問題集への未承認編集リクエスト一覧を取得\n */\nexport const getMyPendingRequests = async (): Promise<any[]> => {\n    return await apiClient<any[]>(`/edit-requests/my-pending`, {\n        authenticated: true,\n    });\n};\n\n/**\n * 編集リクエストの状態を更新\n */\nexport const updateEditRequestStatus = async (requestId: string, status: 'approved' | 'rejected'): Promise<any> => {\n    return await apiClient<any>(`/edit-requests/${requestId}`, {\n        method: 'PATCH',\n        body: JSON.stringify({ status }),\n        authenticated: true,\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/questions/components/EditRequestModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":49,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":49,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState } from 'react';\nimport { Card } from '@/src/design/baseComponents/Card';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { Flex } from '@/src/design/primitives/Flex';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { Input } from '@/src/design/baseComponents/Input';\nimport { TextArea } from '@/src/design/baseComponents/TextArea';\nimport { X, Check, AlertCircle } from 'lucide-react';\nimport { useToast } from '@/src/shared/contexts/ToastContext';\nimport { createEditRequest } from '../api';\nimport { Question } from '@/src/entities/question';\n\ninterface EditRequestModalProps {\n    question: Question;\n    onClose: () => void;\n}\n\nconst EDIT_REASONS = [\n    { id: 1, label: '誤字脱字' },\n    { id: 2, label: '解答が不適切' },\n    { id: 3, label: '重複している' },\n    { id: 4, label: 'カテゴリ/分類が不適切' },\n    { id: 5, label: 'その他' },\n];\n\nexport function EditRequestModal({ question, onClose }: EditRequestModalProps) {\n    const [questionText, setQuestionText] = useState(question.questionText);\n    const [correctAnswers, setCorrectAnswers] = useState(question.correctAnswers.join('; '));\n    const [descriptionText, setDescriptionText] = useState(question.descriptionText || '');\n    const [reasonId, setReasonId] = useState<number>(1);\n    const [isSubmitting, setIsSubmitting] = useState(false);\n    const { showToast } = useToast();\n\n    const handleSubmit = async () => {\n        setIsSubmitting(true);\n        try {\n            await createEditRequest({\n                questionId: question.id,\n                questionText,\n                correctAnswers: correctAnswers.split(';').map(a => a.trim()).filter(a => a !== ''),\n                descriptionText: descriptionText.trim() !== '' ? descriptionText : undefined,\n                reasonId,\n            });\n            showToast({ message: '修正依頼を送信しました。オーナーの承認をお待ちください。', variant: 'success' });\n            onClose();\n        } catch (error) {\n            showToast({ message: '修正依頼の送信に失敗しました。', variant: 'danger' });\n        } finally {\n            setIsSubmitting(false);\n        }\n    };\n\n    return (\n        <Stack\n            gap=\"xl\"\n            className=\"fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 animate-in fade-in duration-200\"\n            onClick={onClose}\n        >\n            <Card\n                className=\"w-full max-w-lg overflow-hidden shadow-2xl border border-surface-muted flex flex-col max-h-[90vh] animate-in zoom-in-95 duration-200\"\n                onClick={(e) => e.stopPropagation()}\n            >\n                {/* Header */}\n                <Flex align=\"center\" justify=\"between\" className=\"px-6 py-4 border-b border-surface-muted bg-surface-muted/50\">\n                    <Stack gap=\"xs\">\n                        <Text weight=\"bold\" variant=\"h4\">修正を提案する</Text>\n                        <Text variant=\"xs\" color=\"secondary\">作成者に通知され、承認されると更新されます</Text>\n                    </Stack>\n                    <Button variant=\"ghost\" size=\"sm\" onClick={onClose} className=\"rounded-full h-8 w-8 p-0\">\n                        <X size={18} />\n                    </Button>\n                </Flex>\n\n                {/* Body */}\n                <Stack gap=\"lg\" className=\"p-6 overflow-y-auto\">\n                    <Stack gap=\"xs\">\n                        <Text variant=\"detail\" weight=\"medium\">修正理由</Text>\n                        <Flex gap=\"xs\" wrap>\n                            {EDIT_REASONS.map((reason) => (\n                                <Button\n                                    key={reason.id}\n                                    variant={reasonId === reason.id ? 'solid' : 'ghost'}\n                                    color={reasonId === reason.id ? 'primary' : 'secondary'}\n                                    size=\"sm\"\n                                    onClick={() => setReasonId(reason.id)}\n                                    className=\"text-xs h-8\"\n                                >\n                                    {reason.label}\n                                </Button>\n                            ))}\n                        </Flex>\n                    </Stack>\n\n                    <Stack gap=\"xs\">\n                        <Text variant=\"detail\" weight=\"medium\">問題文</Text>\n                        <TextArea\n                            value={questionText}\n                            onChange={(e) => setQuestionText(e.target.value)}\n                            placeholder=\"修正後の問題文...\"\n                            className=\"min-h-[100px] text-sm\"\n                        />\n                    </Stack>\n\n                    <Stack gap=\"xs\">\n                        <Text variant=\"detail\" weight=\"medium\">解答 (セミコロン区切り)</Text>\n                        <Input\n                            value={correctAnswers}\n                            onChange={(e) => setCorrectAnswers(e.target.value)}\n                            placeholder=\"Paris; パリ\"\n                            className=\"text-sm\"\n                        />\n                    </Stack>\n\n                    <Stack gap=\"xs\">\n                        <Text variant=\"detail\" weight=\"medium\">解説 (任意)</Text>\n                        <TextArea\n                            value={descriptionText}\n                            onChange={(e) => setDescriptionText(e.target.value)}\n                            placeholder=\"修正後の解説...\"\n                            className=\"min-h-[80px] text-sm\"\n                        />\n                    </Stack>\n\n                    <Flex gap=\"xs\" align=\"center\" className=\"p-3 bg-brand-info/10 border border-brand-info/20 rounded-lg\">\n                        <AlertCircle size={16} className=\"text-brand-info shrink-0\" />\n                        <Text variant=\"xs\" color=\"info\" className=\"italic\">\n                            不適切な内容やいたずらはアカウント停止の対象となる場合があります。\n                        </Text>\n                    </Flex>\n                </Stack>\n\n                {/* Footer */}\n                <Flex justify=\"end\" gap=\"md\" className=\"px-6 py-4 border-t border-surface-muted bg-surface-muted/50\">\n                    <Button variant=\"ghost\" onClick={onClose} disabled={isSubmitting}>\n                        キャンセル\n                    </Button>\n                    <Button\n                        variant=\"solid\"\n                        color=\"primary\"\n                        onClick={handleSubmit}\n                        disabled={isSubmitting || !questionText.trim() || !correctAnswers.trim()}\n                        className=\"min-w-[120px]\"\n                    >\n                        {isSubmitting ? '送信中...' : (\n                            <Flex align=\"center\" gap=\"xs\">\n                                <Check size={16} />\n                                <span>送信する</span>\n                            </Flex>\n                        )}\n                    </Button>\n                </Flex>\n            </Card>\n        </Stack>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/questions/components/EditRequestReviewList.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AlertCircle' is defined but never used.","line":11,"column":47,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":58,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"AlertCircle"},"fix":{"range":[506,519],"text":""},"desc":"Remove unused variable \"AlertCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Trash2' is defined but never used.","line":11,"column":60,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":66,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Trash2"},"fix":{"range":[519,527],"text":""},"desc":"Remove unused variable \"Trash2\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":31,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1194,1197],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1194,1197],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":43,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":43,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1616,1619],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1616,1619],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchRequests'. Either include it or remove the dependency array.","line":58,"column":8,"nodeType":"ArrayExpression","endLine":58,"endColumn":32,"suggestions":[{"desc":"Update the dependencies array to be: [collectionId, fetchRequests, isGlobal]","fix":{"range":[2027,2051],"text":"[collectionId, fetchRequests, isGlobal]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":60,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":60,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2097,2100],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2097,2100],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":75,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":75,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":85,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":85,"endColumn":23}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState, useEffect } from 'react';\nimport { Card } from '@/src/design/baseComponents/Card';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { Flex } from '@/src/design/primitives/Flex';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { View } from '@/src/design/primitives/View';\nimport { Badge } from '@/src/design/baseComponents/Badge';\nimport { Check, X, ArrowRight, MessageSquare, AlertCircle, Trash2 } from 'lucide-react';\nimport { getEditRequests, getMyPendingRequests, updateEditRequestStatus, updateQuestion } from '../api';\nimport { useToast } from '@/src/shared/contexts/ToastContext';\nimport { cn } from '@/src/shared/utils/cn';\n\ninterface EditRequestReviewListProps {\n    collectionId?: string;\n    onActionSuccess?: () => void;\n    isGlobal?: boolean;\n}\n\nconst REASON_LABELS: Record<number, string> = {\n    1: '誤字脱字',\n    2: '解答が不適切',\n    3: '重複している',\n    4: 'カテゴリ/分類が不適切',\n    5: 'その他',\n};\n\nexport function EditRequestReviewList({ collectionId, onActionSuccess, isGlobal = false }: EditRequestReviewListProps) {\n    const [requests, setRequests] = useState<any[]>([]);\n    const [loading, setLoading] = useState(true);\n    const { showToast } = useToast();\n\n    const fetchRequests = async () => {\n        setLoading(true);\n        try {\n            let data;\n            if (isGlobal) {\n                data = await getMyPendingRequests();\n            } else if (collectionId) {\n                data = await getEditRequests(collectionId);\n                data = data.filter((r: any) => r.status === 'pending');\n            } else {\n                data = [];\n            }\n            setRequests(data);\n        } catch (error) {\n            console.error('Failed to fetch requests', error);\n            showToast({ message: 'リクエストの取得に失敗しました', variant: 'danger' });\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    useEffect(() => {\n        fetchRequests();\n    }, [collectionId, isGlobal]);\n\n    const handleApprove = async (request: any) => {\n        try {\n            // 1. Update the actual question\n            await updateQuestion(request.questionId, {\n                questionText: request.questionText,\n                correctAnswers: request.correctAnswers,\n                descriptionText: request.descriptionText,\n            });\n\n            // 2. Update request status to approved\n            await updateEditRequestStatus(request.id, 'approved');\n\n            showToast({ message: '修正案を承認し、問題を更新しました', variant: 'success' });\n            fetchRequests();\n            if (onActionSuccess) onActionSuccess();\n        } catch (error) {\n            showToast({ message: '承認に失敗しました', variant: 'danger' });\n        }\n    };\n\n    const handleReject = async (requestId: string) => {\n        try {\n            await updateEditRequestStatus(requestId, 'rejected');\n            showToast({ message: '修正案を却下しました', variant: 'info' });\n            fetchRequests();\n        } catch (error) {\n            showToast({ message: '却下に失敗しました', variant: 'danger' });\n        }\n    };\n\n    if (loading) {\n        return <View className=\"py-8 text-center\"><Text color=\"secondary\">読み込み中...</Text></View>;\n    }\n\n    if (requests.length === 0) {\n        if (isGlobal) {\n            return (\n                <View className=\"py-12 text-center bg-surface-base rounded-2xl border-2 border-dashed border-surface-muted\">\n                    <Stack gap=\"md\" align=\"center\">\n                        <MessageSquare size={48} className=\"text-secondary opacity-20\" />\n                        <Text color=\"secondary\" weight=\"medium\">現在、未承認の修正依頼はありません</Text>\n                    </Stack>\n                </View>\n            );\n        }\n        return null; // Don't show anything in collection detail if no requests\n    }\n\n    return (\n        <Stack gap=\"lg\">\n            {!isGlobal && (\n                <Flex align=\"center\" gap=\"sm\">\n                    <Badge variant=\"primary\">{requests.length}</Badge>\n                    <Text variant=\"h3\" weight=\"bold\">修正依頼の確認</Text>\n                </Flex>\n            )}\n\n            <Stack gap=\"md\">\n                {requests.map((request) => {\n                    return (\n                        <Card key={request.id} padding=\"lg\" className=\"border-l-4 border-l-brand-primary\">\n                            <Stack gap=\"lg\">\n                                {/* Meta Header */}\n                                <Flex justify=\"between\" align=\"start\">\n                                    <Stack gap=\"xs\">\n                                        <Flex gap=\"sm\" align=\"center\">\n                                            <Badge variant=\"secondary\" className=\"text-[10px]\">\n                                                {REASON_LABELS[request.reasonId] || 'その他'}\n                                            </Badge>\n                                            <Text variant=\"xs\" color=\"secondary\">\n                                                依頼者: {request.requesterName || '匿名ユーザー'}\n                                            </Text>\n                                        </Flex>\n                                    </Stack>\n                                    <Flex gap=\"sm\">\n                                        <Button\n                                            variant=\"ghost\"\n                                            color=\"secondary\"\n                                            size=\"sm\"\n                                            className=\"h-9 gap-1 text-brand-danger hover:bg-brand-danger/10\"\n                                            onClick={() => handleReject(request.id)}\n                                        >\n                                            <X size={16} />\n                                            却下\n                                        </Button>\n                                        <Button\n                                            variant=\"solid\"\n                                            color=\"primary\"\n                                            size=\"sm\"\n                                            className=\"h-9 gap-1 shadow-md shadow-brand-primary/20\"\n                                            onClick={() => handleApprove(request)}\n                                        >\n                                            <Check size={16} />\n                                            承認して更新\n                                        </Button>\n                                    </Flex>\n                                </Flex>\n\n                                {/* Comparison Grid */}\n                                <View className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                                    {/* Original */}\n                                    <Stack gap=\"xs\">\n                                        <Text variant=\"xs\" weight=\"bold\" color=\"secondary\">現在の内容</Text>\n                                        <View className=\"p-4 rounded-xl bg-surface-muted/30 border border-surface-muted opacity-60\">\n                                            <Stack gap=\"sm\">\n                                                <Text variant=\"detail\" weight=\"medium\">{request.originalQuestionText}</Text>\n                                                <Text variant=\"xs\" color=\"secondary\">\n                                                    答: {request.originalCorrectAnswers?.join(' / ') || '未設定'}\n                                                </Text>\n                                                {request.originalDescriptionText && (\n                                                    <Text variant=\"xs\" color=\"secondary\" className=\"italic mt-1\">\n                                                        解説: {request.originalDescriptionText}\n                                                    </Text>\n                                                )}\n                                            </Stack>\n                                        </View>\n                                    </Stack>\n\n                                    {/* Proposed */}\n                                    <Stack gap=\"xs\">\n                                        <Text variant=\"xs\" weight=\"bold\" color=\"primary\">提案された内容</Text>\n                                        <View className=\"p-4 rounded-xl bg-brand-primary/5 border border-brand-primary/20 relative\">\n                                            <ArrowRight size={20} className=\"absolute -left-6 top-1/2 -translate-y-1/2 text-brand-primary hidden md:block\" />\n                                            <Stack gap=\"sm\">\n                                                <Text\n                                                    variant=\"detail\"\n                                                    weight=\"bold\"\n                                                    className={cn(request.originalQuestionText !== request.questionText && \"text-brand-primary\")}\n                                                >\n                                                    {request.questionText}\n                                                </Text>\n                                                <Text\n                                                    variant=\"xs\"\n                                                    className={cn(request.originalCorrectAnswers?.join(';') !== request.correctAnswers.join(';') && \"text-brand-primary font-bold\")}\n                                                >\n                                                    答: {request.correctAnswers.join(' / ')}\n                                                </Text>\n                                                {request.descriptionText && (\n                                                    <View className=\"mt-2 pt-2 border-t border-brand-primary/10\">\n                                                        <Text variant=\"xs\" color=\"secondary\" className=\"italic\">\n                                                            解説: {request.descriptionText}\n                                                        </Text>\n                                                    </View>\n                                                )}\n                                            </Stack>\n                                        </View>\n                                    </Stack>\n                                </View>\n                            </Stack>\n                        </Card>\n                    );\n                })}\n            </Stack>\n        </Stack>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/questions/components/QuestionForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used.","line":3,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":36,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useEffect"},"fix":{"range":[39,50],"text":""},"desc":"Remove unused variable \"useEffect\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState, useEffect } from 'react';\nimport { Card } from '@/src/design/baseComponents/Card';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { Flex } from '@/src/design/primitives/Flex';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { Input } from '@/src/design/baseComponents/Input';\nimport { View } from '@/src/design/primitives/View';\nimport { Question, QuestionInput } from '@/src/entities/question';\nimport { createQuestion, updateQuestion } from '@/src/features/questions/api';\nimport { X } from 'lucide-react';\n\ninterface QuestionFormProps {\n    collectionId: string;\n    question?: Question; // 編集時に既存の問題を渡す\n    onSaved: (question: Question) => void;\n    onCancel: () => void;\n}\n\nexport function QuestionForm({ collectionId, question, onSaved, onCancel }: QuestionFormProps) {\n    const isEditing = !!question;\n    const [input, setInput] = useState<QuestionInput>({\n        questionText: question?.questionText || '',\n        correctAnswers: question?.correctAnswers || [''],\n        descriptionText: question?.descriptionText || '',\n    });\n    const [answersString, setAnswersString] = useState(question?.correctAnswers.join(', ') || '');\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState<string | null>(null);\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        const correctAnswers = answersString.split(',').map(s => s.trim()).filter(s => s !== '');\n\n        if (!input.questionText.trim() || correctAnswers.length === 0) {\n            setError('問題文と正解は必須です');\n            return;\n        }\n\n        const data: QuestionInput = {\n            ...input,\n            correctAnswers\n        };\n\n        setLoading(true);\n        setError(null);\n\n        try {\n            let result: Question;\n            if (isEditing && question) {\n                result = await updateQuestion(question.id, data);\n            } else {\n                result = await createQuestion(collectionId, data);\n            }\n            onSaved(result);\n        } catch (err) {\n            console.error('問題の保存に失敗しました', err);\n            setError('保存に失敗しました。もう一度お試しください。');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <View className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50\">\n            <Card className=\"w-full max-w-lg mx-4 border border-gray-300\">\n                <form onSubmit={handleSubmit}>\n                    <Stack gap=\"lg\">\n                        <Flex justify=\"between\" align=\"center\">\n                            <Text variant=\"h3\" weight=\"bold\">\n                                {isEditing ? '問題を編集' : '問題を追加'}\n                            </Text>\n                            <Button\n                                variant=\"ghost\"\n                                size=\"sm\"\n                                type=\"button\"\n                                onClick={onCancel}\n                                className=\"p-1 h-auto\"\n                            >\n                                <X size={20} />\n                            </Button>\n                        </Flex>\n\n                        <Stack gap=\"md\">\n                            <Stack gap=\"xs\">\n                                <Text variant=\"xs\" weight=\"bold\">問題文 *</Text>\n                                <Input\n                                    value={input.questionText}\n                                    onChange={(e) => setInput({ ...input, questionText: e.target.value })}\n                                    placeholder=\"問題文を入力してください\"\n                                />\n                            </Stack>\n\n                            <Stack gap=\"xs\">\n                                <Text variant=\"xs\" weight=\"bold\">正解 *</Text>\n                                <Input\n                                    value={answersString}\n                                    onChange={(e) => setAnswersString(e.target.value)}\n                                    placeholder=\"正解を入力してください（複数の場合はカンマ区切り）\"\n                                />\n                            </Stack>\n\n                            <Stack gap=\"xs\">\n                                <Text variant=\"xs\" weight=\"bold\">解説（任意）</Text>\n                                <Input\n                                    value={input.descriptionText}\n                                    onChange={(e) => setInput({ ...input, descriptionText: e.target.value })}\n                                    placeholder=\"解説を入力してください\"\n                                />\n                            </Stack>\n                        </Stack>\n\n                        {error && (\n                            <Text variant=\"xs\" color=\"danger\">{error}</Text>\n                        )}\n\n                        <Flex gap=\"sm\" justify=\"end\">\n                            <Button variant=\"outline\" type=\"button\" onClick={onCancel}>\n                                キャンセル\n                            </Button>\n                            <Button variant=\"solid\" color=\"primary\" type=\"submit\" disabled={loading}>\n                                {loading ? '保存中...' : (isEditing ? '更新' : '追加')}\n                            </Button>\n                        </Flex>\n                    </Stack>\n                </form>\n            </Card>\n        </View>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/questions/components/QuestionList.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useCallback' is defined but never used.","line":3,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":49,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useCallback"},"fix":{"range":[50,63],"text":""},"desc":"Remove unused variable \"useCallback\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'RotateCcw' is defined but never used.","line":13,"column":70,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":79,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"RotateCcw"},"fix":{"range":[659,670],"text":""},"desc":"Remove unused variable \"RotateCcw\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Loader2' is defined but never used.","line":13,"column":106,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":113,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Loader2"},"fix":{"range":[695,704],"text":""},"desc":"Remove unused variable \"Loader2\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":118,"column":67,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":118,"endColumn":70,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4816,4819],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4816,4819],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":169,"column":73,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":169,"endColumn":76,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6921,6924],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6921,6924],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { Card } from '@/src/design/baseComponents/Card';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { Flex } from '@/src/design/primitives/Flex';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { View } from '@/src/design/primitives/View';\nimport { Input } from '@/src/design/baseComponents/Input';\nimport { TextArea } from '@/src/design/baseComponents/TextArea';\nimport { Question } from '@/src/entities/question';\nimport { Eye, EyeOff, Trash2, Edit, Plus, Sparkles, FileUp, Save, X, RotateCcw, Settings, MessageSquare, Loader2 } from 'lucide-react';\nimport { deleteQuestion, batchQuestions, completeQuestions } from '@/src/features/questions/api';\nimport { cn } from '@/src/shared/utils/cn';\nimport { useToast } from '@/src/shared/contexts/ToastContext';\nimport { EditRequestModal } from './EditRequestModal';\n\ninterface QuestionDraft {\n    id: string; // Existing ID or temp ID\n    questionText: string;\n    correctAnswers: string[];\n    descriptionText?: string;\n    isNew?: boolean;\n    isModified?: boolean;\n}\n\ninterface QuestionListProps {\n    questions: Question[];\n    isOwner: boolean;\n    isEditMode: boolean;\n    onToggleEditMode: () => void;\n    onQuestionDeleted: (questionId: string) => void;\n    onEditQuestion: (question: Question) => void;\n    onAddQuestion: () => void;\n    onImportCsv: () => void;\n    onSuccess: () => void;\n}\n\nexport function QuestionList({\n    questions,\n    isOwner,\n    isEditMode,\n    onToggleEditMode,\n    onQuestionDeleted,\n    onEditQuestion,\n    onAddQuestion,\n    onImportCsv,\n    onSuccess,\n}: QuestionListProps) {\n    const { showToast } = useToast();\n    const [visibleAnswers, setVisibleAnswers] = useState<Set<string>>(new Set());\n    const [allVisible, setAllVisible] = useState(false);\n    const [deletingId, setDeletingId] = useState<string | null>(null);\n    const [drafts, setDrafts] = useState<QuestionDraft[]>([]);\n    const [isSaving, setIsSaving] = useState(false);\n    const [isAutoFilling, setIsAutoFilling] = useState(false);\n    const [shouldCompleteDescription, setShouldCompleteDescription] = useState(true);\n    const [deletedIds, setDeletedIds] = useState<string[]>([]);\n    const [questionFormat, setQuestionFormat] = useState('日本語の短文');\n    const [answerFormat, setAnswerFormat] = useState('英単語');\n    const [showDetailedSettings, setShowDetailedSettings] = useState(false);\n    const [selectedQuestion, setSelectedQuestion] = useState<Question | null>(null);\n    // Initialize drafts when entering edit mode\n    useEffect(() => {\n        if (isEditMode) {\n            setDeletedIds([]);\n            setDrafts(questions.map(q => ({\n                id: q.id,\n                questionText: q.questionText,\n                correctAnswers: q.correctAnswers,\n                descriptionText: q.descriptionText,\n                isNew: false,\n                isModified: false,\n            })));\n        }\n    }, [isEditMode, questions]);\n\n    const handleBatchSave = async () => {\n        setIsSaving(true);\n        try {\n            const collectionId = questions[0]?.collectionId || (window.location.pathname.split('/').pop() as string);\n            const upsertItems = drafts.map(d => ({\n                id: d.isNew ? undefined : d.id,\n                questionText: d.questionText,\n                correctAnswers: d.correctAnswers,\n                descriptionText: d.descriptionText || null,\n            }));\n\n            await batchQuestions(collectionId, { upsertItems, deleteIds: deletedIds });\n            showToast({ message: '一括保存が完了しました', variant: 'success' });\n            onToggleEditMode();\n            onSuccess();\n        } catch (err) {\n            console.error('一括保存に失敗しました', err);\n            showToast({ message: '保存に失敗しました', variant: 'danger' });\n        } finally {\n            setIsSaving(false);\n        }\n    };\n\n    const handleAutoFill = async () => {\n        if (drafts.length === 0) return;\n        setIsAutoFilling(true);\n        try {\n            const payload = {\n                items: drafts.map(d => ({\n                    id: d.id,\n                    questionText: (d.questionText && d.questionText.trim() !== '') ? d.questionText : null,\n                    correctAnswers: (d.correctAnswers && d.correctAnswers.length > 0 && d.correctAnswers[0].trim() !== '') ? d.correctAnswers : null,\n                    descriptionText: (d.descriptionText && d.descriptionText.trim() !== '') ? d.descriptionText : null,\n                })),\n                complete_description: shouldCompleteDescription,\n                questionFormat,\n                answerFormat\n            };\n\n            const completed = await completeQuestions(payload) as any[];\n\n            // Merge back into drafts using ID to ensure correct rows\n            setDrafts(prev => prev.map((d) => {\n                const comp = completed.find(c => c.id === d.id);\n                if (!comp) return d;\n\n                const isQuestionEmpty = !d.questionText || d.questionText.trim() === '';\n                const areAnswersEmpty = !d.correctAnswers || d.correctAnswers.length === 0 || (d.correctAnswers.length === 1 && d.correctAnswers[0].trim() === '');\n                const isDescriptionEmpty = !d.descriptionText || d.descriptionText.trim() === '';\n\n                const newQuestion = comp.questionText;\n                const newAnswers = comp.correctAnswers;\n                const newDescription = comp.descriptionText;\n\n                const hasChanges = (isQuestionEmpty && newQuestion) ||\n                    (areAnswersEmpty && newAnswers) ||\n                    (isDescriptionEmpty && newDescription);\n\n                if (!hasChanges) return d;\n\n                return {\n                    ...d,\n                    questionText: isQuestionEmpty ? (newQuestion || d.questionText) : d.questionText,\n                    correctAnswers: areAnswersEmpty ? (newAnswers || d.correctAnswers) : d.correctAnswers,\n                    descriptionText: isDescriptionEmpty ? (newDescription || d.descriptionText) : d.descriptionText,\n                    isModified: true\n                };\n            }));\n\n            showToast({ message: 'AIによる補完が完了しました', variant: 'success' });\n        } catch (err) {\n            console.error('AI補完に失敗しました', err);\n            showToast({ message: '補完に失敗しました', variant: 'danger' });\n        } finally {\n            setIsAutoFilling(false);\n        }\n    };\n\n    const addEmptyRow = () => {\n        const newId = `new-${Date.now()}`;\n        setDrafts(prev => [...prev, {\n            id: newId,\n            questionText: '',\n            correctAnswers: [''],\n            descriptionText: '',\n            isNew: true,\n            isModified: true,\n        }]);\n    };\n\n    const updateDraft = (id: string, field: keyof QuestionDraft, value: any) => {\n        setDrafts(prev => prev.map(d => {\n            if (d.id === id) {\n                let finalValue = value;\n                // 解答欄の場合、セミコロンで分割\n                if (field === 'correctAnswers' && typeof value === 'string') {\n                    finalValue = value.split(';').map(s => s.trim());\n                }\n                return { ...d, [field]: finalValue, isModified: true };\n            }\n            return d;\n        }));\n    };\n\n    const removeDraft = (id: string) => {\n        const draftToRemove = drafts.find(d => d.id === id);\n        if (draftToRemove && !draftToRemove.isNew) {\n            setDeletedIds(prev => [...prev, id]);\n        }\n        setDrafts(prev => prev.filter(d => d.id !== id));\n    };\n\n    const toggleAnswer = (id: string) => {\n        setVisibleAnswers(prev => {\n            const next = new Set(prev);\n            if (next.has(id)) {\n                next.delete(id);\n            } else {\n                next.add(id);\n            }\n            return next;\n        });\n    };\n\n    const toggleAllAnswers = () => {\n        if (allVisible) {\n            setVisibleAnswers(new Set());\n        } else {\n            setVisibleAnswers(new Set(questions.map(q => q.id)));\n        }\n        setAllVisible(!allVisible);\n    };\n\n    const handleDelete = async (questionId: string) => {\n        if (!confirm('この問題を削除してもよろしいですか？')) return;\n        setDeletingId(questionId);\n        try {\n            await deleteQuestion(questionId);\n            onQuestionDeleted(questionId);\n        } catch (err) {\n            console.error('問題の削除に失敗しました', err);\n        } finally {\n            setDeletingId(null);\n        }\n    };\n\n    if (isEditMode) {\n        return (\n            <Stack gap=\"lg\">\n                <Flex justify=\"between\" align=\"center\">\n                    <Stack gap=\"xs\">\n                        <Text variant=\"h3\" weight=\"bold\">一括編集モード</Text>\n                        <Text variant=\"xs\" color=\"secondary\">変更は「保存」ボタンを押すまで確定されません。</Text>\n                    </Stack>\n                    <Flex direction=\"column\" gap=\"xs\" align=\"end\">\n                        <Flex gap=\"sm\" align=\"center\">\n                            <Button\n                                variant=\"ghost\"\n                                size=\"sm\"\n                                onClick={() => setShowDetailedSettings(!showDetailedSettings)}\n                                className={cn(\n                                    \"gap-1.5 h-8 px-2 text-xs\",\n                                    showDetailedSettings ? \"text-brand-primary bg-brand-primary/10\" : \"text-secondary\"\n                                )}\n                            >\n                                <Settings size={14} />\n                                詳細設定\n                            </Button>\n                            <Flex align=\"center\" gap=\"xs\" className=\"px-2 py-1 bg-brand-primary/5 rounded-md border border-brand-primary/10 h-8\">\n                                <input\n                                    type=\"checkbox\"\n                                    id=\"complete-desc-toggle\"\n                                    checked={shouldCompleteDescription}\n                                    onChange={(e) => setShouldCompleteDescription(e.target.checked)}\n                                    className=\"w-4 h-4 accent-brand-primary cursor-pointer\"\n                                />\n                                <label htmlFor=\"complete-desc-toggle\" className=\"text-xs text-brand-primary font-medium cursor-pointer select-none\">\n                                    解説も補完\n                                </label>\n                            </Flex>\n                            <Button\n                                variant=\"outline\"\n                                size=\"lg\"\n                                onClick={handleAutoFill}\n                                className=\"gap-1.5 border-brand-primary/30 text-brand-primary hover:bg-brand-primary/5 h-8\"\n                                loading={isAutoFilling}\n                                disabled={isSaving}\n                            >\n                                <Sparkles size={14} />\n                                AIで補完\n                            </Button>\n                            <Button\n                                variant=\"ghost\"\n                                size=\"lg\"\n                                onClick={onToggleEditMode}\n                                className=\"gap-1.5 h-8 text-xs\"\n                                disabled={isSaving || isAutoFilling}\n                            >\n                                <X size={14} />\n                                キャンセル\n                            </Button>\n                            <Button\n                                variant=\"solid\"\n                                color=\"primary\"\n                                size=\"lg\"\n                                onClick={handleBatchSave}\n                                className=\"gap-1.5 h-8 text-xs\"\n                                loading={isSaving}\n                            >\n                                <Save size={14} />\n                                変更を保存\n                            </Button>\n                        </Flex>\n\n                        {showDetailedSettings && (\n                            <Flex gap=\"sm\" className=\"bg-gray-50 p-2 rounded-lg border border-gray-200 mt-1\">\n                                <Flex direction=\"column\" gap=\"xs\">\n                                    <Text variant=\"xs\" weight=\"bold\">問題の形式</Text>\n                                    <Input\n                                        size=\"sm\"\n                                        value={questionFormat}\n                                        onChange={(e) => setQuestionFormat(e.target.value)}\n                                        placeholder=\"例: 日本語の短い単語\"\n                                        className=\"w-40 h-7 text-[10px]\"\n                                    />\n                                </Flex>\n                                <Flex direction=\"column\" gap=\"xs\">\n                                    <Text variant=\"xs\" weight=\"bold\">解答の形式</Text>\n                                    <Input\n                                        size=\"sm\"\n                                        value={answerFormat}\n                                        onChange={(e) => setAnswerFormat(e.target.value)}\n                                        placeholder=\"例: 英単語\"\n                                        className=\"w-40 h-7 text-[10px]\"\n                                    />\n                                </Flex>\n                            </Flex>\n                        )}\n                    </Flex>\n                </Flex>\n\n                <Card padding=\"none\" className=\"overflow-hidden border border-brand-primary/20\">\n                    <View className=\"overflow-x-auto\">\n                        <table className=\"w-full text-left border-collapse\">\n                            <thead>\n                                <tr className=\"bg-brand-primary/5 border-b border-brand-primary/10\">\n                                    <th className=\"p-3 text-xs font-bold text-secondary w-12 text-center\">#</th>\n                                    <th className=\"p-3 text-xs font-bold text-secondary min-w-[300px]\">問題文</th>\n                                    <th className=\"p-3 text-xs font-bold text-secondary min-w-[200px]\">解答 (セミコロン区切りで複数可)</th>\n                                    <th className=\"p-3 text-xs font-bold text-secondary min-w-[200px]\">解説 (任意)</th>\n                                    <th className=\"p-3 text-xs font-bold text-secondary w-12\"></th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                {drafts.map((draft, index) => (\n                                    <tr key={draft.id} className={cn(\n                                        \"border-b border-gray-100 hover:bg-gray-50/50 transition-colors\",\n                                        (draft.isModified || draft.isNew) && \"bg-brand-primary/[0.02]\"\n                                    )}>\n                                        <td className=\"p-3 text-center\">\n                                            <Text\n                                                variant=\"xs\"\n                                                weight=\"bold\"\n                                                className={cn(\n                                                    (draft.isModified || draft.isNew) ? \"text-brand-primary\" : \"text-secondary\"\n                                                )}\n                                            >\n                                                {index + 1}\n                                            </Text>\n                                        </td>\n                                        <td className=\"p-2\">\n                                            <TextArea\n                                                value={draft.questionText}\n                                                onChange={(e) => updateDraft(draft.id, 'questionText', e.target.value)}\n                                                placeholder=\"問題を入力...\"\n                                                className=\"min-h-[60px] text-sm border-transparent hover:border-gray-200 focus:border-brand-primary/30\"\n                                            />\n                                        </td>\n                                        <td className=\"p-2\">\n                                            <Input\n                                                value={(draft.correctAnswers || []).join(';')}\n                                                onChange={(e) => updateDraft(draft.id, 'correctAnswers', e.target.value.split(';'))}\n                                                placeholder=\"解答を入力...\"\n                                                className=\"text-sm border-transparent hover:border-gray-200 focus:border-brand-primary/30\"\n                                            />\n                                        </td>\n                                        <td className=\"p-2\">\n                                            <TextArea\n                                                value={draft.descriptionText || ''}\n                                                onChange={(e) => updateDraft(draft.id, 'descriptionText', e.target.value)}\n                                                placeholder=\"解説を入力...\"\n                                                className=\"min-h-[60px] text-sm border-transparent hover:border-gray-200 focus:border-brand-primary/30\"\n                                            />\n                                        </td>\n                                        <td className=\"p-2\">\n                                            <Button\n                                                variant=\"ghost\"\n                                                size=\"sm\"\n                                                onClick={() => removeDraft(draft.id)}\n                                                className=\"text-gray-400 hover:text-brand-danger\"\n                                            >\n                                                <Trash2 size={16} />\n                                            </Button>\n                                        </td>\n                                    </tr>\n                                ))}\n                            </tbody>\n                        </table>\n                    </View>\n                    <View className=\"p-4 bg-gray-50/50 border-t border-gray-100\">\n                        <Button\n                            variant=\"ghost\"\n                            size=\"md\"\n                            onClick={addEmptyRow}\n                            className=\"w-full border border-dashed border-gray-300 hover:border-brand-primary/50 text-secondary hover:text-brand-primary gap-2\"\n                        >\n                            <Plus size={16} />\n                            新しい行を追加\n                        </Button>\n                    </View>\n                </Card>\n            </Stack >\n        );\n    }\n\n    return (\n        <Stack gap=\"lg\">\n            <Flex justify=\"between\" align=\"center\">\n                <Text variant=\"h3\" weight=\"bold\">問題一覧 ({questions.length})</Text>\n                <Flex gap=\"sm\">\n                    <Button\n                        variant=\"ghost\"\n                        size=\"lg\"\n                        onClick={toggleAllAnswers}\n                        className=\"gap-1.5 text-foreground/60\"\n                    >\n                        {allVisible ? <EyeOff size={16} /> : <Eye size={16} />}\n                        {allVisible ? '全て隠す' : '全て表示'}\n                    </Button>\n                    {isOwner && (\n                        <>\n                            <Button\n                                variant=\"outline\"\n                                size=\"lg\"\n                                onClick={onToggleEditMode}\n                                className=\"gap-1.5 border-gray-200\"\n                            >\n                                <Edit size={16} />\n                                編集モード\n                            </Button>\n                            <Button\n                                variant=\"outline\"\n                                size=\"lg\"\n                                onClick={onImportCsv}\n                                className=\"gap-1.5 border-gray-200\"\n                            >\n                                <FileUp size={16} />\n                                CSVインポート\n                            </Button>\n                            <Button\n                                variant=\"solid\" color=\"primary\"\n                                size=\"lg\"\n                                onClick={onAddQuestion}\n                                className=\"gap-1.5\"\n                            >\n                                <Plus size={16} />\n                                問題を追加\n                            </Button>\n                        </>\n                    )}\n                </Flex>\n            </Flex>\n\n            {questions.length === 0 ? (\n                <Card className=\"border border-dashed border-gray-300 bg-gray-50/30\">\n                    <View className=\"py-16 px-6 text-center\">\n                        <Stack gap=\"lg\" align=\"center\">\n                            <View className=\"bg-brand-primary/10 p-4 rounded-2xl\">\n                                <Sparkles size={48} className=\"text-brand-primary animate-pulse\" />\n                            </View>\n\n                            <Stack gap=\"sm\">\n                                <Text variant=\"h2\" weight=\"bold\">コレクションはまだ空です</Text>\n                                <Text color=\"secondary\" className=\"max-w-sm mx-auto\">\n                                    上のバーを使ってAIに問題を生成させるか、下のボタンから手動で追加してください。\n                                </Text>\n                            </Stack>\n\n                            {isOwner && (\n                                <Flex gap=\"md\" className=\"w-full max-w-xs justify-center\">\n                                    <Button\n                                        variant=\"outline\"\n                                        size=\"lg\"\n                                        onClick={onAddQuestion}\n                                        className=\"gap-2\"\n                                    >\n                                        <Plus size={18} />\n                                        手動で追加\n                                    </Button>\n                                    <Button\n                                        variant=\"outline\"\n                                        size=\"lg\"\n                                        onClick={onToggleEditMode}\n                                        className=\"gap-2\"\n                                    >\n                                        <Edit size={18} />\n                                        編集モード\n                                    </Button>\n                                    <Button\n                                        variant=\"ghost\"\n                                        size=\"lg\"\n                                        onClick={onImportCsv}\n                                        className=\"gap-2\"\n                                    >\n                                        <FileUp size={18} />\n                                        CSV\n                                    </Button>\n                                </Flex>\n                            )}\n                        </Stack>\n                    </View>\n                </Card>\n            ) : (\n                <Stack gap=\"md\">\n                    {questions.map((question, index) => {\n                        const isVisible = visibleAnswers.has(question.id);\n                        const isDeleting = deletingId === question.id;\n\n                        return (\n                            <Card\n                                key={question.id}\n                                padding=\"md\"\n                                className={cn(\n                                    \"border border-gray-300 transition-all\",\n                                    isDeleting && \"opacity-50\"\n                                )}\n                            >\n                                <Stack gap=\"md\">\n                                    <Flex justify=\"between\" align=\"start\">\n                                        <Flex gap=\"sm\" align=\"start\" className=\"flex-1\">\n                                            <Text\n                                                variant=\"xs\"\n                                                weight=\"bold\"\n                                                className=\"bg-brand-primary text-white rounded-full w-7 h-7 flex items-center justify-center shrink-0 mt-0.5\"\n                                            >\n                                                {index + 1}\n                                            </Text>\n                                            <Text weight=\"medium\" className=\"flex-1\">\n                                                {question.questionText}\n                                            </Text>\n                                        </Flex>\n\n                                        <Flex gap=\"xs\" className=\"shrink-0 ml-2\">\n                                            <Button\n                                                variant=\"ghost\"\n                                                size=\"sm\"\n                                                onClick={() => toggleAnswer(question.id)}\n                                                className=\"p-1.5 h-auto text-foreground/50\"\n                                                title={isVisible ? '答えを隠す' : '答えを表示'}\n                                            >\n                                                {isVisible ? <EyeOff size={16} /> : <Eye size={16} />}\n                                            </Button>\n                                            {!isOwner && (\n                                                <Button\n                                                    variant=\"ghost\"\n                                                    size=\"sm\"\n                                                    onClick={() => setSelectedQuestion(question)}\n                                                    className=\"p-1.5 h-auto text-brand-primary\"\n                                                    title=\"修正を提案\"\n                                                >\n                                                    <MessageSquare size={16} />\n                                                </Button>\n                                            )}\n                                            {isOwner && (\n                                                <>\n                                                    <Button\n                                                        variant=\"ghost\"\n                                                        size=\"sm\"\n                                                        onClick={() => onEditQuestion(question)}\n                                                        className=\"p-1.5 h-auto text-brand-primary\"\n                                                        title=\"編集\"\n                                                    >\n                                                        <Edit size={16} />\n                                                    </Button>\n                                                    <Button\n                                                        variant=\"ghost\"\n                                                        size=\"sm\"\n                                                        onClick={() => handleDelete(question.id)}\n                                                        className=\"p-1.5 h-auto text-brand-danger\"\n                                                        title=\"削除\"\n                                                        disabled={isDeleting}\n                                                    >\n                                                        <Trash2 size={16} />\n                                                    </Button>\n                                                </>\n                                            )}\n                                        </Flex>\n                                    </Flex>\n\n                                    {isVisible && (\n                                        <View className=\"border-t border-surface-muted-border pt-3\">\n                                            <Stack gap=\"xs\">\n                                                <Flex gap=\"sm\" align=\"start\">\n                                                    <Text variant=\"xs\" weight=\"bold\" color=\"primary\" className=\"shrink-0\">\n                                                        答え:\n                                                    </Text>\n                                                    <Text variant=\"detail\" weight=\"bold\" color=\"primary\">\n                                                        {(question.correctAnswers || []).join(' / ')}\n                                                    </Text>\n                                                </Flex>\n                                                {question.descriptionText && (\n                                                    <Flex gap=\"sm\" align=\"start\">\n                                                        <Text variant=\"xs\" color=\"secondary\" className=\"shrink-0\">\n                                                            解説:\n                                                        </Text>\n                                                        <Text variant=\"xs\" color=\"secondary\" className=\"leading-relaxed\">\n                                                            {question.descriptionText}\n                                                        </Text>\n                                                    </Flex>\n                                                )}\n                                            </Stack>\n                                        </View>\n                                    )}\n                                </Stack>\n                            </Card>\n                        );\n                    })}\n                </Stack>\n            )}\n\n            {selectedQuestion && (\n                <EditRequestModal\n                    question={selectedQuestion}\n                    onClose={() => setSelectedQuestion(null)}\n                />\n            )}\n        </Stack>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/quiz/api/index.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'RankingAnswerResponse' is defined but never used.","line":9,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":26,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"RankingAnswerResponse"},"fix":{"range":[188,215],"text":""},"desc":"Remove unused variable \"RankingAnswerResponse\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { apiClient } from '@/src/shared/api/apiClient';\nimport {\n    QuizRequest,\n    QuizStartResponse,\n    AnswerRequest,\n    CasualQuiz,\n    QuizResumeResponse,\n    RankingAnswerRequest,\n    RankingAnswerResponse,\n} from '@/src/entities/quiz';\n\n/**\n * カジュアルクイズを開始\n * フロントエンドの camelCase を バックエンドの snake_case に変換して送信\n */\nexport const startCasualQuiz = async (data: QuizRequest): Promise<QuizStartResponse> => {\n    return await apiClient<QuizStartResponse>('/quiz/start', {\n        method: 'POST',\n        body: JSON.stringify({\n            collectionIds: data.collectionIds,\n            collectionSetId: data.collectionSetId,\n            filterTypes: data.filters.map(f => f.type),\n            sortKeys: data.sorts.map(s => s.key),\n            totalQuestions: data.limit,\n        }),\n        authenticated: true,\n    });\n};\n\n/**\n * ランキングクイズを開始\n */\nexport const startRankingQuiz = async (collectionId: string): Promise<QuizStartResponse> => {\n    return await apiClient<QuizStartResponse>('/ranking-quiz/start', {\n        method: 'POST',\n        body: JSON.stringify({ collectionId }),\n        authenticated: true,\n    });\n};\n\n/**\n * クイズの回答を送信\n */\nexport const submitAnswer = async (quizId: string, data: AnswerRequest): Promise<void> => {\n    await apiClient<void>(`/quiz/${quizId}/submit`, {\n        method: 'POST',\n        body: JSON.stringify(data),\n        authenticated: true,\n    });\n};\n\n/**\n * 再開可能なクイズ一覧を取得\n */\nexport const getResumableQuizzes = async (): Promise<CasualQuiz[]> => {\n    return await apiClient<CasualQuiz[]>('/quiz/resumes', {\n        authenticated: true,\n    });\n};\n\n/**\n * クイズを再開\n */\nexport const resumeQuiz = async (quizId: string): Promise<QuizResumeResponse> => {\n    return await apiClient<QuizResumeResponse>(`/quiz/${quizId}/resume`, {\n        authenticated: true,\n    });\n};\n\n/**\n * ランキングクイズの回答を一括送信\n */\nexport const submitRankingAllAnswers = async (quizId: string, answers: RankingAnswerRequest[]): Promise<RankingQuizResultDto> => {\n    return await apiClient<RankingQuizResultDto>(`/ranking-quiz/${quizId}/submit-all`, {\n        method: 'POST',\n        body: JSON.stringify({ answers }),\n        authenticated: true,\n    });\n};\n\n/**\n * リーダーボードを取得\n */\nexport const getLeaderboard = async (collectionId: string): Promise<LeaderboardResponse> => {\n    return await apiClient<LeaderboardResponse>(`/collections/${collectionId}/leaderboard`, {\n        authenticated: true,\n    });\n};\n\nexport interface RankingAnswerResultDto {\n    questionId: string;\n    isCorrect: boolean;\n    correctAnswer: string; // This is the joined string for display\n}\n\nexport interface RankingQuizResultDto {\n    quizId: string;\n    collectionId: string;\n    score: number;\n    correctCount: number;\n    totalQuestions: number;\n    totalTimeMillis: number;\n    completedAt: string;\n    rank?: number;\n    detailedResults: RankingAnswerResultDto[];\n}\n\nexport interface LeaderboardEntry {\n    userId: string;\n    username: string;\n    iconUrl?: string;\n    score: number;\n    rank: number;\n}\n\nexport interface LeaderboardResponse {\n    collectionId: string;\n    entries: LeaderboardEntry[];\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/quiz/components/QuizForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/quiz/components/QuizOptionModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Card' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":14,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Card"},"fix":{"range":[56,113],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'View' is defined but never used.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":14,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"View"},"fix":{"range":[339,392],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'X' is defined but never used.","line":10,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":11,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"X"},"fix":{"range":[401,403],"text":""},"desc":"Remove unused variable \"X\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SlidersHorizontal' is defined but never used.","line":10,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":30,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"SlidersHorizontal"},"fix":{"range":[402,421],"text":""},"desc":"Remove unused variable \"SlidersHorizontal\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Shuffle' is defined but never used.","line":10,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":39,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Shuffle"},"fix":{"range":[421,430],"text":""},"desc":"Remove unused variable \"Shuffle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowDownUp' is defined but never used.","line":10,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":52,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowDownUp"},"fix":{"range":[430,443],"text":""},"desc":"Remove unused variable \"ArrowDownUp\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Hash' is defined but never used.","line":10,"column":54,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":58,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Hash"},"fix":{"range":[443,449],"text":""},"desc":"Remove unused variable \"Hash\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Swords' is defined but never used.","line":10,"column":66,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":72,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Swords"},"fix":{"range":[455,463],"text":""},"desc":"Remove unused variable \"Swords\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState } from 'react';\nimport { Card } from '@/src/design/baseComponents/Card';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { Flex } from '@/src/design/primitives/Flex';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { View } from '@/src/design/primitives/View';\nimport { X, SlidersHorizontal, Shuffle, ArrowDownUp, Hash, Play, Swords } from 'lucide-react';\nimport { Modal } from '@/src/design/baseComponents/Modal';\nimport { FilterCondition, SortCondition } from '@/src/entities/quiz';\nimport { QuizOptions } from './QuizOptions';\n\ninterface QuizOptionModalProps {\n    selectedCount: number;\n    onStart: (filters: FilterCondition[], sorts: SortCondition[], limit: number) => void;\n    onCancel: () => void;\n    loading?: boolean;\n}\n\nexport function QuizOptionModal({ selectedCount, onStart, onCancel, loading }: QuizOptionModalProps) {\n    const [filters, setFilters] = useState<FilterCondition[]>([]);\n    const [sorts, setSorts] = useState<SortCondition[]>([]);\n    const [limit, setLimit] = useState(10);\n\n    return (\n        <Modal\n            isOpen={true}\n            onClose={onCancel}\n            title=\"クイズ条件の設定\"\n            size=\"lg\"\n            footer={\n                <Flex gap=\"sm\" justify=\"end\" className=\"flex-wrap\">\n                    <Button variant=\"outline\" onClick={onCancel} className=\"flex-1 sm:flex-none\">\n                        キャンセル\n                    </Button>\n                    <Button\n                        variant=\"solid\"\n                        color=\"primary\"\n                        onClick={() => onStart(filters, sorts, limit)}\n                        disabled={loading}\n                        className=\"gap-2 flex-1 sm:flex-none\"\n                    >\n                        <Play size={16} fill=\"currentColor\" />\n                        {loading ? '開始中...' : 'クイズ開始'}\n                    </Button>\n                </Flex>\n            }\n        >\n            <Stack gap=\"xl\">\n                <Text variant=\"xs\" color=\"secondary\">\n                    {selectedCount} 個のコレクションが選択されています\n                </Text>\n\n                <QuizOptions\n                    filters={filters}\n                    sorts={sorts}\n                    limit={limit}\n                    onFilterChange={setFilters}\n                    onSortChange={setSorts}\n                    onLimitChange={setLimit}\n                />\n            </Stack>\n        </Modal>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/quiz/components/QuizOptions.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'BookOpen' is defined but never used.","line":9,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":46,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"BookOpen"},"fix":{"range":[356,366],"text":""},"desc":"Remove unused variable \"BookOpen\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React from 'react';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { Flex } from '@/src/design/primitives/Flex';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { View } from '@/src/design/primitives/View';\nimport { Shuffle, ArrowDownUp, Hash, BookOpen } from 'lucide-react';\nimport { Range as BaseRange } from '@/src/design/baseComponents/Range';\nimport {\n    FilterType,\n    SortKey,\n    FilterCondition,\n    SortCondition,\n    filterTypeLabels,\n    sortKeyLabels,\n} from '@/src/entities/quiz';\n\ninterface QuizOptionsProps {\n    filters: FilterCondition[];\n    sorts: SortCondition[];\n    limit: number;\n    maxLimit?: number;\n    onFilterChange: (filters: FilterCondition[]) => void;\n    onSortChange: (sorts: SortCondition[]) => void;\n    onLimitChange: (limit: number) => void;\n    compact?: boolean;\n}\n\nexport function QuizOptions({\n    filters,\n    sorts,\n    limit,\n    maxLimit = 50,\n    onFilterChange,\n    onSortChange,\n    onLimitChange,\n    compact = false,\n}: QuizOptionsProps) {\n    const toggleFilter = (type: FilterType) => {\n        const exists = filters.find(f => f.type === type);\n        if (exists) {\n            onFilterChange(filters.filter(f => f.type !== type));\n        } else {\n            onFilterChange([...filters, { type }]);\n        }\n    };\n\n    const toggleSort = (key: SortKey) => {\n        const exists = sorts.find(s => s.key === key);\n        if (exists) {\n            onSortChange(sorts.filter(s => s.key !== key));\n        } else {\n            onSortChange([...sorts, { key }]);\n        }\n    };\n\n    return (\n        <Stack gap={compact ? \"md\" : \"xl\"}>\n            {/* フィルター */}\n            <Stack gap=\"sm\">\n                <Flex gap=\"xs\" align=\"center\">\n                    <Shuffle size={16} className=\"text-foreground/60\" />\n                    <Text variant=\"detail\" weight=\"bold\">フィルター</Text>\n                </Flex>\n                <Flex gap=\"sm\" className=\"flex-wrap\">\n                    {Object.entries(filterTypeLabels).map(([key, label]) => {\n                        const isActive = filters.some(f => f.type === key);\n                        return (\n                            <Button\n                                key={key}\n                                variant={isActive ? \"solid\" : \"outline\"}\n                                color={isActive ? \"primary\" : undefined}\n                                size=\"sm\"\n                                onClick={() => toggleFilter(key as FilterType)}\n                            >\n                                {label}\n                            </Button>\n                        );\n                    })}\n                </Flex>\n            </Stack>\n\n            {/* ソート */}\n            <Stack gap=\"sm\">\n                <Flex gap=\"xs\" align=\"center\">\n                    <ArrowDownUp size={16} className=\"text-foreground/60\" />\n                    <Text variant=\"detail\" weight=\"bold\">ソート</Text>\n                </Flex>\n                <Flex gap=\"sm\" className=\"flex-wrap\">\n                    {Object.entries(sortKeyLabels).map(([key, label]) => {\n                        const isActive = sorts.some(s => s.key === key);\n                        return (\n                            <Button\n                                key={key}\n                                variant={isActive ? \"solid\" : \"outline\"}\n                                color={isActive ? \"primary\" : undefined}\n                                size=\"sm\"\n                                onClick={() => toggleSort(key as SortKey)}\n                            >\n                                {label}\n                            </Button>\n                        );\n                    })}\n                </Flex>\n            </Stack>\n\n            {/* 問題数 */}\n            <Stack gap=\"sm\">\n                <Flex justify=\"between\" align=\"center\">\n                    <Flex gap=\"xs\" align=\"center\">\n                        <Hash size={16} className=\"text-foreground/60\" />\n                        <Text variant=\"detail\" weight=\"bold\">問題数</Text>\n                    </Flex>\n                    <Text variant=\"detail\" weight=\"bold\">{limit}問</Text>\n                </Flex>\n                <View className=\"px-2\">\n                    <BaseRange\n                        min={1}\n                        max={maxLimit}\n                        value={Math.min(limit, maxLimit)}\n                        onChange={(e: React.ChangeEvent<HTMLInputElement>) => onLimitChange(parseInt(e.target.value))}\n                    />\n                    <Flex justify=\"between\" className=\"mt-1\">\n                        <Text variant=\"xs\" color=\"secondary\">1</Text>\n                        <Text variant=\"xs\" color=\"secondary\">{maxLimit}</Text>\n                    </Flex>\n                </View>\n            </Stack>\n        </Stack>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/quiz/components/QuizOptionsModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/quiz/components/Result.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/quiz/components/ResumeQuizList.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":16,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Button"},"fix":{"range":[306,367],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useEffect, useState } from 'react';\nimport { getResumableQuizzes, resumeQuiz } from '@/src/features/quiz/api';\nimport { CasualQuiz } from '@/src/entities/quiz';\nimport { Card } from '@/src/design/baseComponents/Card';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { View } from '@/src/design/primitives/View';\nimport { Flex } from '@/src/design/primitives/Flex';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { PlayCircle, History, ChevronRight } from 'lucide-react';\nimport { useRouter } from 'next/navigation';\nimport { Spinner } from '@/src/design/baseComponents/Spinner';\nimport { cn } from '@/src/shared/utils/cn';\nimport { SectionHeader } from '@/src/shared/components/SectionHeader';\nimport { Grid } from '@/src/design/primitives/Grid';\n\n/**\n * 中断されたクイズの一覧を表示し、再開できるようにするコンポーネントです。\n */\nexport function ResumeQuizList() {\n    const [quizzes, setQuizzes] = useState<CasualQuiz[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [isResuming, setIsResuming] = useState<string | null>(null);\n    const router = useRouter();\n\n    useEffect(() => {\n        const fetchQuizzes = async () => {\n            try {\n                const data = await getResumableQuizzes();\n                // 日付順（新しい順）に並べ替え\n                const sorted = [...data].sort((a, b) =>\n                    new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime()\n                );\n                setQuizzes(sorted);\n            } catch (err) {\n                console.error('Failed to fetch resumable quizzes', err);\n            } finally {\n                setLoading(false);\n            }\n        };\n        fetchQuizzes();\n    }, []);\n\n    const handleResume = async (quizId: string) => {\n        setIsResuming(quizId);\n        try {\n            const resp = await resumeQuiz(quizId);\n            if (typeof window !== 'undefined') {\n                sessionStorage.setItem('quizData', JSON.stringify(resp));\n            }\n            router.push('/quiz');\n        } catch (err) {\n            console.error('Failed to resume quiz', err);\n            setIsResuming(null);\n        }\n    };\n\n    if (loading) return (\n        <Flex justify=\"center\" className=\"py-8\">\n            <Spinner size=\"sm\" />\n        </Flex>\n    );\n\n    if (quizzes.length === 0) return null;\n\n    return (\n        <Stack gap=\"lg\">\n            <SectionHeader\n                icon={History}\n                title=\"学習を再開する\"\n                description={`中断したクイズが ${quizzes.length} 件あります`}\n            />\n\n            <Grid cols={{ sm: 1, md: 2 }} gap=\"md\">\n                {quizzes.map((quiz) => {\n                    const progress = Math.round((quiz.answeredQuestionIds.length / quiz.totalQuestions) * 100);\n\n                    return (\n                        <Card\n                            key={quiz.id}\n                            className=\"p-1 border-brand-primary/10 bg-surface-primary hover:border-brand-primary/30 transition-all hover:shadow-md group\"\n                        >\n                            <Stack gap=\"none\">\n                                <View className=\"p-4\">\n                                    <Stack gap=\"xs\">\n                                        <Text weight=\"bold\" variant=\"detail\" className=\"line-clamp-1 group-hover:text-brand-primary transition-colors\">\n                                            {quiz.collectionNames.join(', ')}\n                                        </Text>\n                                        <Flex justify=\"between\" align=\"center\">\n                                            <Text variant=\"xs\" color=\"secondary\" weight=\"medium\">\n                                                進捗: {quiz.answeredQuestionIds.length} / {quiz.totalQuestions} 問\n                                            </Text>\n                                            <Text variant=\"xs\" color=\"primary\" weight=\"bold\">\n                                                {progress}%\n                                            </Text>\n                                        </Flex>\n                                        {/* プログレスバー */}\n                                        <View className=\"w-full h-1.5 bg-gray-100 rounded-full overflow-hidden mt-1\">\n                                            <View\n                                                className=\"h-full bg-brand-primary transition-all duration-500\"\n                                                style={{ width: `${progress}%` }}\n                                            />\n                                        </View>\n                                    </Stack>\n                                </View>\n\n                                <View\n                                    as=\"button\"\n                                    onClick={() => handleResume(quiz.id)}\n                                    disabled={!!isResuming}\n                                    className={cn(\n                                        \"w-full py-3 px-4 flex items-center justify-between text-brand-primary bg-brand-primary/5 hover:bg-brand-primary/10 transition-colors border-t border-brand-primary/5\",\n                                        isResuming === quiz.id && \"opacity-70 cursor-wait\"\n                                    )}\n                                >\n                                    <Flex gap=\"sm\" align=\"center\">\n                                        <PlayCircle size={18} />\n                                        <Text variant=\"xs\" weight=\"bold\">\n                                            {isResuming === quiz.id ? '再開中...' : 'つづきから'}\n                                        </Text>\n                                    </Flex>\n                                    <ChevronRight size={16} className=\"group-hover:translate-x-1 transition-transform\" />\n                                </View>\n                            </Stack>\n                        </Card>\n                    );\n                })}\n            </Grid >\n        </Stack>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/quiz/components/ResumeQuizSummary.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Spinner' is defined but never used.","line":11,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":17,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Spinner"},"fix":{"range":[446,509],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useEffect, useState } from 'react';\nimport { getResumableQuizzes } from '@/src/features/quiz/api';\nimport { CasualQuiz } from '@/src/entities/quiz';\nimport { Card } from '@/src/design/baseComponents/Card';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Flex } from '@/src/design/primitives/Flex';\nimport { History, ChevronRight } from 'lucide-react';\nimport { useRouter } from 'next/navigation';\nimport { Spinner } from '@/src/design/baseComponents/Spinner';\nimport { View } from '@/src/design/primitives/View';\n\nexport function ResumeQuizSummary() {\n    const [quizzes, setQuizzes] = useState<CasualQuiz[]>([]);\n    const [loading, setLoading] = useState(true);\n    const router = useRouter();\n\n    useEffect(() => {\n        const fetchQuizzes = async () => {\n            try {\n                const data = await getResumableQuizzes();\n                // 日付順にソート\n                const sorted = [...data].sort((a, b) =>\n                    new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime()\n                );\n                setQuizzes(sorted);\n            } catch (err) {\n                console.error('Failed to fetch resumable quizzes', err);\n            } finally {\n                setLoading(false);\n            }\n        };\n        fetchQuizzes();\n    }, []);\n\n    if (loading) return null;\n    if (quizzes.length === 0) return null;\n\n    const latest = quizzes[0];\n    const otherCount = quizzes.length - 1;\n\n    return (\n        <Card\n            onClick={() => router.push('/quiz/resume')}\n            className=\"cursor-pointer hover:bg-surface-primary transition-colors border-brand-primary/20 bg-brand-primary/[0.02]\"\n            padding=\"sm\"\n        >\n            <Flex justify=\"between\" align=\"center\" className=\"px-2\">\n                <Flex gap=\"sm\" align=\"center\" className=\"min-w-0 flex-1\">\n                    <View className=\"bg-brand-primary/10 p-2 rounded-full text-brand-primary flex-shrink-0\">\n                        <History size={18} />\n                    </View>\n                    <View className=\"min-w-0 flex-1\">\n                        <Text variant=\"detail\" weight=\"bold\" className=\"line-clamp-1\">\n                            {latest.collectionNames.join(', ')} <Text span color=\"secondary\" weight=\"medium\">({latest.answeredQuestionIds.length}/{latest.totalQuestions})</Text>\n                            {otherCount > 0 && (\n                                <Text span color=\"primary\" weight=\"bold\" className=\"ml-2\">\n                                    他 {otherCount} 件\n                                </Text>\n                            )}\n                        </Text>\n                    </View>\n                </Flex>\n                <ChevronRight size={18} className=\"text-secondary opacity-30 flex-shrink-0 ml-2\" />\n            </Flex>\n        </Card>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/quiz/components/SelectionTray.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'cn' is defined but never used.","line":11,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":12,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"cn"},"fix":{"range":[439,483],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React from 'react';\nimport { View } from '@/src/design/primitives/View';\nimport { Flex } from '@/src/design/primitives/Flex';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { Badge } from '@/src/design/baseComponents/Badge';\nimport { X, Play, Trash2, Settings2 } from 'lucide-react';\nimport { cn } from '@/src/shared/utils/cn';\n\ninterface SelectedCollection {\n    id: string;\n    name: string;\n}\n\ninterface SelectionTrayProps {\n    selectedCollections: SelectedCollection[];\n    onRemove: (id: string) => void;\n    onClear: () => void;\n    onStart: () => void;\n    onCancel: () => void;\n}\n\n/**\n * クイズ選択モード中に画面下部に表示される、選択済みコレクションの管理トレイです。\n */\nexport function SelectionTray({\n    selectedCollections,\n    onRemove,\n    onClear,\n    onStart,\n    onCancel,\n}: SelectionTrayProps) {\n    if (selectedCollections.length === 0) {\n        return (\n            <div className=\"fixed bottom-0 left-0 right-0 z-50 p-6 animate-in fade-in slide-in-from-bottom-4 duration-300\">\n                <View className=\"max-w-2xl mx-auto bg-surface-primary/90 backdrop-blur-md border border-gray-200 shadow-2xl rounded-2xl p-4\">\n                    <Flex justify=\"between\" align=\"center\">\n                        <Text color=\"secondary\" variant=\"xs\">クイズに含めるコレクションをカードから選択してください</Text>\n                        <Button variant=\"ghost\" size=\"sm\" onClick={onCancel} className=\"text-secondary hover:text-primary\">\n                            選択モードを終了\n                        </Button>\n                    </Flex>\n                </View>\n            </div>\n        );\n    }\n\n    return (\n        <View\n            zIndex=\"sticky\"\n            className=\"fixed bottom-0 left-0 right-0 p-4 md:p-6 animate-in fade-in slide-in-from-bottom-8 duration-300\"\n        >\n            <View className=\"max-w-4xl mx-auto bg-surface-primary/95 backdrop-blur-md border border-brand-primary/20 shadow-2xl rounded-2xl overflow-hidden\">\n                <Stack gap=\"none\">\n                    <Flex justify=\"between\" align=\"center\" className=\"px-6 py-3 bg-brand-primary/5 border-b border-brand-primary/10\">\n                        <Flex gap=\"sm\" align=\"center\">\n                            <div className=\"w-8 h-8 rounded-full bg-brand-primary/20 flex items-center justify-center text-brand-primary\">\n                                <Play size={16} fill=\"currentColor\" />\n                            </div>\n                            <Stack gap=\"none\">\n                                <Text weight=\"bold\" variant=\"detail\" className=\"text-brand-primary\">\n                                    クイズの準備中\n                                </Text>\n                                <Text variant=\"xs\" color=\"secondary\" className=\"font-medium\">\n                                    {selectedCollections.length} 個のコレクションを選択済み\n                                </Text>\n                            </Stack>\n                        </Flex>\n                        <Button variant=\"ghost\" size=\"sm\" onClick={onCancel} className=\"text-secondary hover:text-brand-primary group\">\n                            <X size={18} className=\"transition-transform group-hover:rotate-90\" />\n                        </Button>\n                    </Flex>\n\n                    <div className=\"px-6 py-4 max-h-32 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-200 bg-surface-primary\">\n                        <Flex gap=\"xs\" wrap>\n                            {selectedCollections.map((col) => (\n                                <Badge\n                                    key={col.id}\n                                    variant=\"primary\"\n                                    className=\"pl-3 pr-1 py-1 gap-1 group/badge animate-in zoom-in-95 duration-200 bg-brand-primary/10 border border-brand-primary/20\"\n                                >\n                                    <Text variant=\"xs\" className=\"max-w-[150px] truncate text-brand-primary font-bold\">{col.name}</Text>\n                                    <button\n                                        onClick={() => onRemove(col.id)}\n                                        className=\"p-1 rounded-full hover:bg-brand-primary/20 transition-colors text-brand-primary/60 hover:text-brand-primary\"\n                                        title=\"選択解除\"\n                                    >\n                                        <X size={14} />\n                                    </button>\n                                </Badge>\n                            ))}\n                        </Flex>\n                    </div>\n\n                    <Flex justify=\"between\" align=\"center\" className=\"px-6 py-4 bg-surface-muted/30 border-t border-gray-100\">\n                        <Button variant=\"ghost\" size=\"sm\" onClick={onClear} className=\"text-status-danger hover:bg-status-danger/5 gap-2 transition-colors\">\n                            <Trash2 size={16} />\n                            全てクリア\n                        </Button>\n                        <Button\n                            onClick={onStart}\n                            disabled={selectedCollections.length === 0}\n                            className=\"px-8 shadow-lg shadow-brand-primary/20 gap-2 h-11\"\n                        >\n                            <Settings2 size={18} />\n                            クイズ詳細設定へ進む\n                        </Button>\n                    </Flex>\n                </Stack>\n            </View>\n        </View>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/users/components/UserCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/users/components/UserContentTabs.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'user' is assigned a value but never used.","line":53,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":53,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React from 'react';\nimport { View } from '@/src/design/primitives/View';\nimport { Flex } from '@/src/design/primitives/Flex';\nimport { Stack } from '@/src/design/primitives/Stack';\nimport { Tabs, TabItem } from '@/src/design/baseComponents/Tabs';\nimport { Spinner } from '@/src/design/baseComponents/Spinner';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Grid } from '@/src/design/primitives/Grid';\nimport { useUserCollections, useUserCollectionSets } from '@/src/features/collections/hooks/useCollections';\nimport { CollectionCard } from '@/src/features/collections/components/CollectionCard';\nimport { CollectionSetCard } from '@/src/features/collectionSets/components/CollectionSetCard';\nimport { useAuth } from '@/src/shared/auth/useAuth';\n\ninterface UserContentTabsProps {\n    userId: string;\n    isSelectionMode?: boolean;\n    selectedIds?: string[];\n    onToggleCollection: (id: string, name: string, count?: number) => void;\n\n    // Management props (Optional, for profile page)\n    onDeleteCollection?: (id: string) => void;\n    onEditCollection?: (id: string) => void;\n    onStartRanking?: (id: string) => void;\n    onAddToSet?: (id: string) => void;\n    onDeleteSet?: (id: string) => void;\n    onEditSet?: (id: string) => void;\n\n    // Slots for extra actions (like \"Create\" buttons)\n    collectionActions?: React.ReactNode;\n    setActions?: React.ReactNode;\n    initialTab?: 'collections' | 'sets';\n    hideExtras?: boolean;\n}\n\nexport function UserContentTabs({\n    userId,\n    isSelectionMode = false,\n    selectedIds = [],\n    onToggleCollection,\n    onDeleteCollection,\n    onEditCollection,\n    onStartRanking,\n    onAddToSet,\n    onDeleteSet,\n    onEditSet,\n    collectionActions,\n    setActions,\n    initialTab = 'collections',\n    hideExtras = false\n}: UserContentTabsProps) {\n    const { user } = useAuth();\n\n    const { collections, loading: collectionsLoading } = useUserCollections(userId);\n    const { collectionSets, loading: setsLoading } = useUserCollectionSets(userId);\n\n    const items: TabItem[] = [\n        {\n            id: 'collections',\n            label: 'コレクション',\n            content: (\n                <Stack gap=\"lg\" className=\"pt-4\">\n                    {(collectionActions || collections.length > 0) && (\n                        <Flex justify=\"between\" align=\"center\">\n                            <Text variant=\"detail\" color=\"secondary\" weight=\"bold\">\n                                {collections.length} 個のコレクション\n                            </Text>\n                            {collectionActions}\n                        </Flex>\n                    )}\n\n                    {collectionsLoading ? (\n                        <View className=\"flex justify-center py-12\">\n                            <Spinner size=\"lg\" />\n                        </View>\n                    ) : collections.length === 0 ? (\n                        <Text color=\"secondary\" align=\"center\" variant=\"xs\" className=\"py-12\">\n                            コレクションがありません\n                        </Text>\n                    ) : (\n                        <Grid cols={{ sm: 2, lg: 3 }} gap=\"lg\">\n                            {collections.map(c => (\n                                <CollectionCard\n                                    key={c.id}\n                                    collection={c}\n                                    isSelectionMode={isSelectionMode}\n                                    selected={selectedIds.includes(c.id)}\n                                    onSelect={onToggleCollection}\n                                    onDelete={onDeleteCollection}\n                                    onEdit={onEditCollection}\n                                    onStartRanking={onStartRanking}\n                                    onAddToSet={onAddToSet}\n                                    hideExtras={hideExtras}\n                                />\n                            ))}\n                        </Grid>\n                    )}\n                </Stack>\n            )\n        },\n        {\n            id: 'sets',\n            label: 'セット',\n            content: (\n                <Stack gap=\"lg\" className=\"pt-4\">\n                    {(setActions || collectionSets.length > 0) && (\n                        <Flex justify=\"between\" align=\"center\">\n                            <Text variant=\"detail\" color=\"secondary\" weight=\"bold\">\n                                {collectionSets.length} 個のセット\n                            </Text>\n                            {setActions}\n                        </Flex>\n                    )}\n\n                    {setsLoading ? (\n                        <View className=\"flex justify-center py-12\">\n                            <Spinner size=\"lg\" />\n                        </View>\n                    ) : collectionSets.length === 0 ? (\n                        <Text color=\"secondary\" align=\"center\" variant=\"xs\" className=\"py-12\">\n                            セットがありません\n                        </Text>\n                    ) : (\n                        <Grid cols={{ sm: 2, lg: 3 }} gap=\"lg\">\n                            {collectionSets.map(s => (\n                                <CollectionSetCard\n                                    key={s.id}\n                                    set={s}\n                                    isSelectionMode={isSelectionMode}\n                                    selectedCollectionIds={selectedIds}\n                                    onToggleCollection={onToggleCollection}\n                                    onDelete={onDeleteSet}\n                                    onEdit={onEditSet}\n                                />\n                            ))}\n                        </Grid>\n                    )}\n                </Stack>\n            )\n        }\n    ];\n\n    return (\n        <View>\n            <Tabs items={items} defaultTab={initialTab} fitted variant=\"line\" />\n        </View>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/users/components/UserHeader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/users/components/UserListTabs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/features/users/hooks/useProfile.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'refresh'. Either include it or remove the dependency array.","line":26,"column":8,"nodeType":"ArrayExpression","endLine":26,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [refresh, userId]","fix":{"range":[821,829],"text":"[refresh, userId]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\nimport { UserProfile } from '@/src/entities/user';\nimport { getProfile } from '../../auth/api';\n\nexport function useProfile(userId: string | undefined) {\n    const [profile, setProfile] = useState<UserProfile | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState<string | null>(null);\n\n    const refresh = async () => {\n        if (!userId) return;\n        setLoading(true);\n        try {\n            const data = await getProfile(userId);\n            setProfile(data);\n            setError(null);\n        } catch (err) {\n            setError(err instanceof Error ? err.message : 'Failed to fetch profile');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    useEffect(() => {\n        refresh();\n    }, [userId]);\n\n    return { profile, loading, error, refresh };\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/shared/api/apiClient.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/shared/api/error.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/shared/auth/useAuth.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/shared/components/Header/Header.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Flex' is defined but never used.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":14,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Flex"},"fix":{"range":[149,202],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isAuthenticated' is assigned a value but never used.","line":16,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":28},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":45,"column":33,"nodeType":"JSXOpeningElement","endLine":49,"endColumn":35}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState } from 'react';\nimport Link from 'next/link';\nimport { Container } from '@/src/design/primitives/Container';\nimport { Flex } from '@/src/design/primitives/Flex';\nimport { View } from '@/src/design/primitives/View';\nimport { Text } from '@/src/design/baseComponents/Text';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { Menu } from 'lucide-react';\nimport { MobileMenu } from './MobileMenu';\nimport { useAuth } from '@/src/shared/auth/useAuth';\n\nexport function Header() {\n    const [isMenuOpen, setIsMenuOpen] = useState(false);\n    const { isAuthenticated } = useAuth();\n\n    return (\n        <>\n            <View\n                as=\"header\"\n                bg=\"base\"\n                className=\"sticky top-0 z-50 border-b border-surface-muted h-16 flex items-center shadow-sm\"\n            >\n                <Container className=\"relative h-full px-4\">\n                    <div className=\"flex items-center justify-between h-full\">\n                        {/* 左側: ハンバーガーメニュー */}\n                        <div className=\"z-10\">\n                            <Button\n                                variant=\"ghost\"\n                                size=\"sm\"\n                                onClick={() => setIsMenuOpen(true)}\n                                className=\"p-2 h-auto hover:bg-surface-muted transition-colors rounded-lg flex items-center justify-center\"\n                            >\n                                <Menu size={24} className=\"text-foreground\" />\n                            </Button>\n                        </div>\n\n                        {/* 中央: ロゴとタイトル (絶対配置で固定) */}\n                        <div className=\"absolute inset-0 flex items-center justify-center pointer-events-none\">\n                            <Link\n                                href=\"/home\"\n                                className=\"flex items-center gap-2 group pointer-events-auto\"\n                            >\n                                <img\n                                    src=\"/logo_black.png\"\n                                    alt=\"AiQ Logo\"\n                                    className=\"h-8 w-8 transition-transform group-hover:scale-110\"\n                                />\n                                <Text variant=\"h3\" weight=\"bold\" color=\"primary\" className=\"tracking-tight whitespace-nowrap\">AiQ</Text>\n                            </Link>\n                        </div>\n\n                        {/* 右側: レイアウトバランスのための空要素 */}\n                        <div className=\"w-10 h-10\" />\n                    </div>\n                </Container>\n            </View>\n\n            <MobileMenu isOpen={isMenuOpen} onClose={() => setIsMenuOpen(false)} />\n        </>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/shared/components/Header/MobileMenu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/shared/components/Navigation/BackButton.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Container' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":19,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Container"},"fix":{"range":[245,308],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React from 'react';\nimport { useRouter } from 'next/navigation';\nimport { Button } from '@/src/design/baseComponents/Button';\nimport { ChevronLeft } from 'lucide-react';\nimport { View } from '@/src/design/primitives/View';\nimport { Container } from '@/src/design/primitives/Container';\n\n/**\n * ページ上部に表示される共通の「戻る」ボタンです。\n */\nexport function BackButton() {\n    const router = useRouter();\n\n    return (\n        <View zIndex=\"docked\" className=\"fixed top-20 left-4\">\n            <Button\n                variant=\"solid\"\n                onClick={() => router.back()}\n                className=\"gap-1 px-4 shadow-brand-lg hover:shadow-brand-md transition-all active:scale-95 h-12 rounded-full border-2 border-brand-primary/20 bg-white text-slate-900 font-bold\"\n            >\n                <ChevronLeft size={24} className=\"text-brand-primary\" strokeWidth={3} />\n                <span>戻る</span>\n            </Button>\n        </View>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/shared/components/SectionHeader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/shared/contexts/ThemeContext.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n/workspace/frontend/src/shared/contexts/ThemeContext.tsx:22:13\n  20 |         const savedTheme = localStorage.getItem('theme') as Theme;\n  21 |         if (savedTheme) {\n> 22 |             setTheme(savedTheme);\n     |             ^^^^^^^^ Avoid calling setState() directly within an effect\n  23 |         } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {\n  24 |             setTheme('dark');\n  25 |         }","line":22,"column":13,"nodeType":null,"endLine":22,"endColumn":21}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { createContext, useContext, useEffect, useState } from 'react';\n\ntype Theme = 'light' | 'dark';\n\ninterface ThemeContextType {\n    theme: Theme;\n    setTheme: (theme: Theme) => void;\n    toggleTheme: () => void;\n}\n\nconst ThemeContext = createContext<ThemeContextType | undefined>(undefined);\n\nexport function ThemeProvider({ children }: { children: React.ReactNode }) {\n    const [theme, setTheme] = useState<Theme>('light');\n\n    // 初期テーマの読み込み（LocalStorage等から）\n    useEffect(() => {\n        const savedTheme = localStorage.getItem('theme') as Theme;\n        if (savedTheme) {\n            setTheme(savedTheme);\n        } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {\n            setTheme('dark');\n        }\n    }, []);\n\n    // テーマ変更時に HTML クラスを更新\n    useEffect(() => {\n        const root = window.document.documentElement;\n        root.classList.remove('light', 'dark');\n        root.classList.add(theme);\n        localStorage.setItem('theme', theme);\n    }, [theme]);\n\n    const toggleTheme = () => {\n        setTheme(prev => (prev === 'light' ? 'dark' : 'light'));\n    };\n\n    return (\n        <ThemeContext.Provider value={{ theme, setTheme, toggleTheme }}>\n            {children}\n        </ThemeContext.Provider>\n    );\n}\n\nexport function useTheme() {\n    const context = useContext(ThemeContext);\n    if (!context) {\n        throw new Error('useTheme must be used within a ThemeProvider');\n    }\n    return context;\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/shared/contexts/ToastContext.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/frontend/src/shared/utils/cn.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
